define("3ca92102-a9d8-416d-87e5-e61409c90814_0.0.1",["jquery","@microsoft/sp-webpart-base","@microsoft/sp-core-library","jplist-core","jplist-pagination","CorporateDiscountWebPartStrings"],function(e,t,r,n,o,i){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=122)}([function(e,t,r){"use strict";(function(e){function n(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}Object.defineProperty(t,"__esModule",{value:!0});var o=r(4);t.extractWebUrl=n;var i=function(){function t(){}return t.getCtxCallback=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){t.apply(e,r)}},t.urlParamExists=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),new RegExp("[\\?&]"+e+"=([^&#]*)").test(location.search)},t.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=t.exec(location.search);return null==r?"":decodeURIComponent(r[1].replace(/\+/g," "))},t.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e);return!(""===t||/false|0/i.test(t))},t.stringInsert=function(e,t,r){return t>0?e.substring(0,t)+r+e.substring(t,e.length):r+e},t.dateAdd=function(e,t,r){var n=new Date(e);switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n},t.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var r=document.getElementsByTagName("head");if(r.length>0){var n=document.createElement("link");r[0].appendChild(n),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",e)}},t.combinePaths=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.filter(function(e){return!t.stringIsNullOrEmpty(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")},t.getRandomString=function(e){for(var t=new Array(e),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t[n]=r.charAt(Math.floor(Math.random()*r.length));return t.join("")},t.getGUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})},t.isFunction=function(e){return"function"==typeof e},t.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},t.stringIsNullOrEmpty=function(e){return void 0===e||null===e||e.length<1},t.extend=function(e,t,r){if(void 0===r&&(r=!1),null===t||void 0===t)return e;var n=r?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return n(e,t)}).reduce(function(e,r){return e[r]=t[r],e},e)},t.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},t.toAbsoluteUrl=function(r){return new Promise(function(n){if(t.isUrlAbsolute(r))return n(r);if(null!==o.RuntimeConfig.spBaseUrl)return n(t.combinePaths(o.RuntimeConfig.spBaseUrl,r));if(void 0!==e._spPageContextInfo){if(e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return n(t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,r));if(e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return n(t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,r))}if(void 0!==e.location){var i=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var o=i.indexOf(e);if(o>0)return n(t.combinePaths(i.substr(0,o),r))})}return n(r)})},t}();t.Util=i}).call(t,r(30))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(9),a=r(10),s=r(2),u=r(5),l=r(20),c=r(21),p=r(22),f=function(e){function t(t,r){var n=e.call(this)||this;if(n._options={},n._query=new i.Dictionary,n._batch=null,"string"==typeof t){var a=t;if(o.Util.isUrlAbsolute(a)||a.lastIndexOf("/")<0)n._parentUrl=a,n._url=o.Util.combinePaths(a,r);else if(a.lastIndexOf("/")>a.lastIndexOf("(")){var s=a.lastIndexOf("/");n._parentUrl=a.slice(0,s),r=o.Util.combinePaths(a.slice(s),r),n._url=o.Util.combinePaths(n._parentUrl,r)}else{var s=a.lastIndexOf("(");n._parentUrl=a.slice(0,s),n._url=o.Util.combinePaths(a,r)}}else{var u=t;n._parentUrl=u._url,n._options=u._options;var l=u._query.get("@target");null!==l&&n._query.add("@target",l),n._url=o.Util.combinePaths(n._parentUrl,r)}return n}return n(t,e),t.prototype.addBatchDependency=function(){return this.hasBatch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return null!==this._batch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype.as=function(e){var t=new e(this._url,null);return o.Util.extend(t,this,!0)},t.prototype.inBatch=function(e){if(null!==this._batch)throw new s.AlreadyInBatchException;return this._batch=e,this},t.prototype.toUrlAndQuery=function(){var e=new i.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,r,n){return u.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+r+" value: "+n,u.LogLevel.Verbose),e.add(r,"'"+n+"'"),r});return e.merge(this._query),e.count()>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},t.prototype.getParent=function(e,t,r,n){void 0===t&&(t=this.parentUrl);var o=new e(t,r);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==n&&(o=o.inBatch(n)),o},t.prototype.clone=function(e,t,r){void 0===r&&(r=!0);var n=new e(this,t);n.configure(this._options);var o=this.query.get("@target");return null!==o&&n.query.add("@target",o),r&&this.hasBatch&&(n=n.inBatch(this.batch)),n},t.prototype.toRequestContext=function(e,t,r,n){var i=this;void 0===t&&(t={}),void 0===n&&(n=c.PipelineMethods.default);var s=this.hasBatch?this.addBatchDependency():function(){};return o.Util.toAbsoluteUrl(this.toUrlAndQuery()).then(function(u){return a.mergeOptions(t,i._options),{batch:i._batch,batchDependency:s,cachingOptions:i._cachingOptions,clientFactory:function(){return new p.HttpClient},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:n,requestAbsoluteUrl:u,requestId:o.Util.getGUID(),verb:e}})},t}(l.ODataQueryable);t.SharePointQueryable=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var r=this._query.getKeys(),n=[],o=t?" asc":" desc",i=0;i<r.length;i++)if("$orderby"===r[i]){n.push(this._query.get("$orderby"));break}return n.push(""+e+o),this._query.add("$orderby",n.join(",")),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t}(f);t.SharePointQueryableCollection=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(f);t.SharePointQueryableInstance=h},function(e,t,r){"use strict";function n(e){i.Logger.log({data:{},level:i.LogLevel.Error,message:"["+e.name+"]::"+e.message})}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),a=function(e){function t(t,r,n){var o=e.call(this,"Error making HttpClient request in queryable: ["+t+"] "+r)||this;return o.status=t,o.statusText=r,o.data=n,o.name="ProcessHttpClientResponseException",i.Logger.log({data:o.data,level:i.LogLevel.Error,message:o.message}),o}return o(t,e),t}(Error);t.ProcessHttpClientResponseException=a;var s=function(e){function t(t){void 0===t&&(t="Cannot create a caching configuration provider since cache is not available.");var r=e.call(this,t)||this;return r.name="NoCacheAvailableException",n(r),r}return o(t,e),t}(Error);t.NoCacheAvailableException=s;var u=function(e){function t(t){void 0===t&&(t="Unable to determine API url.");var r=e.call(this,t)||this;return r.name="APIUrlException",n(r),r}return o(t,e),t}(Error);t.APIUrlException=u;var l=function(e){function t(t,r){void 0===r&&(r="Auth URL Endpoint could not be determined from data. Data logged.");var n=e.call(this,r)||this;return n.name="APIUrlException",i.Logger.log({data:t,level:i.LogLevel.Error,message:n.message}),n}return o(t,e),t}(Error);t.AuthUrlException=l;var c=function(e){function t(t){void 0===t&&(t="Using NodeFetchClient in the browser is not supported.");var r=e.call(this,t)||this;return r.name="NodeFetchClientUnsupportedException",n(r),r}return o(t,e),t}(Error);t.NodeFetchClientUnsupportedException=c;var p=function(e){function t(){var t=this,r=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return t=e.call(this,r)||this,t.name="SPRequestExecutorUndefinedException",n(t),t}return o(t,e),t}(Error);t.SPRequestExecutorUndefinedException=p;var f=function(e){function t(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var r=e.call(this,t)||this;return r.name="MaxCommentLengthException",n(r),r}return o(t,e),t}(Error);t.MaxCommentLengthException=f;var d=function(e){function t(t){void 0===t&&(t="This operation");var r=e.call(this,t+" is not supported as part of a batch.")||this;return r.name="NotSupportedInBatchException",n(r),r}return o(t,e),t}(Error);t.NotSupportedInBatchException=d;var h=function(e){function t(t,r){void 0===r&&(r="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var n=e.call(this,r)||this;return n.name="ODataIdException",i.Logger.log({data:t,level:i.LogLevel.Error,message:n.message}),n}return o(t,e),t}(Error);t.ODataIdException=h;var y=function(e){function t(t){var r=e.call(this,t)||this;return r.name="BatchParseException",n(r),r}return o(t,e),t}(Error);t.BatchParseException=y;var g=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var r=e.call(this,t)||this;return r.name="AlreadyInBatchException",n(r),r}return o(t,e),t}(Error);t.AlreadyInBatchException=g;var v=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var r=e.call(this,t)||this;return r.name="FunctionExpectedException",n(r),r}return o(t,e),t}(Error);t.FunctionExpectedException=v;var m=function(e){function t(t){var r=e.call(this,t)||this;return r.name="UrlException",n(r),r}return o(t,e),t}(Error);t.UrlException=m},function(e,t,r){"use strict";function n(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new c.ODataIdException(e)}function o(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?u.Util.combinePaths(u.extractWebUrl(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(l.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",l.LogLevel.Warning),"")}function i(e){return new f(e)}function a(e){return new d(e)}var s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=r(0),l=r(5),c=r(2),p=r(14);t.spExtractODataId=n;var f=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)},r}return s(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})},t}(p.ODataParserBase),d=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})},r}return s(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(o(e),null);return u.Util.extend(t,e)})})},t}(p.ODataParserBase);t.spGetEntityUrl=o,t.spODataEntity=i,t.spODataEntityArray=a},function(e,t,r){"use strict";function n(e){a.set(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(31),i=function(){function e(){this._defaultCachingStore="session",this._defaultCachingTimeoutSeconds=60,this._globalCacheDisable=!1,this._enableCacheExpiration=!1,this._cacheExpirationIntervalMilliseconds=750,this._spfxContext=null,this._spFetchClientFactory=function(){return new o.FetchClient},this._spBaseUrl=null,this._spHeaders=null,this._graphHeaders=null,this._graphFetchClientFactory=function(){return null}}return e.prototype.set=function(e){var t=this;if(e.hasOwnProperty("globalCacheDisable")&&(this._globalCacheDisable=e.globalCacheDisable),e.hasOwnProperty("defaultCachingStore")&&(this._defaultCachingStore=e.defaultCachingStore),e.hasOwnProperty("defaultCachingTimeoutSeconds")&&(this._defaultCachingTimeoutSeconds=e.defaultCachingTimeoutSeconds),e.hasOwnProperty("sp")&&(e.sp.hasOwnProperty("fetchClientFactory")&&(this._spFetchClientFactory=e.sp.fetchClientFactory),e.sp.hasOwnProperty("baseUrl")&&(this._spBaseUrl=e.sp.baseUrl),e.sp.hasOwnProperty("headers")&&(this._spHeaders=e.sp.headers)),e.hasOwnProperty("spfxContext")&&(this._spfxContext=e.spfxContext,void 0!==this._spfxContext.graphHttpClient&&(this._graphFetchClientFactory=function(){return t._spfxContext.graphHttpClient})),e.hasOwnProperty("graph")&&(e.graph.hasOwnProperty("headers")&&(this._graphHeaders=e.graph.headers),e.graph.hasOwnProperty("fetchClientFactory")&&(this._graphFetchClientFactory=e.graph.fetchClientFactory)),e.hasOwnProperty("enableCacheExpiration")&&(this._enableCacheExpiration=e.enableCacheExpiration),e.hasOwnProperty("cacheExpirationIntervalMilliseconds")){var r=e.cacheExpirationIntervalMilliseconds<300?300:e.cacheExpirationIntervalMilliseconds;this._cacheExpirationIntervalMilliseconds=r}},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this._defaultCachingStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this._defaultCachingTimeoutSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this._globalCacheDisable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spFetchClientFactory",{get:function(){return this._spFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spBaseUrl",{get:function(){return null!==this._spBaseUrl?this._spBaseUrl:null!==this._spfxContext?this._spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spHeaders",{get:function(){return this._spHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this._enableCacheExpiration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this._cacheExpirationIntervalMilliseconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this._spfxContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphFetchClientFactory",{get:function(){return this._graphFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphHeaders",{get:function(){return this._graphHeaders},enumerable:!0,configurable:!0}),e}();t.RuntimeConfigImpl=i;var a=new i;t.RuntimeConfig=a,t.setRuntimeConfig=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(n=t.LogLevel||(t.LogLevel={}));var o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,r){void 0===r&&(r=n.Verbose),e.instance.log({level:r,message:t})},e.writeJSON=function(t,r){void 0===r&&(r=n.Verbose),e.instance.log({level:r,message:JSON.stringify(t)})},e.log=function(t){e.instance.log(t)},e.measure=function(t,r){return e.instance.measure(t,r)},e}();t.Logger=o;var i=function(){function e(e,t){void 0===e&&(e=n.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=n.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){void 0===e||e.level<this.activeLogLevel||this.subscribers.map(function(t){return t.log(e)})},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}(),a=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case n.Verbose:case n.Info:console.log(t);break;case n.Warning:console.warn(t);break;case n.Error:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")},e}();t.ConsoleListener=a;var s=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();t.FunctionListener=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(9),a=r(44),s=r(20),u=r(21),l=function(e){function t(t,r){var n=e.call(this)||this;if(n._query=new i.Dictionary,"string"==typeof t){var a=t;n._parentUrl=a,n._url=o.Util.combinePaths(a,r)}else{var s=t;n._parentUrl=s._url,n._url=o.Util.combinePaths(n._parentUrl,r)}return n}return n(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return o.Util.extend(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this;return this.toUrl()+"?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")},t.prototype.getParent=function(e,t,r){return void 0===t&&(t=this.parentUrl),new e(t,r)},t.prototype.clone=function(e,t,r){return void 0===r&&(r=!0),new e(this,t)},t.prototype.toRequestContext=function(e,t,r,n){return void 0===t&&(t={}),void 0===n&&(n=u.PipelineMethods.default),Promise.resolve({batch:null,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new a.GraphHttpClient},isBatched:!1,isCached:this._useCaching,options:t,parser:r,pipeline:n,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:o.Util.getGUID(),verb:e})},t}(s.ODataQueryable);t.GraphQueryable=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var r=this._query.getKeys(),n=[],o=t?" asc":" desc",i=0;i<r.length;i++)if("$orderby"===r[i]){n.push(this._query.get("$orderby"));break}return n.push(""+e+o),this._query.add("$orderby",n.join(",")),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skip=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skipToken=function(e){return this._query.add("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),t}(l);t.GraphQueryableCollection=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.search=function(e){return this._query.add("$search",e),this},t}(c);t.GraphQueryableSearchableCollection=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(l);t.GraphQueryableInstance=f},function(e,t,r){"use strict";function n(){return new u}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(14),a=r(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(i.ODataParserBase);t.ODataDefaultParser=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})},t}(i.ODataParserBase);t.ODataValue=n;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(i.ODataParserBase);t.ODataRawParserImpl=l,t.ODataRaw=new l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(i.ODataParserBase);t.TextFileParser=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(i.ODataParserBase);t.BlobFileParser=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(i.ODataParserBase);t.JSONFileParser=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parseImpl=function(e,t){a.Util.isFunction(e.arrayBuffer)&&e.arrayBuffer().then(t),e.buffer().then(t)},t}(i.ODataParserBase);t.BufferFileParser=d},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(7),a=r(0),s=r(2),u=r(38),l=r(12),c=r(16),p=r(3),f=function(e){function t(t,r){return void 0===r&&(r="files"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new d(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r,n){var o=this;return void 0===n&&(n=!0),new t(this,"add(overwrite="+n+",url='"+e+"')").postCore({body:r}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,r,n,o,i){var a=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(t,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return a.getByName(e)}).then(function(e){return e.setContentChunked(r,n,i)})},t.prototype.addTemplateFile=function(e,r){var n=this;return this.clone(t,"addTemplateFile(urloffile='"+e+"',templatefiletype="+r+")",!1).postCore().then(function(t){return{data:t,file:n.getByName(e)}})},t}(o.SharePointQueryableCollection);t.Files=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new o.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new h(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,r){if(void 0===e&&(e=""),void 0===r&&(r=g.Major),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"checkin(comment='"+e+"',checkintype="+r+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,r){return void 0===r&&(r=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+r+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=v.Shared),new u.LimitedWebPartManager(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,r){return void 0===r&&(r=m.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+r+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new i.TextFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new i.JSONFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var r=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(r)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return a.Util.extend(new l.Item(p.spGetEntityUrl(e)),e)})},t.prototype.setContentChunked=function(e,t,r){var n=this;void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var o=e.size,i=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),s=a.Util.getGUID();t({uploadId:s,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i});for(var u=this.startUpload(s,e.slice(0,r)),l=2;l<i;l++)!function(a){u=u.then(function(u){return t({uploadId:s,blockNumber:a,chunkSize:r,currentPointer:u,fileSize:o,stage:"continue",totalBlocks:i}),n.continueUpload(s,u,e.slice(u,u+r))})}(l);return u.then(function(a){return t({uploadId:s,blockNumber:i,chunkSize:r,currentPointer:a,fileSize:o,stage:"finishing",totalBlocks:i}),n.finishUpload(s,a,e.slice(a))})},t.prototype.startUpload=function(e,r){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postAsCore({body:r}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,r,n){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1).postAsCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,r,n){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+r+")",!1).postAsCore({body:n}).then(function(e){return{data:e,file:new t(e.ServerRelativeUrl)}})},t}(c.SharePointQueryableShareableFile);t.File=d;var h=function(e){function t(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new y(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new t(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(t,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(t,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(t,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(t,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(t,"restoreByLabel(versionlabel='"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.Versions=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.openBinaryStream=function(){return this.clone(t,"openBinaryStream").postCore()},t}(o.SharePointQueryableInstance);t.Version=y;var g;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(g=t.CheckinType||(t.CheckinType={}));var v;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(v=t.WebPartsPersonalizationScope||(t.WebPartsPersonalizationScope={}));var m;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(m=t.MoveOperations||(t.MoveOperations={}));!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(t.TemplateFileType||(t.TemplateFileType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.keys=e,this.values=t}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var r=this.keys.indexOf(e);r>-1?this.values[r]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){var t=this;if("getKeys"in e){var r=e;r.getKeys().map(function(e){t.add(e,r.get(e))})}else{var n=e;for(var o in n)n.hasOwnProperty(o)&&this.add(o,n[o])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var r=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),r},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();t.Dictionary=n},function(e,t,r){"use strict";function n(e,t){e.headers=e.headers||{};var r=i.Util.extend(e.headers,t.headers);e=i.Util.extend(e,t),e.headers=r}function o(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach(function(t,r){e.append(r,t)})}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);t.mergeOptions=n,t.mergeHeaders=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(15),a=r(26),s=r(28),u=r(24),l=r(25),c=r(55),p=r(18),f=r(23),d=r(8),h=r(0),y=r(15),g=r(37),v=r(27),m=r(3),b=r(29),P=r(39),j=r(16),w=r(56),S=r(40),C=r(41),_=function(e){function t(t,r){return void 0===r&&(r="webs"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e,r,n,o,i,a){void 0===n&&(n=""),void 0===o&&(o="STS"),void 0===i&&(i=1033),void 0===a&&(a=!0);var s={Description:n,Language:i,Title:e,Url:r,UseSamePermissionsAsParentSite:a,WebTemplate:o},u=JSON.stringify({parameters:h.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},s)});return this.clone(t,"add").postCore({body:u}).then(function(e){return{data:e,web:new x(m.spExtractODataId(e).replace(/_api\/web\/?/i,""))}})},t}(o.SharePointQueryableCollection);t.Webs=_;var O=function(e){function t(t,r){return void 0===r&&(r="webinfos"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.WebInfos=O;var x=function(e){function t(t,r){return void 0===r&&(r="_api/web"),e.call(this,t,r)||this}return n(t,e),t.fromUrl=function(e,r){return new t(h.extractWebUrl(e),r)},Object.defineProperty(t.prototype,"webs",{get:function(){return new _(this)},enumerable:!0,configurable:!0}),t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(_,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(o.SharePointQueryableCollection,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new O(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new l.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new i.Lists(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new a.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new P.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new a.Fields(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new s.Navigation(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new g.SiteUsers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new u.SiteGroups(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new y.List(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new c.RegionalSettings(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new g.CurrentUser(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new p.Folders(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new v.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new o.SharePointQueryable(this,"effectivebasepermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new f.RoleDefinitions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return w.RelatedItemManagerImpl.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new b.ODataBatch(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new p.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new u.SiteGroup(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new u.SiteGroup(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new u.SiteGroup(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new p.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new p.Folder(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new d.File(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new d.File(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new y.List(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,r=JSON.stringify(h.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,r,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:r,shareGenerated:o});return this.clone(t,"applytheme").postCore({body:i})},t.prototype.applyWebTemplate=function(e){var r=this.clone(t,"applywebtemplate");return r.concat("(@t)"),r.query.add("@t",e),r.postCore()},t.prototype.ensureUser=function(e){var r=JSON.stringify({logonName:e});return this.clone(t,"ensureuser").postCore({body:r}).then(function(e){return{data:e,user:new g.SiteUser(m.spExtractODataId(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new o.SharePointQueryableCollection(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(t,"getcatalog("+e+")").select("Id").get().then(function(e){return new y.List(m.spExtractODataId(e))})},t.prototype.getChanges=function(e){var r=JSON.stringify({query:h.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(t,"getchanges").postCore({body:r})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new o.SharePointQueryableCollection(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new g.SiteUser(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=""),this.clone(t,"maptoicon(filename='"+e+"', progid='"+n+"', size="+r+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(t,"getStorageEntity('"+e+"')").get()},t.prototype.getAppCatalog=function(e){return new S.AppCatalog(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(o.SharePointQueryableCollection,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t,r){return void 0===t&&(t=e.replace(/\.[^\/.]+$/,"")),void 0===r&&(r="Site Pages"),C.ClientSidePage.create(this.lists.getByTitle(r),e,t)},t.prototype.addClientSidePageByPath=function(e,t,r){return void 0===r&&(r=e.replace(/\.[^\/.]+$/,"")),C.ClientSidePage.create(this.getList(t),e,r)},t}(j.SharePointQueryableShareableWeb);t.Web=x},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(16),a=r(18),s=r(8),u=r(25),l=r(0),c=r(14),p=r(51),f=r(15),d=r(19),h=function(e){function t(t,r){return void 0===r&&(r="items"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new y(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){var t=new y(this);return t.concat("/../getItemByStringId('"+e+"')"),t},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.getAs(new b)},t.prototype.getAll=function(e){var r=this;void 0===e&&(e=2e3),d.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",d.LogLevel.Warning);var n=new t(this,"").top(e).configure({headers:{Accept:"application/json;odata=nometadata"}});return this.query.getKeys().filter(function(e){return/^\$select$|^\$filter$|^\$top$|^\$expand$/.test(e.toLowerCase())}).reduce(function(e,t){return e.query.add(t,r.query.get(t)),e},n),new Promise(function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)})},t.prototype.add=function(e,r){var n=this;void 0===e&&(e={}),void 0===r&&(r=null);var o=this.addBatchDependency();return this.ensureListItemEntityTypeName(r).then(function(r){var i=JSON.stringify(l.Util.extend({__metadata:{type:r}},e)),a=n.clone(t,null).postAsCore({body:i}).then(function(e){return{data:e,item:n.getById(e.Id)}});return o(),a})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(f.List).getListItemEntityTypeFullName()},t}(o.SharePointQueryableCollection);t.Items=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new p.AttachmentFiles(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new u.ContentType(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new o.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new o.SharePointQueryable(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new o.SharePointQueryableInstance(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new a.Folder(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new s.File(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new v(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,r){var n=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(o,i){var a=n.addBatchDependency();return n.ensureListItemEntityTypeName(r).then(function(r){var i=JSON.stringify(l.Util.extend({__metadata:{type:r}},e));return a(),n.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new P).then(function(e){o({data:e,item:n})})}).catch(function(e){return i(e)})})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var r=this.clone(t,"getWOPIFrameUrl(@action)");return r._query.add("@action",e),r.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,r){return void 0===r&&(r=!1),this.clone(t,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:r})})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(f.List,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},t}(i.SharePointQueryableShareableItem);t.Item=y;var g=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){if(this.hasNext){return new h(this.nextUrl,null).getPaged()}return new Promise(function(e){return e(null)})},e}();t.PagedItemCollection=g;var v=function(e){function t(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new m(this);return t.concat("("+e+")"),t},t}(o.SharePointQueryableCollection);t.ItemVersions=v;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.ItemVersion=m;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&e.json().then(function(e){var n=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];r(new g(n,t.parseODataJSON(e)))})})},t}(c.ODataParserBase),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&r({"odata.etag":e.headers.get("etag")})})},t}(c.ODataParserBase)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(4),a=r(5),s=function(){function e(e,t){this.store=e,this.defaultTimeoutMinutes=t,this.defaultTimeoutMinutes=void 0===t?-1:t,this.enabled=this.test(),i.RuntimeConfig.enableCacheExpiration&&(a.Logger.write("Enabling cache expiration.",a.LogLevel.Info),this.cacheExpirationHandler())}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var r=JSON.parse(t);return new Date(r.expiration)<=new Date?(a.Logger.write("Removing item with key '"+e+"' from cache due to expiration.",a.LogLevel.Info),this.delete(e),null):r.value},e.prototype.put=function(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,r){var n=this;return this.enabled?new Promise(function(o){var i=n.get(e);null==i?t().then(function(t){n.put(e,t,r),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,r){e.enabled||t();try{for(var n=0;n<e.store.length;n++){var o=e.store.key(n);/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){r(e)}})},e.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var r=i.RuntimeConfig.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(r=60*this.defaultTimeoutMinutes),t=n.Util.dateAdd(new Date,"second",r)}return JSON.stringify({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;a.Logger.write("Called cache expiration handler.",a.LogLevel.Verbose),this.deleteExpired().then(function(t){setTimeout(n.Util.getCtxCallback(e,e.cacheExpirationHandler),i.RuntimeConfig.cacheExpirationIntervalMilliseconds)}).catch(function(e){a.Logger.log({data:e,level:a.LogLevel.Error,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},e}();t.PnPClientStorageWrapper=s;var u=function(){function e(e){void 0===e&&(e=new o.Dictionary),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.count()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return this._store.getKeys()[e]},e.prototype.removeItem=function(e){this._store.remove(e)},e.prototype.setItem=function(e,t){this._store.add(e,t)},e}(),l=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=new s("undefined"!=typeof localStorage?localStorage:new u)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=new s("undefined"!=typeof sessionStorage?sessionStorage:new u)),this._session},enumerable:!0,configurable:!0}),e}();t.PnPClientStorage=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(5),i=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&t.parseImpl(e,r,n)})},e.prototype.parseImpl=function(e,t,r){var n=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(n.parseODataJSON(e))}).catch(function(e){return r(e)})},e.prototype.handleError=function(e,t){return e.ok||e.json().then(function(r){var o={responseBody:r,responseHeaders:e.headers};t(new n.ProcessHttpClientResponseException(e.status,e.statusText,o))}).catch(function(r){o.Logger.log({data:r,level:o.LogLevel.Warning,message:"There was an error parsing the error response body. See data for details."});var i={responseBody:"[[body not available]]",responseHeaders:e.headers};t(new n.ProcessHttpClientResponseException(e.status,e.statusText,i))}),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}();t.ODataParserBase=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(12),i=r(52),a=r(25),s=r(26),u=r(53),l=r(54),c=r(1),p=r(36),f=r(0),d=r(27),h=r(3),y=r(2),g=r(18),v=function(e){function t(t,r){return void 0===r&&(r="lists"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByTitle=function(e){return new m(this,"getByTitle('"+e+"')")},t.prototype.getById=function(e){var t=new m(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r,n,o){var i=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o={});var a=f.Util.extend({AllowContentTypes:n,BaseTemplate:r,ContentTypesEnabled:n,Description:t,Title:e,__metadata:{type:"SP.List"}},o);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:i.getByTitle(a.Title)}})},t.prototype.ensure=function(e,t,r,n,o){var i=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o={}),this.hasBatch)throw new y.NotSupportedInBatchException("The ensure list method");return new Promise(function(a,s){var u=f.Util.extend(o,{Title:e,Description:t,ContentTypesEnabled:n},!0),l=i.getByTitle(u.Title);l.get().then(function(e){l.update(u).then(function(e){a({created:!1,data:e,list:i.getByTitle(u.Title)})}).catch(function(e){return s(e)})}).catch(function(o){i.add(e,t,r,n,u).then(function(e){a({created:!0,data:e.data,list:i.getByTitle(u.Title)})}).catch(function(e){return s(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(t,"ensuresiteassetslibrary").postCore().then(function(e){return new m(h.spExtractODataId(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(t,"ensuresitepageslibrary").postCore().then(function(e){return new m(h.spExtractODataId(e))})},t}(c.SharePointQueryableCollection);t.Lists=v;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new a.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new o.Items(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new i.Views(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new u.Forms(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new i.View(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new d.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new c.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new c.SharePointQueryableCollection(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new c.SharePointQueryable(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new c.SharePointQueryable(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new l.Subscriptions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new g.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new i.View(this,"getView('"+e+"')")},t.prototype.update=function(e,r){var n=this;void 0===r&&(r="*");var o=JSON.stringify(f.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:o,headers:{"IF-Match":r,"X-HTTP-Method":"MERGE"}}).then(function(r){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(t,n.parentUrl,"getByTitle('"+e.Title+"')")),{data:r,list:o}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.clone(t,"getitems");return o.expand.apply(o,r).postCore({body:JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var r=this.clone(t,"renderlistdata(@viewXml)");return r.query.add("@viewXml","'"+e+"'"),r.postCore().then(function(e){return e.hasOwnProperty("RenderListData")?JSON.parse(e.RenderListData):JSON.parse(e)})},t.prototype.renderListDataAsStream=function(e,r){void 0===r&&(r=null);var n={overrideParameters:f.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},r),parameters:f.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(n)})},t.prototype.renderListFormData=function(e,r,n){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+r+"', mode='"+n+"')").postCore().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("ListData")?e.ListData:e})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").getAs().then(function(e){return e.ListItemEntityTypeFullName})},t}(p.SharePointQueryableSecurable);t.List=m},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(11),a=r(3),s=r(1),u=r(36),l=r(17),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,r){void 0===r&&(r=null);var n=null!==r?r.toISOString():null;return this.clone(t,"shareLink").postAsCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},t.prototype.shareWith=function(e,r,n,a,s){var u=this;void 0===n&&(n=!1),void 0===a&&(a=!1),Array.isArray(e)||(e=[e]);var c=JSON.stringify(e.map(function(e){return{Key:e}})),p=r===l.SharingRole.Edit?l.RoleType.Contributor:l.RoleType.Reader;return i.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var r={includeAnonymousLinkInEmail:n,peoplePickerInput:c,propagateAcl:a,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==s&&(r=o.Util.extend(r,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),u.clone(t,"shareObject").postAsCore({body:JSON.stringify(r)})})},t.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=o.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var n=JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),i={peoplePickerInput:n,roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(i=o.Util.extend(i,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(i)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postAsCore({body:JSON.stringify({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postAsCore({body:JSON.stringify({recipients:e})})},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(t,"getSharingInformation").postAsCore({body:JSON.stringify({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postAsCore({body:JSON.stringify({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postAsCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},t.prototype.unshareLink=function(e,r){return void 0===r&&(r="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:r})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var r=e===l.SharingRole.Edit?l.RoleType.Contributor:l.RoleType.Reader;return i.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").top(1).filter("RoleTypeKind eq "+r).getAs().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case l.RoleType.Contributor:return i.Web.fromUrl(this.toUrl()).associatedMemberGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});case l.RoleType.Reader:case l.RoleType.Guest:return i.Web.fromUrl(this.toUrl()).associatedVisitorGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(i.Web.fromUrl(e,"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(r){return r.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:JSON.stringify(e)})})},t}(s.SharePointQueryable);t.SharePointQueryableShareable=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r){var n=this;void 0===t&&(t=l.SharingRole.View);var a=this.addBatchDependency();return i.Web.fromUrl(this.toUrl(),"/_api/web/url").get().then(function(i){return a(),n.shareObject(o.Util.combinePaths(i,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)})},t.prototype.shareObject=function(e,t,r,n,o,i,a,s){return void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),this.clone(c,null).shareObject({emailData:n,group:o,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:s})},t.prototype.shareObjectRaw=function(e){return this.clone(c,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(c,null).unshareObjectWeb(e)},t}(u.SharePointQueryableSecurable);t.SharePointQueryableShareableWeb=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=l.SharingLinkKind.OrganizationView),void 0===t&&(t=null),this.clone(c,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,r,n){return void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1),this.clone(c,null).shareWith(e,t,r,!1,n)},t.prototype.checkSharingPermissions=function(e){return this.clone(c,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(c,null).getSharingInformation(e)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(c,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(c,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(c,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(c,null).unshareLink(e,t)},t}(u.SharePointQueryableSecurable);t.SharePointQueryableShareableItem=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=l.SharingLinkKind.OrganizationView),void 0===t&&(t=null);var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.checkPermissions(e)})},t.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getSharingInformation(e)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(h,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var r=new c(a.spGetEntityUrl(t));return e.hasBatch&&(r=r.inBatch(e.batch)),r})},t}(s.SharePointQueryableInstance);t.FileFolderShared=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r,n){void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,r,!1,n)})},t}(d);t.SharePointQueryableShareableFile=h;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shareWith=function(e,t,r,n,o){void 0===t&&(t=l.SharingRole.View),void 0===r&&(r=!1),void 0===n&&(n=!1);var i=this.addBatchDependency();return this.getShareable().then(function(a){return i(),a.shareWith(e,t,r,n,o)})},t}(d);t.SharePointQueryableShareableFolder=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(t.ControlMode||(t.ControlMode={}));!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(t.FieldTypes||(t.FieldTypes={}));!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(t.DateTimeFieldFormatType||(t.DateTimeFieldFormatType={}));!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(t.AddFieldOptions||(t.AddFieldOptions={}));!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(t.CalendarType||(t.CalendarType={}));!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(t.UrlFieldFormatType||(t.UrlFieldFormatType={}));!function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(t.ChoiceFieldFormatType||(t.ChoiceFieldFormatType={}));!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(t.PermissionKind||(t.PermissionKind={}));!function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(t.RoleType||(t.RoleType={}));!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(t.PageType||(t.PageType={}));!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(t.SharingLinkKind||(t.SharingLinkKind={}));!function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(t.SharingRole||(t.SharingRole={}));!function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(t.SharingOperationStatusCode||(t.SharingOperationStatusCode={}));!function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(t.SPSharedObjectType||(t.SPSharedObjectType={}));!function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(t.SharingDomainRestrictionMode||(t.SharingDomainRestrictionMode={}));!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(t.RenderListDataOptions||(t.RenderListDataOptions={}));!function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(t.FieldUserSelectionMode||(t.FieldUserSelectionMode={}))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(16),a=r(8),s=r(0),u=r(3),l=r(12),c=function(e){function t(t,r){return void 0===r&&(r="folders"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new p(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var r=this;return this.clone(t,"add('"+e+"')").postCore().then(function(t){return{data:t,folder:r.getByName(e)}})},t}(o.SharePointQueryableCollection);t.Folders=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new o.SharePointQueryableCollection(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new a.Files(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new o.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new o.SharePointQueryableInstance(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new o.SharePointQueryable(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new o.SharePointQueryableCollection(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=JSON.stringify(s.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return s.Util.extend(new l.Item(u.spGetEntityUrl(e)),e)})},t}(i.SharePointQueryableShareableFolder);t.Folder=p},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(13),a=r(48),s=r(5),u=r(49),l=r(4),c=r(59);t.util=o.Util,t.sp=new u.SPRest,t.graph=new c.GraphRest,t.storage=new i.PnPClientStorage,t.config=new a.Settings,t.log=s.Logger,t.setup=l.setRuntimeConfig,n(r(68)),n(r(71)),n(r(73)),n(r(76)),n(r(77));var p={config:t.config,graph:t.graph,log:t.log,setup:t.setup,sp:t.sp,storage:t.storage,util:t.util};t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(10),i=r(7),a=r(4),s=r(21),u=function(){function e(){}return e.prototype.concat=function(e){return this._url+=e,this},e.prototype.append=function(e){this._url=n.Util.combinePaths(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return o.mergeOptions(this._options,e),this},e.prototype.usingCaching=function(e){return a.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,this._cachingOptions=e),this},e.prototype.toUrl=function(){return this._url},e.prototype.get=function(e,t){return void 0===e&&(e=new i.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.getAs=function(e,t){return void 0===e&&(e=new i.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("POST",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.postAsCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("POST",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("PATCH",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new i.ODataDefaultParser),this.toRequestContext("DELETE",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e}();t.ODataQueryable=u},function(e,t,r){"use strict";function n(e){return c.Logger.log({data:e.result,level:c.LogLevel.Verbose,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(e.result)}function o(e,t){return new Promise(function(r){e.result=t,e.hasResult=!0,r(e)})}function i(e){return e.pipeline.length<1?Promise.resolve(e):e.pipeline.shift()(e)}function a(e){return i(e).then(function(e){return n(e)}).catch(function(e){throw c.Logger.log({data:e,level:c.LogLevel.Error,message:"Error in request pipeline: "+e.message}),e})}function s(e){return void 0===e&&(e=!1),function(t,r,n){var o=n.value;n.value=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return!e&&n.length>0&&n[0].hasOwnProperty("hasResult")&&n[0].hasResult?(c.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",c.LogLevel.Verbose),Promise.resolve(n[0])):(c.Logger.write("["+n[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",c.LogLevel.Verbose),o.apply(t,n).then(function(e){return i(e)}))}}}var u=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var l=r(33),c=r(5),p=r(0);t.setResult=o,t.pipe=a,t.requestPipelineMethod=s;var f=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if("GET"===e.verb&&e.isCached){c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",c.LogLevel.Info);var r=new l.CachingOptions(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(r=p.Util.extend(r,e.cachingOptions)),null!==r.store){var n=r.store.get(r.key);if(null!==n)return c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:n,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),e.batchDependency(),e.parser.hasOwnProperty("hydrate")&&(n=e.parser.hydrate(n)),o(e,n).then(function(e){return t(e)})}c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",c.LogLevel.Info),e.parser=new l.CachingParserWrapper(e.parser,r)}return t(e)})},e.send=function(e){return new Promise(function(t,r){if(e.isBatched){var n=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser);e.batchDependency(),c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",c.LogLevel.Info),t(o(e,n))}else{c.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",c.LogLevel.Info);var i=e.clientFactory(),a=p.Util.extend(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,a).then(function(t){return e.parser.parse(t)}).then(function(t){return o(e,t)}).then(function(e){return t(e)}).catch(function(e){return r(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):c.Logger.log({data:c.Logger.activeLogLevel===c.LogLevel.Info?{}:e,level:c.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},Object.defineProperty(e,"default",{get:function(){return[e.logStart,e.caching,e.send,e.logEnd]},enumerable:!0,configurable:!0}),u([s(!0)],e,"logStart",null),u([s()],e,"caching",null),u([s()],e,"send",null),u([s(!0)],e,"logEnd",null),e}();t.PipelineMethods=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(50),o=r(0),i=r(4),a=r(2),s=r(10),u=function(){function e(){this._impl=i.RuntimeConfig.spFetchClientFactory(),this._digestCache=new n.DigestCache(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var n=o.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),u=new Headers;if(s.mergeHeaders(u,i.RuntimeConfig.spHeaders),s.mergeHeaders(u,t.headers),u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;odata=verbose;charset=utf-8"),u.has("X-ClientService-ClientTag")||u.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),u.has("User-Agent")||u.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/3.0.10"),n=o.Util.extend(n,{headers:u}),n.method&&"GET"!==n.method.toUpperCase()&&!u.has("X-RequestDigest")&&!u.has("Authorization")){var l=e.indexOf("_api/");if(l<0)throw new a.APIUrlException;var c=e.substr(0,l);return this._digestCache.getDigest(c).then(function(t){return u.append("X-RequestDigest",t),r.fetchRaw(e,n)})}return this.fetchRaw(e,n)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;s.mergeHeaders(n,t.headers),t=o.Util.extend(t,{headers:n});var i=function(n){r._impl.fetch(e,t).then(function(e){return n.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&n.reject(e);var t=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(e),setTimeout(o.Util.getCtxCallback(r,i,n),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=o.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.HttpClient=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(24),a=r(0),s=function(e){function t(t,r){return void 0===r&&(r="roleassignments"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e,r){return this.clone(t,"addroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.remove=function(e,r){return this.clone(t,"removeroleassignment(principalid="+e+", roledefid="+r+")").postCore()},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t}(o.SharePointQueryableCollection);t.RoleAssignments=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new p(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.RoleAssignment=u;var l=function(e){function t(t,r){return void 0===r&&(r="roledefinitions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new c(this,"getById("+e+")")},t.prototype.getByName=function(e){return new c(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new c(this,"getbytype("+e+")")},t.prototype.add=function(e,t,r,n){var o=this,i=JSON.stringify({BasePermissions:a.Util.extend({__metadata:{type:"SP.BasePermissions"}},n),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},t}(o.SharePointQueryableCollection);t.RoleDefinitions=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=a.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify(a.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var n=t;if(e.hasOwnProperty("Name")){n=t.getParent(l,t.parentUrl,"").getByName(e.Name)}return{data:r,definition:n}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.RoleDefinition=c;var p=function(e){function t(t,r){return void 0===r&&(r="roledefinitionbindings"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.RoleDefinitionBindings=p},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(37),a=r(0);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(t.PrincipalType||(t.PrincipalType={}));var s=function(e){function t(t,r){return void 0===r&&(r="sitegroups"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){var t=this,r=JSON.stringify(a.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new u(this,"getByName('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("("+e+")"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(t,"removeByLoginName('"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.SiteGroups=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new i.SiteUsers(this,"users")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var r=this,n=a.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=r;return e.hasOwnProperty("Title")&&(o=r.getParent(t,r.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},t}(o.SharePointQueryableInstance);t.SiteGroup=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=r(1),a=function(e){function t(t,r){return void 0===r&&(r="contenttypes"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.addAvailableContentType=function(e){var r=this,n=JSON.stringify({contentTypeId:e});return this.clone(t,"addAvailableContentType").postAsCore({body:n}).then(function(e){return{contentType:r.getById(e.id),data:e}})},t.prototype.add=function(e,t,r,n,i){var a=this;void 0===r&&(r=""),void 0===n&&(n="Custom Content Types"),void 0===i&&(i={});var s=JSON.stringify(o.Util.extend({Description:r,Group:n,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:s}).then(function(e){return{contentType:a.getById(e.id),data:e}})},t}(i.SharePointQueryableCollection);t.ContentTypes=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new i.SharePointQueryableCollection(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new i.SharePointQueryableCollection(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(i.SharePointQueryableInstance);t.ContentType=s;var u=function(e){function t(t,r){return void 0===r&&(r="fieldlinks"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new l(this);return t.concat("(guid'"+e+"')"),t},t}(i.SharePointQueryableCollection);t.FieldLinks=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(i.SharePointQueryableInstance);t.FieldLink=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=r(17),s=function(e){function t(t,r){return void 0===r&&(r="fields"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByTitle=function(e){return new u(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new u(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.getById=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.createFieldAsXml=function(e){var r,n=this;r="string"==typeof e?{SchemaXml:e}:e;var o=JSON.stringify({parameters:i.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},r)});return this.clone(t,"createfieldasxml").postAsCore({body:o}).then(function(e){return{data:e,field:n.getById(e.Id)}})},t.prototype.add=function(e,r,n){var o=this,a=JSON.stringify(i.Util.extend({Title:e,__metadata:{type:r}},n));return this.clone(t,null).postAsCore({body:a}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addText=function(e,t,r){void 0===t&&(t=255);var n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",i.Util.extend(n,r))},t.prototype.addCalculated=function(e,t,r,n,o){void 0===n&&(n=a.FieldTypes.Text);var s={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",i.Util.extend(s,o))},t.prototype.addDateTime=function(e,t,r,n,o){void 0===t&&(t=a.DateTimeFieldFormatType.DateOnly),void 0===r&&(r=a.CalendarType.Gregorian),void 0===n&&(n=0);var s={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",i.Util.extend(s,o))},t.prototype.addNumber=function(e,t,r,n){var o={FieldTypeKind:9};return void 0!==t&&(o=i.Util.extend({MinimumValue:t},o)),void 0!==r&&(o=i.Util.extend({MaximumValue:r},o)),this.add(e,"SP.FieldNumber",i.Util.extend(o,n))},t.prototype.addCurrency=function(e,t,r,n,o){void 0===n&&(n=1033);var a={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(a=i.Util.extend({MinimumValue:t},a)),void 0!==r&&(a=i.Util.extend({MaximumValue:r},a)),this.add(e,"SP.FieldCurrency",i.Util.extend(a,o))},t.prototype.addMultilineText=function(e,t,r,n,o,a,s){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===a&&(a=!0);var u={AllowHyperlink:a,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",i.Util.extend(u,s))},t.prototype.addUrl=function(e,t,r){void 0===t&&(t=a.UrlFieldFormatType.Hyperlink);var n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",i.Util.extend(n,r))},t.prototype.addUser=function(e,t,r){var n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",i.Util.extend(n,r))},t.prototype.addLookup=function(e,r,n,o){var a=this,s=JSON.stringify({parameters:i.Util.extend({FieldTypeKind:7,LookupFieldName:n,LookupListId:r,Title:e,__metadata:{type:"SP.FieldCreationInformation"}},o)});return this.clone(t,"addfield").postAsCore({body:s}).then(function(e){return{data:e,field:a.getById(e.Id)}})},t.prototype.addChoice=function(e,t,r,n,o){void 0===r&&(r=a.ChoiceFieldFormatType.Dropdown);var s={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",i.Util.extend(s,o))},t.prototype.addMultiChoice=function(e,t,r,n){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",i.Util.extend(o,n))},t.prototype.addBoolean=function(e,t){var r={FieldTypeKind:8};return this.add(e,"SP.Field",i.Util.extend(r,t))},t}(o.SharePointQueryableCollection);t.Fields=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var n=JSON.stringify(i.Util.extend({__metadata:{type:t}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(o.SharePointQueryableInstance);t.Field=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=function(e){function t(t,r){return void 0===r&&(r="usercustomactions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(t,"clear").postCore()},t}(o.SharePointQueryableCollection);t.UserCustomActions=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.UserCustomAction=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,r,n){var o=this;void 0===n&&(n=!0);var i=JSON.stringify({IsVisible:n,Title:e,Url:r,__metadata:{type:"SP.NavigationNode"}});return this.clone(t,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},t.prototype.moveAfter=function(e,r){var n=JSON.stringify({nodeId:e,previousNodeId:r});return this.clone(t,"MoveAfter").postCore({body:n})},t}(o.SharePointQueryableCollection);t.NavigationNodes=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new i(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.NavigationNode=a;var s=function(e){function t(t,r){return void 0===r&&(r="navigation"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new i(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new i(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t}(o.SharePointQueryable);t.Navigation=s;var u=function(e){function t(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return n(t,e),t.prototype.getMenuState=function(e,r,n,o){return void 0===e&&(e=null),void 0===r&&(r=10),void 0===n&&(n=null),void 0===o&&(o=null),new t("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:r,mapProviderName:n,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,r){return void 0===r&&(r=null),new t("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:r})})},t}(o.SharePointQueryable);t.NavigationService=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(5),i=r(22),a=r(10),s=r(4),u=r(2),l=function(){function e(e,t){void 0===t&&(t=n.Util.getGUID()),this.baseUrl=e,this._batchId=t,this._requests=[],this._dependencies=[]}return e.ParseResponse=function(e){return new Promise(function(t,r){for(var n,o,i=[],a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=e.split("\n"),l="batch",c=0;c<s.length;++c){var p=s[c];switch(l){case"batch":if("--batchresponse_"===p.substr(0,"--batchresponse_".length))l="batchHeaders";else if(""!==p.trim())throw new u.BatchParseException("Invalid response, line "+c);break;case"batchHeaders":""===p.trim()&&(l="status");break;case"status":var f=a.exec(p);if(3!==f.length)throw new u.BatchParseException("Invalid status, line "+c);n=parseInt(f[1],10),o=f[2],l="statusHeaders";break;case"statusHeaders":""===p.trim()&&(l="body");break;case"body":i.push(204===n?new Response:new Response(p,{status:n,statusText:o})),l="batch"}}"status"!==l&&r(new u.BatchParseException("Unexpected end of input")),t(i)})},Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,r,n){var o={method:t.toUpperCase(),options:r,parser:n,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i},e.prototype.addDependency=function(){var e,t=new Promise(function(t){e=t});return this._dependencies.push(t),e},e.prototype.execute=function(){var e=this;return Promise.all(this._dependencies).then(function(){return Promise.all(e._dependencies)}).then(function(){return e.executeImpl()})},e.prototype.executeImpl=function(){var t=this;if(o.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this._requests.length+" requests.",o.LogLevel.Info),this._requests.length<1)return o.Logger.write("Resolving empty batch.",o.LogLevel.Info),Promise.resolve();var r=new i.HttpClient;return n.Util.toAbsoluteUrl(this.baseUrl).then(function(i){for(var l=[],c="",p=0;p<t._requests.length;p++){var f=t._requests[p];"GET"===f.method?(c.length>0&&(l.push("--changeset_"+c+"--\n\n"),c=""),l.push("--batch_"+t._batchId+"\n")):(c.length<1&&(c=n.Util.getGUID(),l.push("--batch_"+t._batchId+"\n"),l.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"\n\n')),l.push("--changeset_"+c+"\n")),l.push("Content-Type: application/http\n"),l.push("Content-Transfer-Encoding: binary\n\n");var d=new Headers,h=n.Util.isUrlAbsolute(f.url)?f.url:n.Util.combinePaths(i,f.url);if(o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Adding request "+f.method+" "+h+" to batch.",o.LogLevel.Verbose),"GET"!==f.method){var y=f.method;f.hasOwnProperty("options")&&f.options.hasOwnProperty("headers")&&void 0!==f.options.headers["X-HTTP-Method"]&&(y=f.options.headers["X-HTTP-Method"],delete f.options.headers["X-HTTP-Method"]),l.push(y+" "+h+" HTTP/1.1\n"),d.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else l.push(f.method+" "+h+" HTTP/1.1\n");a.mergeHeaders(d,s.RuntimeConfig.spHeaders),f.options&&a.mergeHeaders(d,f.options.headers),d.has("Accept")||d.append("Accept","application/json"),d.has("Content-Type")||d.append("Content-Type","application/json;odata=verbose;charset=utf-8"),d.has("X-ClientService-ClientTag")||d.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),d.forEach(function(e,t){l.push(t+": "+e+"\n")}),l.push("\n"),f.options.body&&l.push(f.options.body+"\n\n")}c.length>0&&(l.push("--changeset_"+c+"--\n\n"),c=""),l.push("--batch_"+t._batchId+"--\n");var g={"Content-Type":"multipart/mixed; boundary=batch_"+t._batchId},v={body:l.join(""),headers:g,method:"POST"};return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Sending batch request.",o.LogLevel.Info),r.fetch(n.Util.combinePaths(i,"/_api/$batch"),v).then(function(e){return e.text()}).then(e.ParseResponse).then(function(e){if(e.length!==t._requests.length)throw new u.BatchParseException("Could not properly parse responses to match requests in batch.");return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",o.LogLevel.Info),e.reduce(function(e,r,n){var i=t._requests[n];return o.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",o.LogLevel.Verbose),e.then(function(e){return i.parser.parse(r).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},e}();t.ODataBatch=l},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.fetch=function(t,r){return e.fetch(t,r)},t}();t.FetchClient=r}).call(t,r(30))},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,r){return void 0===t&&(t=""),void 0===r&&(r={}),new e(t,r)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=i.Util.extend(this._query,e),this},e}();t.SearchQueryBuilder=a;var s=function(e){function t(t,r){return void 0===r&&(r="_api/search/postquery"),e.call(this,t,r)||this}return n(t,e),t.prototype.execute=function(e){var t,r=this;t=e,t.SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var n=JSON.stringify({request:i.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:n}).then(function(t){return new u(t,r.toUrl(),e)})},t.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},t}(o.SharePointQueryableInstance);t.Search=s;var u=function(){function e(e,t,r,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this._url=t,this._query=r,this._raw=n,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,n=i.Util.extend(this._query,{RowLimit:r,StartRow:r*(e-1)});return n.StartRow>this.TotalRows?Promise.resolve(null):new s(this._url,null).execute(n)},e.prototype.formatSearchResults=function(e){for(var t=new Array,r=e.results?e.results:e,n=0,o=r;n<o.length;n++){var i=o[n],a=i.Cells.results?i.Cells.results:i.Cells;t.push(a.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();t.SearchResults=u;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(t.SortDirection||(t.SortDirection={}));!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(t.ReorderingRuleMatchType||(t.ReorderingRuleMatchType={}));!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(t.QueryPropertyValueType||(t.QueryPropertyValueType={}));var l=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}();t.SearchBuiltInSourceId=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),o=r(0),i=r(4),a=function(){function e(e){this.key=e,this.expiration=o.Util.dateAdd(new Date,"second",i.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=i.RuntimeConfig.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new n.PnPClientStorage,e}();t.CachingOptions=a;var s=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}();t.CachingParserWrapper=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="_api/search/suggest"),e.call(this,t,r)||this}return n(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new a(e)})},t.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},t}(o.SharePointQueryableInstance);t.SearchSuggest=i;var a=function(){function e(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}return e}();t.SearchSuggestResult=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(11),a=r(27),s=r(3),u=r(29),l=r(39),c=function(e){function t(t,r){return void 0===r&&(r="_api/site"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new i.Web(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new l.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new a.UserCustomActions(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new i.Web(e.Url)})},t.prototype.getContextInfo=function(){return new t(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new o.SharePointQueryable("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new o.SharePointQueryable("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new u.ODataBatch(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(t,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:i.Web.fromUrl(s.spExtractODataId(e))}})},t}(o.SharePointQueryableInstance);t.Site=c},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=r(23),a=r(17),s=r(1),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new i.RoleAssignments(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new s.SharePointQueryableInstance(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(s.SharePointQueryable,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return o.Web.fromUrl(this.toUrl()).currentUser.select("LoginName").getAs().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+r+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var r=this;return this.getUserEffectivePermissions(e).then(function(e){return r.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(r){return t.hasPermissions(r,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;var r=parseFloat(e.Low),n=parseFloat(e.High);if(t===a.PermissionKind.FullMask)return 32767==(32767&n)&&65535===r;t-=1;var o=1;return t>=0&&t<32?(o<<=t,0!=(r&o)):t>=32&&t<64&&(o<<=t-32,0!=(n&o))},t}(s.SharePointQueryableInstance);t.SharePointQueryableSecurable=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(24),a=r(0),s=function(e){function t(t,r){return void 0===r&&(r="siteusers"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByEmail=function(e){return new u(this,"getByEmail('"+e+"')")},t.prototype.getById=function(e){return new u(this,"getById("+e+")")},t.prototype.getByLoginName=function(e){var t=new u(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var r=this.clone(t,"removeByLoginName(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.postCore()},t.prototype.add=function(e){var r=this;return this.clone(t,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return r.getByLoginName(e)})},t}(o.SharePointQueryableCollection);t.SiteUsers=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=a.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.SiteUser=u;var l=function(e){function t(t,r){return void 0===r&&(r="currentuser"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.CurrentUser=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new a(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},t}(o.SharePointQueryable);t.LimitedWebPartManager=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getById=function(e){return new s(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new s(this,"getByControlId('"+e+"')")},t}(o.SharePointQueryableCollection);t.WebPartDefinitions=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,r){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+r+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(o.SharePointQueryableInstance);t.WebPartDefinition=s;var u=function(e){function t(t,r){return void 0===r&&(r="webpart"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.WebPart=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="features"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return void 0===r&&(r=!1),this.clone(t,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:r})}).then(function(t){return{data:t,feature:n.getById(e)}})},t.prototype.remove=function(e,r){return void 0===r&&(r=!1),this.clone(t,"remove").postCore({body:JSON.stringify({featureId:e,force:r})})},t}(o.SharePointQueryableCollection);t.Features=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.deactivate=function(e){var r=this;void 0===e&&(e=!1);var n=this.addBatchDependency();return new t(this).select("DefinitionId").getAs().then(function(t){var o=r.getParent(i,r.parentUrl,"",r.batch).remove(t.DefinitionId,e);return n(),o})},t}(o.SharePointQueryableInstance);t.Feature=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(8),a=r(3),s=r(0),u=function(e){function t(t,r){void 0===r&&(r="_api/web/tenantappcatalog/AvailableApps");var n="";return"string"==typeof t?n=t:void 0!==t&&(n=t.toUrl()),e.call(this,s.extractWebUrl(n),r)||this}return n(t,e),t.prototype.getAppById=function(e){return new l(this,"getById('"+e+"')")},t.prototype.add=function(e,r,n){return void 0===n&&(n=!0),new t(s.extractWebUrl(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+n+",url='"+e+"')").postCore({body:r}).then(function(e){return{data:e,file:new i.File(a.spExtractODataId(e))}})},t}(o.SharePointQueryableCollection);t.AppCatalog=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.deploy=function(){return this.clone(t,"Deploy").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(o.SharePointQueryableInstance);t.App=l},function(e,t,r){"use strict";function n(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function o(e,t){void 0===t&&(t=0);var r=this.substring(t).search(e);return r>=0?r+t:r}function i(e,t){var r=new RegExp(t+'="([^"]*?)"',"i"),n=r.exec(e);return n.length>0?n[1]:null}function a(e,t,r){var n=[];if(void 0===e||null===e)return n;var i=e.replace(/[\t\r\n]/g,""),a=o.call(i,t);if(a<0)return n;for(;a>-1;){for(var s=1,u=a+1,l=-1,c=-1;;){if(l=o.call(i,/<div[^>]*>/i,u),c=o.call(i,/<\/div>/i,u),l<0&&(l=i.length+1),l<c?(s++,u=l+1):c<l&&(s--,u=c+1),0===s){var p=i.substring(a,c+6).trim();n.push(r(p));break}if(s>1e3||s<0)throw new Error("getBoundedDivMarkup exceeded depth parameters.")}a=o.call(i,t,c)}return n}function s(e){for(var t=0;t<e.length;t++)e[t].order=t+1,e[t].hasOwnProperty("columns")?s(e[t].columns):e[t].hasOwnProperty("controls")&&s(e[t].controls)}var u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var l=r(8),c=r(12),p=r(0),f=function(e){function t(t,r,n){void 0===r&&(r=[]),void 0===n&&(n=!1);var o=e.call(this,t)||this;return o.sections=r,o.commentsDisabled=n,o}return u(t,e),t.create=function(e,r,n,o){return void 0===o&&(o="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+r+"'").get().then(function(i){if(i.length>0)throw new Error("A file with the name '"+r+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(i){var a=p.Util.combinePaths("/",i.ServerRelativePath.DecodedUrl,r);return e.rootFolder.files.addTemplateFile(a,l.TemplateFileType.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:o,PromotedState:0,Title:n}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var r=new t(e);return r.load().then(function(e){return r})},t.jsonToEscapedString=function(e){return JSON.stringify(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")},t.escapedStringToJson=function(e){return JSON.parse(e.replace(/&quot;/g,'"').replace(/&#58;/g,":").replace(/&#123;/g,"{").replace(/&#125;/g,"}"))},t.prototype.addSection=function(){var e=new d(this,n(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){s(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],a(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var r=/controlType&quot;&#58;(\d*?),/i.exec(e),n=null==r||r.length<2?0:parseInt(r[1],10),o=null;switch(n){case 0:o=new y(null,0),o.fromHtml(e),t.mergeColumnToTree(o);break;case 3:o=new v(""),o.fromHtml(e),t.mergeControlToTree(o);break;case 4:o=new g,o.fromHtml(e),t.mergeControlToTree(o)}}),s(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var r=0;r<this.sections[t].columns.length;r++)for(var n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new c.Item(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.mergeControlToTree=function(e){var t=null,r=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new d(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0];var o=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});o.length<1?(r=new y(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(r)):r=o[0],e.column=r,r.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=null,r=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});r.length<1?(t=new d(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0],e.section=t,t.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(r){return r.update(e,t)})},t}(l.File);t.ClientSidePage=f;var d=function(){function e(e,t,r){void 0===r&&(r=[]),this.page=e,this.order=t,this.columns=r}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new y(this,n(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e}();t.CanvasSection=d;var h=function(){function e(e,t,r,n,o,i){void 0===r&&(r=null),void 0===n&&(n=1),void 0===o&&(o=p.Util.getGUID()),void 0===i&&(i=null),this.controlType=e,this.dataVersion=t,this.column=r,this.order=n,this.id=o,this.controlData=i}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return f.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=f.escapedStringToJson(i(e,"data-sp-controldata")),this.dataVersion=i(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}();t.CanvasControl=h;var y=function(e){function t(t,r,n,o,i){void 0===n&&(n=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var a=e.call(this,0,i)||this;return a.section=t,a.order=r,a.factor=n,a.controls=o,a}return u(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=f.escapedStringToJson(i(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t}(h);t.CanvasColumn=y;var g=function(e){function t(t){void 0===t&&(t="");var r=e.call(this,4,"1.0")||this;return r.text=t,r}return u(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(t);this.text=r.length>1?r[1]:""},t}(h);t.ClientSideText=g;var v=function(e){function t(t,r,n,o,i,a){void 0===r&&(r=""),void 0===n&&(n={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=null);var s=e.call(this,3,"1.0")||this;return s.title=t,s.description=r,s.propertieJson=n,s.webPartId=o,s.htmlProperties=i,s.serverProcessedContent=a,s}return u(t,e),t.fromComponentDef=function(e){var r=new t("");return r.import(e),r},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"");var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=e,this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,title:this.title},r=[];return r.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),r.push('<div data-sp-webpart="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+f.jsonToEscapedString(t)+'">'),r.push("<div data-sp-componentid>"),r.push(this.webPartId),r.push("</div>"),r.push('<div data-sp-htmlproperties="">'),r.push(this.renderHtmlProperties()),r.push("</div>"),r.push("</div>"),r.push("</div>"),r.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=f.escapedStringToJson(i(t,"data-sp-webpartdata"));this.title=r.title,this.description=r.description,this.webPartId=r.id,this.setProperties(r.properties),void 0!==r.serverProcessedContent&&(this.serverProcessedContent=r.serverProcessedContent);var n=a(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=n.length>0?n[0]:""},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=0;t<this.serverProcessedContent.searchablePlainTexts.length;t++){var r=this.serverProcessedContent.searchablePlainTexts[t];e.push('<div data-sp-prop-name="'+r.Name+'" data-sp-searchableplaintext="true">'),e.push(r.Value),e.push("</div>")}if(void 0!==this.serverProcessedContent.imageSources)for(var t=0;t<this.serverProcessedContent.imageSources.length;t++){var r=this.serverProcessedContent.imageSources[t];e.push('<img data-sp-prop-name="'+r.Name+'" src="'+r.Value+'" />')}if(void 0!==this.serverProcessedContent.links)for(var t=0;t<this.serverProcessedContent.links.length;t++){var r=this.serverProcessedContent.links[t];e.push('<a data-sp-prop-name="'+r.Name+'" href="'+r.Value+'"></a>')}}return e.join("")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(h);t.ClientSideWebpart=v},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=function(e){function t(t,r){return void 0===r&&(r="_api/social.following"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"my",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(t,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(t,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(t,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(t,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(t,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return JSON.stringify({actor:i.Util.extend({Id:null,__metadata:{type:"SP.Social.SocialActorInfo"}},e)})},t}(o.SharePointQueryableInstance);t.SocialQuery=a;var s=function(e){function t(t,r){return void 0===r&&(r="my"),e.call(this,t,r)||this}return n(t,e),t.prototype.followed=function(e){return this.clone(t,"followed(types="+e+")").get().then(function(e){return e.hasOwnProperty("Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(t,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(t,"followers").get().then(function(e){return e.hasOwnProperty("Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(t,"suggestions").get().then(function(e){return e.hasOwnProperty("Suggestions")?e.Suggestions.results:e})},t}(o.SharePointQueryableInstance);t.MySocialQuery=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=r(8),s=r(3),u=function(e){function t(r,n){return e.call(this,t.getBaseUrl(r),"_api/SP.Utilities.Utility."+n)||this}return n(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,r=t.toUrl(),n=r.indexOf("_api/");return n<0?r:r.substr(0,n)},t.prototype.excute=function(e){return this.postAsCore({body:JSON.stringify(e)})},t.prototype.sendEmail=function(e){var r={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(r.properties=i.Util.extend(r.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(r.properties=i.Util.extend(r.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(r.properties=i.Util.extend(r.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(r.properties=i.Util.extend(r.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(r)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({})},t.prototype.resolvePrincipal=function(e,r,n,o,i,a){void 0===a&&(a=!1);var s={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:a,scopes:r,sources:n};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(s)},t.prototype.searchPrincipals=function(e,r,n,o,i){var a={groupName:o,input:e,maxCount:i,scopes:r,sources:n};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(a)},t.prototype.createEmailBodyForInvitation=function(e){var r={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(r)},t.prototype.expandGroupsToPrincipals=function(e,r){void 0===r&&(r=30);var n={inputs:e,maxCount:r};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(n)},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new a.File(s.spExtractODataId(e))}})},t}(o.SharePointQueryable);t.UtilityMethod=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(4),i=r(10),a=function(){function e(){this._impl=o.RuntimeConfig.graphFetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var r=new Headers;i.mergeHeaders(r,o.RuntimeConfig.graphHeaders),i.mergeHeaders(r,t.headers);var a=n.Util.extend(t,{headers:r});return this.fetchRaw(e,a)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;i.mergeHeaders(o,t.headers),t=n.Util.extend(t,{headers:o});var a=function(o){r._impl.fetch(e,{},t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.Util.getCtxCallback(r,a,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};a.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();t.GraphHttpClient=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),o=r(2),i=function(){function e(e,t,r){this.wrappedProvider=e,this.store=r||this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e){e(t)});var r=this.wrappedProvider.getConfiguration();return r.then(function(t){e.store.put(e.cacheKey,t)}),r},e.prototype.selectPnPCache=function(){var e=new n.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new o.NoCacheAvailableException},e}();t.default=i},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=function(){function e(){this._settings=new n.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(r,n){try{t._settings.merge(e),r()}catch(e){n(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(r,n){e.getConfiguration().then(function(e){t._settings.merge(e),r()}).catch(function(e){n(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)},e}();t.Settings=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(32),o=r(34),i=r(35),a=r(11),s=r(0),u=r(57),l=r(42),c=r(28),p=r(2),f=r(43),d=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,r){return void 0===r&&(r=""),new e(t,r)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new o.SearchSuggest(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof n.SearchQueryBuilder?e.toSearchQuery():e,new n.Search(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new i.Site(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new a.Web(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new u.UserProfileQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return new l.SocialQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new c.NavigationService},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new f.UtilityMethod(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e.prototype.crossDomainSite=function(e,t){return this._cdImpl(i.Site,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(a.Web,e,t,"web")},e.prototype._cdImpl=function(e,t,r,n){if(!s.Util.isUrlAbsolute(t))throw new p.UrlException("The addInWebUrl parameter must be an absolute url.");if(!s.Util.isUrlAbsolute(r))throw new p.UrlException("The hostWebUrl parameter must be an absolute url.");var o=s.Util.combinePaths(t,"_api/SP.AppContextSite(@target)"),i=new e(o,n);return i.query.add("@target","'"+encodeURIComponent(r)+"'"),i.configure(this._options)},e}();t.SPRest=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(0),i=r(7),a=r(4),s=function(){function e(){}return e}();t.CachedDigest=s;var u=new n.Dictionary,l=function(){function e(e,t){void 0===t&&(t=u),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r){if(new Date<r.expiration)return Promise.resolve(r.value)}var n=o.Util.combinePaths(e,"/_api/contextinfo"),u={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(n,{cache:"no-cache",credentials:"same-origin",headers:o.Util.extend(u,a.RuntimeConfig.spHeaders,!0),method:"POST"}).then(function(e){return(new i.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(r){var n=new s;n.value=r.FormDigestValue;var o=r.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),n.expiration=i,t._digests.add(e,n),n.value})},e.prototype.clear=function(){this._digests.clear()},e}();t.DigestCache=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(7),a=function(e){function t(t,r){return void 0===r&&(r="AttachmentFiles"),e.call(this,t,r)||this}return n(t,e),t.prototype.getByName=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,r){var n=this;return this.clone(t,"add(FileName='"+e+"')",!1).postCore({body:r}).then(function(t){return{data:t,file:n.getByName(e)}})},t.prototype.addMultiple=function(e){var r=this;return e.reduce(function(e,n){return e.then(function(){return r.clone(t,"add(FileName='"+n.name+"')",!1).postCore({body:n.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.reduce(function(t,r){return t.then(function(){return e.getByName(r).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.reduce(function(t,r){return t.then(function(){return e.getByName(r).recycle()})},Promise.resolve())},t}(o.SharePointQueryableCollection);t.AttachmentFiles=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new i.TextFileParser)},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser)},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new i.JSONFileParser)},t.prototype.setContent=function(e){var r=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(r)})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.AttachmentFile=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(0),a=function(e){function t(t,r){return void 0===r&&(r="views"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new s(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,r,n){var o=this;void 0===r&&(r=!1),void 0===n&&(n={});var a=JSON.stringify(i.Util.extend({PersonalView:r,Title:e,__metadata:{type:"SP.View"}},n));return this.clone(t,null).postAsCore({body:a}).then(function(e){return{data:e,view:o.getById(e.Id)}})},t}(o.SharePointQueryableCollection);t.Views=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,r=JSON.stringify(i.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.renderAsHtml=function(){return this.clone(o.SharePointQueryable,"renderashtml").get()},t}(o.SharePointQueryableInstance);t.View=s;var u=function(e){function t(t,r){return void 0===r&&(r="viewfields"),e.call(this,t,r)||this}return n(t,e),t.prototype.getSchemaXml=function(){return this.clone(o.SharePointQueryable,"schemaxml").get()},t.prototype.add=function(e){return this.clone(t,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,r){return this.clone(t,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:r})})},t.prototype.removeAll=function(){return this.clone(t,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(t,"removeviewfield('"+e+"')").postCore()},t}(o.SharePointQueryableCollection);t.ViewFields=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="forms"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t}(o.SharePointQueryableCollection);t.Forms=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.SharePointQueryableInstance);t.Form=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="subscriptions"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var n=this,o=JSON.stringify({clientState:r||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:n.getById(e.id)}})},t}(o.SharePointQueryableCollection);t.Subscriptions=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){var t=this,r=JSON.stringify({expirationDateTime:e});return this.patchCore({body:r,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(o.SharePointQueryableInstance);t.Subscription=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(3),a=r(0),s=function(e){function t(t,r){return void 0===r&&(r="regionalsettings"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new u(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),t}(o.SharePointQueryableInstance);t.RegionalSettings=s;var u=function(e){function t(t,r){return void 0===r&&(r="installedlanguages"),e.call(this,t,r)||this}return n(t,e),t}(o.SharePointQueryableCollection);t.InstalledLanguages=u;var l=function(e){function t(t,r){return void 0===r&&(r="timezone"),e.call(this,t,r)||this}return n(t,e),t.prototype.utcToLocalTime=function(e){var r;return r="string"==typeof e?e:e.toISOString(),this.clone(t,"utctolocaltime('"+r+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var r;return r="string"==typeof e?e:a.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(t,"localtimetoutc('"+r+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},t}(o.SharePointQueryableInstance);t.TimeZone=l;var c=function(e){function t(t,r){return void 0===r&&(r="timezones"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return this.clone(t,"GetById("+e+")").postAsCore({},i.spODataEntity(l))},t}(o.SharePointQueryableCollection);t.TimeZones=c},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=function(e){function t(t,r){return void 0===r&&(r="_api/SP.RelatedItemManager"),e.call(this,t,r)||this}return n(t,e),t.FromUrl=function(e){if(null===e)return new t("");var r=e.indexOf("_api/");return new t(r>-1?e.substr(0,r):e)},t.prototype.getRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,r){var n=this.clone(t,null);return n.concat(".GetPageOneRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e})})},t.prototype.addSingleLink=function(e,r,n,o,i,a,s){void 0===s&&(s=!1);var u=this.clone(t,null);return u.concat(".AddSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryAddReverseLink:s})})},t.prototype.addSingleLinkToUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,r,n,o){void 0===o&&(o=!1);var i=this.clone(t,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:n,TargetListName:r,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,r,n,o,i,a,s){void 0===s&&(s=!1);var u=this.clone(t,null);return u.concat(".DeleteSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:r,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryDeleteReverseLink:s})})},t}(o.SharePointQueryable);t.RelatedItemManagerImpl=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=r(58),a=r(0),s=r(7),u=function(e){function t(t,r){void 0===r&&(r="_api/sp.userprofiles.peoplemanager");var n=e.call(this,t,r)||this;return n.clientPeoplePickerQuery=new c(t),n.profileLoader=new l(t),n}return n(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").getAs(s.ODataValue())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").getAs(s.ODataValue())},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var r=this.clone(t,"amifollowedby(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.amIFollowing=function(e){var r=this.clone(t,"amifollowing(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var r=this.clone(t,"getfollowersfor(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new o.SharePointQueryableCollection(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var r=this.clone(t,"getpeoplefollowedby(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.getPropertiesFor=function(e){var r=this.clone(t,"getpropertiesfor(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,r){var n=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+r+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.hideSuggestion=function(e){var r=this.clone(t,"hidesuggestion(@v)");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.postCore()},t.prototype.isFollowing=function(e,r){var n=this.clone(t,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(r)+"'"),n.get()},t.prototype.setMyProfilePic=function(e){var r=this;return new Promise(function(n,o){i.readBlobAsArrayBuffer(e).then(function(e){new t(r,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return n()})}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,r,n){var o=JSON.stringify({accountName:e,propertyName:r,propertyValue:n});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:o})},t.prototype.setMultiValuedProfileProperty=function(e,r,n){var o=JSON.stringify({accountName:e,propertyName:r,propertyValues:n});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:o})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(o.SharePointQueryableInstance);t.UserProfileQuery=u;var l=function(e){function t(t,r){return void 0===r&&(r="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,r)||this}return n(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(t,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postAsCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(t,"getuserprofile").postAsCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(t,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(t,"getuserprofile/shareallsocialdata("+e+")").postCore()},t}(o.SharePointQueryable),c=function(e){function t(t,r){return void 0===r&&(r="_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface"),e.call(this,t,r)||this}return n(t,e),t.prototype.clientPeoplePickerResolveUser=function(e){var r=this.clone(t,null);return r.concat(".clientpeoplepickerresolveuser"),r.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.clientPeoplePickerSearchUser=function(e){var r=this.clone(t,null);return r.concat(".clientpeoplepickersearchuser"),r.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return JSON.stringify({queryParams:a.Util.extend({__metadata:{type:"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"}},e)})},t}(o.SharePointQueryable)},function(e,t,r){"use strict";function n(e){return i(e,"string")}function o(e){return i(e,"buffer")}function i(e,t){return new Promise(function(r,n){try{var o=new FileReader;switch(o.onload=function(e){r(e.target.result)},t){case"string":o.readAsText(e);break;case"buffer":o.readAsArrayBuffer(e)}}catch(e){n(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.readBlobAsText=n,t.readBlobAsArrayBuffer=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(60),o=function(){function e(){}return Object.defineProperty(e.prototype,"v1",{get:function(){return new n.V1("")},enumerable:!0,configurable:!0}),e}();t.GraphRest=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(61),a=function(e){function t(t,r){return void 0===r&&(r="v1.0"),e.call(this,t,r)||this}return n(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new i.Groups(this)},enumerable:!0,configurable:!0}),t}(o.GraphQueryable);t.V1=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o,i=r(6),a=r(62),s=r(0),u=r(63),l=r(64),c=r(66),p=r(67);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(o=t.GroupType||(t.GroupType={}));var f=function(e){function t(t,r){return void 0===r&&(r="groups"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new d(this,e)},t.prototype.add=function(e,t,r,n){var i=this;void 0===n&&(n={});var a=s.Util.extend({displayName:e,mailEnabled:r===o.Office365,mailNickname:t,securityEnabled:r!==o.Office365},n);return r!==o.Security&&(a=s.Util.extend(a,{groupTypes:[r===o.Office365?"Unified":"DynamicMembership"]})),this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,group:i.getById(e.id)}})},t}(i.GraphQueryableCollection);t.Groups=f;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"caldendar",{get:function(){return new u.Calendar(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new u.Events(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new a.Owners(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new c.Plans(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new a.Members(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new l.Conversations(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new l.Senders(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new l.Senders(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new p.Photo(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,r){var n=this.clone(t,"calendarView");return n.query.add("startDateTime",e.toISOString()),n.query.add("endDateTime",r.toISOString()),n.get()},t}(i.GraphQueryableInstance);t.Group=d},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="members"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.getById=function(e){return new a(this,e)},t}(o.GraphQueryableCollection);t.Members=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Member=a;var s=function(e){function t(t,r){return void 0===r&&(r="owners"),e.call(this,t,r)||this}return n(t,e),t}(i);t.Owners=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="calendars"),e.call(this,t,r)||this}return n(t,e),t}(o.GraphQueryableCollection);t.Calendars=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t}(o.GraphQueryableInstance);t.Calendar=a;var s=function(e){function t(t,r){return void 0===r&&(r="events"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new u(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:JSON.stringify(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t}(o.GraphQueryableCollection);t.Events=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Event=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(65),a=function(e){function t(t,r){return void 0===r&&(r="conversations"),e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getById=function(e){return new l(this,e)},t}(o.GraphQueryableCollection);t.Conversations=a;var s=function(e){function t(t,r){return void 0===r&&(r="threads"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new c(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.GraphQueryableCollection);t.Threads=s;var u=function(e){function t(t,r){return void 0===r&&(r="posts"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new p(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(o.GraphQueryableCollection);t.Posts=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Conversation=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(o.GraphQueryableInstance);t.Thread=c;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new i.Attachments(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:JSON.stringify(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t}(o.GraphQueryableInstance);t.Post=p;var f=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.remove=function(e){var r=this.clone(t,"$ref");return r.query.add("$id",e),r.deleteCore()},t}(o.GraphQueryableCollection);t.Senders=f},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="attachments"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new a(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t}(o.GraphQueryableCollection);t.Attachments=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Attachment=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=function(e){function t(t,r){return void 0===r&&(r="planner/plans"),e.call(this,t,r)||this}return n(t,e),t.prototype.getById=function(e){return new a(this,e)},t}(o.GraphQueryableCollection);t.Plans=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.GraphQueryableInstance);t.Plan=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(7),a=function(e){function t(t,r){return void 0===r&&(r="photo"),e.call(this,t,r)||this}return n(t,e),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.BufferFileParser)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(o.GraphQueryableInstance);t.Photo=a},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(69));var o=r(9);t.Dictionary=o.Dictionary;var i=r(0);t.Util=i.Util,n(r(5)),n(r(2)),n(r(13))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(45);t.CachingConfigurationProvider=n.default;var o=r(70);t.SPListConfigurationProvider=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(45),o=function(){function e(e,t){void 0===t&&(t="config"),this.sourceWeb=e,this.sourceListTitle=t}return Object.defineProperty(e.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),e.prototype.getConfiguration=function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(e){return e.reduce(function(e,t){return Object.defineProperty(e,t.Title,{configurable:!1,enumerable:!1,value:t.Value,writable:!1})},{})})},e.prototype.asCaching=function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new n.default(this,e)},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(72))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.GraphQueryable=n.GraphQueryable,t.GraphQueryableCollection=n.GraphQueryableCollection,t.GraphQueryableInstance=n.GraphQueryableInstance,t.GraphQueryableSearchableCollection=n.GraphQueryableSearchableCollection},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);t.HttpClient=n.HttpClient;var o=r(74);t.SPRequestExecutorClient=o.SPRequestExecutorClient;var i=r(75);t.NodeFetchClient=i.NodeFetchClient;var a=r(31);t.FetchClient=a.FetchClient;var s=r(44);t.GraphHttpClient=s.GraphHttpClient},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=function(){function e(){this.convertToResponse=function(e){var t=new Headers;for(var r in e.headers)e.headers[r]&&t.append(r,e.headers[r]);var n=204===e.statusCode?null:e.body;return new Response(n,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,t){var r=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new o.SPRequestExecutorUndefinedException;var i,a,s=e.substring(0,e.indexOf("/_api")),u=new SP.RequestExecutor(s),l={};if(t.headers&&t.headers instanceof Headers)for(i=t.headers.entries(),a=i.next();!a.done;)l[a.value[0]]=a.value[1],a=i.next();else l=t.headers;var c=["files/add","files/addTemplateFile","file/startUpload","file/continueUpload","file/finishUpload","attachmentfiles/add"],p=new RegExp(c.join("|"),"i").test(e);return new Promise(function(o,i){var a={error:function(e){i(r.convertToResponse(e))},headers:l,method:t.method,success:function(e){o(r.convertToResponse(e))},url:e};t.body&&(a=n.Util.extend(a,{body:t.body}),p&&(a=n.Util.extend(a,{binaryStringRequestBody:!0}))),u.executeAsync(a)})},e}();t.SPRequestExecutorClient=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){}return e.prototype.fetch=function(){throw new n.NodeFetchClientUnsupportedException},e}();t.NodeFetchClient=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(14)),n(r(7)),n(r(33)),n(r(20))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(78))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var o=r(40);t.AppCatalog=o.AppCatalog,t.App=o.App,n(r(41));var i=r(29);t.ODataBatch=i.ODataBatch;var a=r(26);t.Field=a.Field,t.Fields=a.Fields;var s=r(8);t.CheckinType=s.CheckinType,t.WebPartsPersonalizationScope=s.WebPartsPersonalizationScope,t.MoveOperations=s.MoveOperations,t.TemplateFileType=s.TemplateFileType,t.File=s.File,t.Files=s.Files;var u=r(18);t.Folder=u.Folder,t.Folders=u.Folders;var l=r(12);t.Item=l.Item,t.Items=l.Items,t.ItemVersion=l.ItemVersion,t.ItemVersions=l.ItemVersions,t.PagedItemCollection=l.PagedItemCollection;var c=r(28);t.NavigationNodes=c.NavigationNodes,t.NavigationNode=c.NavigationNode;var p=r(15);t.List=p.List,t.Lists=p.Lists;var f=r(3);t.spExtractODataId=f.spExtractODataId,t.spODataEntity=f.spODataEntity,t.spODataEntityArray=f.spODataEntityArray;var d=r(1);t.SharePointQueryable=d.SharePointQueryable,t.SharePointQueryableInstance=d.SharePointQueryableInstance,t.SharePointQueryableCollection=d.SharePointQueryableCollection;var h=r(23);t.RoleDefinitionBindings=h.RoleDefinitionBindings;var y=r(32);t.Search=y.Search,t.SearchQueryBuilder=y.SearchQueryBuilder,t.SearchResults=y.SearchResults,t.SortDirection=y.SortDirection,t.ReorderingRuleMatchType=y.ReorderingRuleMatchType,t.QueryPropertyValueType=y.QueryPropertyValueType,t.SearchBuiltInSourceId=y.SearchBuiltInSourceId;var g=r(34);t.SearchSuggest=g.SearchSuggest,t.SearchSuggestResult=g.SearchSuggestResult;var v=r(35);t.Site=v.Site,n(r(42)),n(r(17));var m=r(43);t.UtilityMethod=m.UtilityMethod;var b=r(38);t.WebPartDefinitions=b.WebPartDefinitions,t.WebPartDefinition=b.WebPartDefinition,t.WebPart=b.WebPart;var P=r(11);t.Web=P.Web},function(e,t){e.exports=r},,,function(e,t,r){"use strict";function n(e,t){return g(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,y.a.sp.web.lists.getByTitle(e).items.add(t)];case 1:return r.sent(),[2]}})})}function o(e,t,r,n,o,i){return g(this,void 0,void 0,function(){var a,s;return v(this,function(u){switch(u.label){case 0:return a=p(t),void 0!=o?[3,2]:[4,y.a.sp.web.lists.getByTitle(e).items.select(a).top(r).orderBy(n).get()];case 1:return s=u.sent(),[3,4];case 2:return[4,y.a.sp.web.lists.getByTitle(e).items.select(a).filter(o+" eq '"+i+"'").top(r).orderBy(n).get()];case 3:s=u.sent(),u.label=4;case 4:return[2,s]}})})}function i(e,t,r,n,o,i,a){return g(this,void 0,void 0,function(){var s,u;return v(this,function(l){switch(l.label){case 0:return s=p(t),""==a?[3,1]:[2,y.a.sp.web.lists.getByTitle(e).items.select(s).expand(a).filter(o+" eq '"+i+"'").top(r).orderBy(n).get()];case 1:return void 0!=o?[3,3]:[4,y.a.sp.web.lists.getByTitle(e).items.select(s).top(r).orderBy(n).get()];case 2:return u=l.sent(),[3,5];case 3:return[4,y.a.sp.web.lists.getByTitle(e).items.select(s).filter(o+" eq '"+i+"'").top(r).orderBy(n).get()];case 4:u=l.sent(),l.label=5;case 5:return[2,u]}})})}function a(e,t,r){return g(this,void 0,void 0,function(){var n;return v(this,function(o){switch(o.label){case 0:return[4,y.a.sp.web.lists.getByTitle(e).items.getById(t).update(r)];case 1:return n=o.sent(),[2,n]}})})}function s(e,t){return g(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,y.a.sp.web.lists.getByTitle(e).items.getById(t).delete()];case 1:return[2,r.sent()]}})})}function u(e,t){return g(this,void 0,void 0,function(){var r;return v(this,function(n){switch(n.label){case 0:return console.log("common"),[4,y.a.sp.web.folders.getByName(e).folders.getByName(t).delete()];case 1:return r=n.sent(),console.log(r),[2,r]}})})}function l(e,t,r){return g(this,void 0,void 0,function(){var n,o,i,a;return v(this,function(s){for(n=new h.Web(r),o=n.createBatch(),i=t.length,a=0;a<i;a++)n.lists.getByTitle(e).items.getById(t[a]).inBatch(o).delete();return o.execute().then(function(t){"Holiday"==e?window.location.href=r+"/Pages/ListView.aspx?CName="+e:location.reload()}),[2]})})}function c(e,t,r){return g(this,void 0,void 0,function(){var n;return v(this,function(o){return y.a.sp.web.siteUsers.getByEmail(t).groups.get().then(function(t){var o=e;n=$.grep(t,function(e,t){if(-1!=e.Title.indexOf(o))return!0}),r(n.length)}),[2]})})}function p(e){for(var t="",r=0;r<e.length;r++)t+=e[r]+",";return t.slice(0,-1)}function f(e){var t=new Date(e),r=t.getFullYear(),n=t.toLocaleString("en-us",{month:"long"}),o=t.getDate();return(o<10?"0"+o:o.toString())+" "+n.substr(0,3)+","+r}function d(e){for(var t=window.location.search.substring(1),r=t.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");if(o[0]==e)return o[1]}}r.d(t,"c",function(){return n}),r.d(t,"j",function(){return o}),r.d(t,"i",function(){return i}),r.d(t,"f",function(){return s}),r.d(t,"k",function(){return a}),r.d(t,"a",function(){return u}),r.d(t,"g",function(){return p}),r.d(t,"e",function(){return c}),r.d(t,"d",function(){return l}),r.d(t,"h",function(){return f}),r.d(t,"b",function(){return d});var h=r(19),y=r.n(h),g=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){u.label=r[1];break}if(6===r[0]&&u.label<a[1]){u.label=a[1],a=r;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(r);break}a[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}},,,,,,,,,,,,,,function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){!function(){var e=function(e,t){var r,n;if(e&&e.controller&&e.controller.collection){if(r=e.controller.collection.dataitems.length,jQuery.isNumeric(t.index)&&0<=t.index&&t.index<=e.controller.collection.dataitems.length&&(r=Number(t.index)),t.$item&&e.controller.collection.addDataItem(t.$item,e.controller.collection.paths,r),t.$items)if(n=t.$items,jQuery.isArray(n))for(var o=n.length-1;0<=o;o--)e.controller.collection.addDataItem(n[o],e.controller.collection.paths,r);else n=n.find(e.options.itemPath).addBack(e.options.itemPath),jQuery(n.get().reverse()).each(function(){e.controller.collection.addDataItem(jQuery(this),e.controller.collection.paths,r)});e.observer.trigger(e.observer.events.unknownStatusesChanged,[!1])}},t=function(e,t){var r;e&&e.controller&&e.controller.collection&&(t.$item&&(e.controller.collection.delDataitem(t.$item),t.$item.remove()),t.$items&&(r=t.$items,jQuery.isArray(t.$items)&&(r=jQuery(t.$items).map(function(){return this.toArray()})),e.controller.collection.delDataitems(r),r.remove()),e.observer.trigger(e.observer.events.unknownStatusesChanged,[!1]))},r=function(r,n,o){switch(n){case"add":e(r,o);break;case"del":t(r,o);break;case"empty":r&&r.controller&&r.controller.collection&&(r.controller.collection.empty(),r.observer.trigger(r.observer.events.unknownStatusesChanged,[!1]));break;case"getDataItems":return n=null,r.controller&&r.controller.collection&&(n=r.controller.collection.dataitems),n;case"addControl":r&&r.panel&&r.controller&&(r.panel.addControl(o.$control),r.controller.addPaths(r.panel.paths))}},n=function(e){e.observer.on(e.observer.events.knownStatusesChanged,function(t,r){var n;if(r&&(n=e.panel.mergeStatuses(r))&&0<n.length&&(e.storage.save(n),e.controller.renderStatuses(n,e.history.getLastStatus()),n=!1,r)){for(var o=0;o<r.length;o++)if(r[o].isAnimateToTop){n=!0;break}n&&(n=jQuery(e.options.animateToTop).offset().top,jQuery("html, body").animate({scrollTop:n},e.options.animateToTopDuration))}}),e.observer.on(e.observer.events.unknownStatusesChanged,function(t,r){var n;n=e.panel.getStatuses(r),0<n.length&&(e.storage.save(n),e.controller.renderStatuses(n,e.history.getLastStatus()))}),e.observer.on(e.observer.events.statusesAppliedToList,function(t,r,n){e.panel.setStatuses(n),jQuery.fn.jplist.DeepLinksService.updateUrlPerControls(e.options,e.panel.getDeepLinksURLPerControls())}),e.observer.on(e.observer.events.statusesChangedByDeepLinks,function(t,r,n){e.panel.statusesChangedByDeepLinks(r,n)}),e.$root.find(e.options.iosBtnPath).on("click",function(){jQuery(this).next(e.options.panelPath).toggleClass("jplist-ios-show")})},o=function(e,t){var r={observer:null,panel:null,controller:null,storage:null,$root:t};return r.options=jQuery.extend(!0,{debug:!1,command:"init",commandData:{},itemsBox:".list",itemPath:".list-item",panelPath:".panel",noResults:".jplist-no-results",redrawCallback:"",iosBtnPath:".jplist-ios-button",animateToTop:"html, body",animateToTopDuration:0,effect:"",duration:300,fps:24,storage:"",storageName:"jplist",cookiesExpiration:-1,deepLinking:!1,hashStart:"#",delimiter0:":",delimiter1:"|",delimiter2:"~",delimiter3:"!",historyLength:10},e),r.observer=new jQuery.fn.jplist.PubSub(r.$root,r.options),r.history=new jQuery.fn.jplist.History(r.$root,r.options,r.observer),r.panel=new jQuery.fn.jplist.PanelController(t,r.options,r.history,r.observer),r.storage=new jQuery.fn.jplist.Storage(r.options.storage,r.options.storageName,r.options.cookiesExpiration),r.itemControls=new jQuery.fn.jplist.ItemControlCollection(r.options,r.observer,r.history,r.$root),r.controller=new jQuery.fn.jplist.DOMController(r.$root,r.options,r.observer,r.panel.paths),n(r),r.options.deepLinking?r.panel.setStatusesByDeepLink():r.panel.setStatusesFromStorage(),jQuery.extend(this,r)};jQuery.fn.jplist=function(e){if(!e.command||"init"===e.command)return this.each(function(){var t,r=jQuery(this);t=new o(e,r),r.data("jplist",t)});var t;return(t=this.data("jplist"))?r(t,e.command,e.commandData):void 0},jQuery.jplist={},jQuery.fn.jplist.controls=jQuery.fn.jplist.controls||{},jQuery.fn.jplist.itemControls=jQuery.fn.jplist.itemControls||{},jQuery.fn.jplist.controlTypes={},jQuery.fn.jplist.itemControlTypes={},jQuery.fn.jplist.settings={},jQuery.fn.jplist.FiltersService=jQuery.fn.jplist.FiltersService||{},jQuery.fn.jplist.SortService=jQuery.fn.jplist.SortService||{}}(),function(){var e=function(e){var t=jQuery.fn.trigger;e.options.debug&&(jQuery.fn.trigger=function(r){for(var n in e.events)if(e.events[n]==r){console.log(n,arguments);break}return t.apply(this,arguments)})};jQuery.fn.jplist.PubSub=function(t,r){var n={options:r,$root:t,events:{unknownStatusesChanged:"1",knownStatusesChanged:"2",statusesChangedByDeepLinks:"3",listSorted:"4",listFiltered:"5",listPaginated:"6",dataItemAdded:"7",dataItemRemoved:"8",collectionReadyEvent:"9",statusesAppliedToList:"10"}};return e(n),jQuery.extend(!0,jQuery({}),this,n)}}(),function(){jQuery.fn.jplist.History=function(e,t,r){this.options=t,this.observer=r,this.$root=e,this.statusesQueue=[],this.listStatusesQueue=[]},jQuery.fn.jplist.History.prototype.addStatuses=function(e){for(var t=0;t<e.length;t++)this.statusesQueue.push(e[t]),this.statusesQueue.length>this.options.historyLength&&this.statusesQueue.shift()},jQuery.fn.jplist.History.prototype.getLastStatus=function(){var e=null;return 0<this.statusesQueue.length&&(e=this.statusesQueue[this.statusesQueue.length-1]),e},jQuery.fn.jplist.History.prototype.getLastList=function(){var e=null;return 0<this.listStatusesQueue.length&&(e=this.listStatusesQueue[this.listStatusesQueue.length-1]),e},jQuery.fn.jplist.History.prototype.addList=function(e){this.listStatusesQueue.push(e),this.listStatusesQueue.length>this.options.historyLength&&this.listStatusesQueue.shift()},jQuery.fn.jplist.History.prototype.popList=function(){var e=null;return 0<this.listStatusesQueue.length&&(e=this.listStatusesQueue.pop()),e}}(),function(){jQuery.fn.jplist.StatusDTO=function(e,t,r,n,o,i,a,s){this.action=t,this.name=e,this.type=r,this.data=n,this.inStorage=o,this.inAnimation=i,this.isAnimateToTop=a,this.inDeepLinking=s}}(),function(){jQuery.fn.jplist.StatusesService=jQuery.fn.jplist.StatusesService||{},jQuery.fn.jplist.StatusesService.getStatusesByAction=function(e,t){for(var r,n=[],o=0;o<t.length;o++)r=t[o],r.action===e&&n.push(r);return n},jQuery.fn.jplist.StatusesService.getSortStatuses=function(e){var t,r,n=[];if(e=jQuery.fn.jplist.StatusesService.getStatusesByAction("sort",e),jQuery.isArray(e))for(var o=0;o<e.length;o++)if((t=e[o])&&t.data&&t.data.sortGroup&&jQuery.isArray(t.data.sortGroup)&&0<t.data.sortGroup.length)for(var i=0;i<t.data.sortGroup.length;i++)r=new jQuery.fn.jplist.StatusDTO(t.name,t.action,t.type,t.data.sortGroup[i],t.inStorage,t.inAnimation,t.isAnimateToTop,t.inDeepLinking),n.push(r);else n.push(t);return n},jQuery.fn.jplist.StatusesService.getFilterStatuses=function(e){var t,r,n=[];if(e=jQuery.fn.jplist.StatusesService.getStatusesByAction("filter",e),jQuery.isArray(e))for(var o=0;o<e.length;o++)(t=e[o])&&t.data&&t.data.filterType&&(r=jQuery.fn.jplist.DTOMapperService.filters[t.data.filterType],jQuery.isFunction(r)&&n.push(t));return n};var e=function(e,t,r,n){for(var o,i=[],a=0;a<e.length;a++)o=e[a],o[t]===r&&(n&&(o.initialIndex=a),i.push(o));return i};jQuery.fn.jplist.StatusesService.add=function(t,r,n){var o,i,a;if(0===t.length)t.push(r);else if(o=e(t,"action",r.action,!0),0===o.length)t.push(r);else if(i=e(o,"name",r.name,!1),0===i.length)t.push(r);else{a=!1;for(var s=0;s<i.length;s++)o=i[s],o.type===r.type&&(a=!0,n&&(t[o.initialIndex]=r));a||t.push(r)}}}(),function(){jQuery.fn.jplist.DTOMapperService=jQuery.fn.jplist.DTOMapperService||{},jQuery.fn.jplist.DTOMapperService.filters={},jQuery.fn.jplist.DTOMapperService.filters.TextFilter=function(e,t){var r=new jQuery.fn.jplist.PathModel(e.data.path,null);return jQuery.fn.jplist.FiltersService.textFilter(e.data.value,r,t,e.data.ignore,e.data.mode,e.data.not,e.data.and,e.data.or)},jQuery.fn.jplist.DTOMapperService.filters.path=function(e,t){var r=new jQuery.fn.jplist.PathModel(e.data.path,null);return jQuery.fn.jplist.FiltersService.pathFilter(r,t)},jQuery.fn.jplist.DTOMapperService.filters.range=function(e,t){var r=new jQuery.fn.jplist.PathModel(e.data.path,null);return jQuery.fn.jplist.FiltersService.rangeFilter(r,t,e.data.min,e.data.max,e.data.prev,e.data.next)},jQuery.fn.jplist.DTOMapperService.filters.date=function(e,t){var r=new jQuery.fn.jplist.PathModel(e.data.path,null);return jQuery.fn.jplist.FiltersService.dateFilter(e.data.year,e.data.month,e.data.day,r,t,e.data.format)},jQuery.fn.jplist.DTOMapperService.filters.dateRange=function(e,t){var r=new jQuery.fn.jplist.PathModel(e.data.path,null);return jQuery.fn.jplist.FiltersService.dateRangeFilter(r,t,e.data.format,e.data.prev_year,e.data.prev_month,e.data.prev_day,e.data.next_year,e.data.next_month,e.data.next_day)},jQuery.fn.jplist.DTOMapperService.filters.pathGroup=function(e,t){return jQuery.fn.jplist.FiltersService.pathGroupFilter(e.data.pathGroup,t)},jQuery.fn.jplist.DTOMapperService.filters.textGroup=function(e,t){return jQuery.fn.jplist.FiltersService.textGroupFilter(e.data.textGroup,e.data.logic,e.data.path,e.data.ignoreRegex,t,e.data.mode)},jQuery.fn.jplist.DTOMapperService.filters.textFilterPathGroup=function(e,t){return jQuery.fn.jplist.FiltersService.textFilterPathGroup(e.data.textAndPathsGroup,e.data.ignoreRegex,t,e.data.mode)},jQuery.fn.jplist.DTOMapperService.sort={},jQuery.fn.jplist.DTOMapperService.sort.text=function(e,t,r){var n=new jQuery.fn.jplist.PathModel(e.data.path,e.data.type);return jQuery.fn.jplist.SortService.textHelper(t,r,e.data.order,n,e.data.ignore||"")},jQuery.fn.jplist.DTOMapperService.sort.number=function(e,t,r){var n=new jQuery.fn.jplist.PathModel(e.data.path,e.data.type);return jQuery.fn.jplist.SortService.numbersHelper(t,r,e.data.order,n)},jQuery.fn.jplist.DTOMapperService.sort.datetime=function(e,t,r){var n=new jQuery.fn.jplist.PathModel(e.data.path,e.data.type);return jQuery.fn.jplist.SortService.datetimeHelper(t,r,e.data.order,n,e.data.dateTimeFormat||"")}}(),function(){jQuery.fn.jplist.PathModel=function(e,t){this.jqPath=e,this.dataType=t},jQuery.fn.jplist.PathModel.prototype.isEqual=function(e,t){var r=!1;return t?this.jqPath===e.jqPath&&(r=!0):this.jqPath===e.jqPath&&this.dataType===e.dataType&&(r=!0),r}}(),function(){jQuery.fn.jplist.DataItemMemberModel=function(e,t){this.$element=e,this.path=t,this.text=e.text(),this.html=e.html()}}(),function(){var e=function(e,t){for(var r,n,o=[],i=0;i<t.length;i++)r=t[i],n=e.$item.find(r.jqPath).addBack(r.jqPath),0<n.length&&(r=new jQuery.fn.jplist.DataItemMemberModel(n,r),o.push(r));return r=new jQuery.fn.jplist.PathModel("",null),r=new jQuery.fn.jplist.DataItemMemberModel(e.$item,r),o.push(r),o};jQuery.fn.jplist.DataItemModel=function(t,r,n){this.pathitems=[],this.jqElement=this.$item=t,this.index=n,this.html=jQuery.fn.jplist.HelperService.getOuterHtml(t),this.pathitems=e(this,r)},jQuery.fn.jplist.DataItemModel.prototype.findPathitem=function(e){for(var t,r=null,n=0;n<this.pathitems.length;n++)if(t=this.pathitems[n],t.path.isEqual(e,!0)){r=t;break}return r},jQuery.fn.jplist.DataItemModel.prototype.addPaths=function(t){this.pathitems=this.pathitems.concat(e(this,t))}}(),function(){var e=function(e,t){var r,n,o;if(r=jQuery.fn.jplist.StatusesService.getFilterStatuses(t),0<r.length){for(var i=0;i<r.length;i++)n=r[i],o=jQuery.fn.jplist.DTOMapperService.filters[n.data.filterType],e.dataview=o(n,e.dataview);e.observer.trigger(e.observer.events.listFiltered,[t,e])}},t=function(e,t){var r,n=null,o=0,i=0;if(r=jQuery.fn.jplist.StatusesService.getStatusesByAction("paging",t),0<r.length){for(var a=0;a<r.length;a++)n=r[a],n.data&&(jQuery.isNumeric(n.data.currentPage)&&(o=n.data.currentPage),jQuery.isNumeric(n.data.number)||"all"===n.data.number)&&(i=n.data.number);for(n=new jQuery.fn.jplist.PaginationService(o,i,e.dataview.length),o=0;o<r.length;o++)r[o].data&&(r[o].data.paging=n);e.dataview=jQuery.fn.jplist.FiltersService.pagerFilter(n,e.dataview),e.observer.trigger(e.observer.events.listPaginated,[t,e])}},r=function(e,t){var r=[],r=jQuery.fn.jplist.StatusesService.getSortStatuses(t);0<r.length&&(jQuery.fn.jplist.SortService.doubleSort(r,e.dataview),e.observer.trigger(e.observer.events.listSorted,[t,e]))},n=function(e){return jQuery(e.dataview).map(function(e,t){return t.jqElement.get()})},o=function(e){return jQuery(e.dataitems).map(function(e,t){return t.jqElement.get()})},i=function(e){e.dataview=jQuery.merge([],e.dataitems)},a=function(e,t){for(var r,n,o=-1,i=0;i<e.dataitems.length;i++)if(r=e.dataitems[i],r=jQuery.fn.jplist.HelperService.getOuterHtml(r.jqElement),n=jQuery.fn.jplist.HelperService.getOuterHtml(t),r===n){o=i;break}return o},s=function(e,t){var r;-1!==(r=a(e,t))&&(e.dataitems.splice(r,1),e.observer.trigger(e.observer.events.dataItemRemoved,[t,e.dataitems]))},u=function(e,t){t.each(function(){s(e,jQuery(this))})},l=function(e,t,r,n){t=new jQuery.fn.jplist.DataItemModel(t,r,n),e.dataitems.splice(n,0,t),e.observer.trigger(e.observer.events.dataItemAdded,[t,e.dataitems])},c=function(e,t,r,n,o){for(var i;r<t.length;r++)i=t.eq(r),3!==i.get(0).nodeType&&(l(e,i,n,r),r+1<t.length&&0==r%50&&window.setTimeout(function(){c(e,t,r,n,o)},0))};jQuery.fn.jplist.Dataitems=function(e,t,r){this.dataitems=[],this.dataview=[],this.paths=r,this.observer=e,0<t.length&&(c(this,t,0,r,0),i(this)),this.observer.trigger(this.observer.events.collectionReadyEvent,[this])},jQuery.fn.jplist.Dataitems.prototype.addPaths=function(e){for(var t=0;t<this.dataitems.length;t++)this.dataitems[t].addPaths(e);i(this)},jQuery.fn.jplist.Dataitems.prototype.applyStatuses=function(o){return i(this),r(this,o),e(this,o),t(this,o),this.observer.trigger(this.observer.events.statusesAppliedToList,[this,o]),n(this)},jQuery.fn.jplist.Dataitems.prototype.filter=function(t){e(this,t)},jQuery.fn.jplist.Dataitems.prototype.sort=function(e){r(this,e)},jQuery.fn.jplist.Dataitems.prototype.pagination=function(e){t(this,e)},jQuery.fn.jplist.Dataitems.prototype.dataviewToJqueryObject=function(){return n(this)},jQuery.fn.jplist.Dataitems.prototype.dataitemsToJqueryObject=function(){return o(this)},jQuery.fn.jplist.Dataitems.prototype.resetDataview=function(){i(this)},jQuery.fn.jplist.Dataitems.prototype.empty=function(){o(this).detach(),this.dataitems=[],this.dataview=[]},jQuery.fn.jplist.Dataitems.prototype.addDataItem=function(e,t,r){l(this,e,t,r)},jQuery.fn.jplist.Dataitems.prototype.addDataItems=function(e,t,r){c(this,e,0,t,r),i(this)},jQuery.fn.jplist.Dataitems.prototype.delDataitem=function(e){s(this,e)},jQuery.fn.jplist.Dataitems.prototype.delDataitems=function(e){u(this,e)},jQuery.fn.jplist.Dataitems.prototype.indexOf=function(e){return a(this,e)},jQuery.fn.jplist.Dataitems.prototype.dataviewToString=function(){var e,t,r="";for(t=0;t<this.dataview.length;t++)e=this.dataview[t],r+=e.html;return r}}(),function(){jQuery.fn.jplist.PaginationService=function(e,t,r){r=Number(r),isNaN(r)&&(r=0),r=this.itemsNumber=r,jQuery.isNumeric(t)?(t=Number(t),isNaN(t)&&(t=r)):t=r,this.itemsOnPage=t,t=(t=this.itemsOnPage)?Math.ceil(this.itemsNumber/t):0,t=this.pagesNumber=t,e=Number(e),isNaN(e)&&(e=0),e>t-1&&(e=0),this.currentPage=e,this.start=this.currentPage*this.itemsOnPage,e=this.itemsNumber,t=this.start+this.itemsOnPage,t>e&&(t=e),this.end=t,e=this.currentPage,this.prevPage=0>=e?0:e-1,e=this.currentPage,t=this.pagesNumber,this.nextPage=0===t?0:e>=t-1?t-1:e+1}}(),function(){jQuery.fn.jplist.PaginationGoogleService=function(e,t,r){r=Number(r),isNaN(r)&&(r=0),r=this.itemsNumber=r,jQuery.isNumeric(t)?(t=Number(t),isNaN(t)&&(t=r)):t=r,this.itemsOnPage=t,t=(t=this.itemsOnPage)?Math.ceil(this.itemsNumber/t):0,t=this.pagesNumber=t,e=Number(e),isNaN(e)&&(e=0),e>t-1&&(e=0),this.currentPage=e,this.start=this.currentPage*this.itemsOnPage,e=this.itemsNumber,t=this.start+this.itemsOnPage,t>e&&(t=e),this.end=t,e=this.currentPage,this.prevPage=0>=e?0:e-1,e=this.currentPage,t=this.pagesNumber,this.nextPage=0===t?0:e>=t-1?t-1:e+1}}(),function(){jQuery.fn.jplist.FiltersService.dateFilter=function(e,t,r,n,o,i){for(var a,s,u=[],l=0;l<o.length;l++)a=o[l],(s=a.findPathitem(n))&&(jQuery.isNumeric(e)&&jQuery.isNumeric(t)&&jQuery.isNumeric(r)?(s=jQuery.fn.jplist.HelperService.formatDateTime(s.text,i))&&jQuery.isFunction(s.getFullYear)&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r&&u.push(a)):u.push(a));return u}}(),function(){jQuery.fn.jplist.FiltersService.dateRangeFilter=function(e,t,r,n,o,i,a,s,u){for(var l,c,p,f,d=[],h=0;h<t.length;h++)l=t[h],(c=l.findPathitem(e))&&(p=!jQuery.isNumeric(n)||!jQuery.isNumeric(o)||!jQuery.isNumeric(i),f=!jQuery.isNumeric(a)||!jQuery.isNumeric(s)||!jQuery.isNumeric(u),p||f?d.push(l):(f=jQuery.fn.jplist.HelperService.formatDateTime(c.text,r))&&jQuery.isFunction(f.getFullYear)&&(c=new Date(n,o,i),p=new Date(a,s,u),f.setHours(0),f.setMinutes(0),f.setSeconds(0),f>=c&&f<=p&&d.push(l)));return d}}(),function(){jQuery.fn.jplist.FiltersService.pagerFilter=function(e,t){return t.slice(e.start,e.end)}}(),function(){jQuery.fn.jplist.FiltersService.pathFilter=function(e,t){for(var r,n=[],o=0;o<t.length;o++)r=t[o],"default"===e.jqPath?n.push(r):r.findPathitem(e)&&n.push(r);return n}}(),function(){jQuery.fn.jplist.FiltersService.pathGroupFilter=function(e,t){var r,n,o=[],i=[];if(0>=e.length)return t;for(n=0;n<e.length;n++)r=e[n],r=new jQuery.fn.jplist.PathModel(r,null),o.push(r);for(var a=0;a<t.length;a++){n=t[a];for(var s=0;s<o.length;s++){if(r=o[s],"default"===r.jqPath){i.push(n);break}(r=n.findPathitem(r))&&i.push(n)}}return i}}(),function(){jQuery.fn.jplist.FiltersService.rangeFilter=function(e,t,r,n,o,i){for(var a,s,u=[],l=[],c=0;c<t.length;c++)l=[],a=t[c],(r=a.findPathitem(e))&&0<r.$element.length&&(r.$element.each(function(){var e=Number(jQuery(this).text().replace(/[^-0-9\.]+/g,""));isNaN(e)||l.push(e)}),0<l.length&&(n=Math.max.apply(Math,l),r=Math.min.apply(Math,l),s=!0,jQuery.isNumeric(o)&&o>r&&(s=!1),jQuery.isNumeric(i)&&n>i&&(s=!1),s&&u.push(a)));return u}}(),function(){var e=function(t,r,n,o){var i;if(!(n<r.length))return jQuery.trim(jQuery.fn.jplist.HelperService.removeCharacters(t,o));if(i=r[n],o=t.split(i),!(1<o.length))return e(t,r,n+1);for(o={operator:i,nodes:o},i=0;i<o.nodes.length;i++)t=o.nodes[i],o.nodes[i]=e(t,r,n+1);return o},t=function(e,r,n,o,i){var a=!0;if(e.nodes){for(a=0;a<e.nodes.length;a++)t(e.nodes[a],r,n,o,i);a=e.nodes,e=e.operator;var s,u;s=-1!==r.indexOf(a[0]);for(var l=1;l<a.length;l++)""!==(u=a[l])&&(-1!==n.indexOf(e)&&(s=s&&-1===r.indexOf(u)),-1!==o.indexOf(e)&&(s=s&&-1!==r.indexOf(u)),-1!==i.indexOf(e)&&(s=s||-1!==r.indexOf(u)));a=s}else a=-1!==r.indexOf(e);return a};jQuery.fn.jplist.FiltersService.advancedSearchParse=function(r,n,o,i,a,s){var u;return i&&0!=i.length||(i=["-"]),a&&0!=a.length||(a=["&&"]),s&&0!=s.length||(s=[","]),u=s.concat(a).concat(i),n=e(n,u,0,o),t(n,r,i,a,s)}}(),function(){jQuery.fn.jplist.FiltersService.textGroupFilter=function(e,t,r,n,o,i){var a,s,u;i=[];var l,c;if(0>=e.length)return o;u=new jQuery.fn.jplist.PathModel(r,null);for(var p=0;p<o.length;p++)if(r=o[p],s=r.findPathitem(u),"default"===u.jqPath)i.push(r);else if(s)if(s=jQuery.fn.jplist.HelperService.removeCharacters(s.text,n),"or"===t){for(c=0;c<e.length;c++)if(a=e[c],a=jQuery.fn.jplist.HelperService.removeCharacters(a,n),jQuery.fn.jplist.FiltersService.advancedSearchParse(s,a)){i.push(r);break}}else{for(l=[],c=0;c<e.length;c++)a=e[c],a=jQuery.fn.jplist.HelperService.removeCharacters(a,n),jQuery.fn.jplist.FiltersService.advancedSearchParse(s,a)&&l.push(a);l.length===e.length&&i.push(r)}return i}}(),function(){jQuery.fn.jplist.FiltersService.textFilter=function(e,t,r,n,o,i,a,s){var u,l,c,p=[];o=o||"contains";for(var f=0;f<r.length;f++)if(u=r[f],l=u.findPathitem(t),"default"===t.jqPath)p.push(u);else if(l)switch(l=jQuery.trim(jQuery.fn.jplist.HelperService.removeCharacters(l.text,n)),c=jQuery.trim(jQuery.fn.jplist.HelperService.removeCharacters(e,n)),o){case"startsWith":l.startsWith(c)&&p.push(u);break;case"endsWith":l.endsWith(c)&&p.push(u);break;case"advanced":jQuery.fn.jplist.FiltersService.advancedSearchParse(l,c,n,i,a,s)&&p.push(u);break;case"equal":l===c&&p.push(u);break;default:-1!==l.indexOf(c)&&p.push(u)}return p}}(),function(){jQuery.fn.jplist.FiltersService.textFilterPathGroup=function(e,t,r,n){var o,i;n=[];var a,s,u,l=[];for(u=0;u<e.length;u++)s=e[u],s.selected&&(o=s.path,i=new jQuery.fn.jplist.PathModel(o,null),s.pathObj=i,n.push(s));if(0>=n.length)return r;for(o=0;o<r.length;o++){e=r[o],u=!1;for(var c=0;c<n.length;c++)if(s=n[c],i=s.pathObj){if("default"===i.jqPath){u=!0;break}if(i=e.findPathitem(i))switch(i=jQuery.trim(jQuery.fn.jplist.HelperService.removeCharacters(i.text,t)),a=jQuery.trim(jQuery.fn.jplist.HelperService.removeCharacters(s.text,t)),s.mode){case"startsWith":i.startsWith(a)&&(u=!0);break;case"endsWith":i.endsWith(a)&&(u=!0);break;case"advanced":jQuery.fn.jplist.FiltersService.advancedSearchParse(i,a)&&(u=!0);break;case"equal":i===a&&(u=!0);break;default:-1!==i.indexOf(a)&&(u=!0)}}u&&l.push(e)}return l}}(),function(){jQuery.fn.jplist.SortService.datetimeHelper=function(e,t,r,n,o){return e=e.findPathitem(n),t=t.findPathitem(n),e&&t?(jQuery.trim(o)?(n=jQuery.fn.jplist.HelperService.formatDateTime(e.text,o),o=jQuery.fn.jplist.HelperService.formatDateTime(t.text,o)):(n=new Date(Date.parse(e.text)),o=new Date(Date.parse(t.text))),n==o?0:"asc"==r?n>o?1:-1:n<o?1:-1):0},jQuery.fn.jplist.SortService.datetime=function(e,t,r,n){r.sort(function(r,o){return jQuery.fn.jplist.SortService.datetimeHelper(r,o,e,t,n)})}}(),function(){jQuery.fn.jplist.SortService.numbersHelper=function(e,t,r,n){return e=e.findPathitem(n),t=t.findPathitem(n),e&&t?(n=parseFloat(e.text.replace(/[^-0-9\.]+/g,"")),t=parseFloat(t.text.replace(/[^-0-9\.]+/g,"")),r=n==t?0:"asc"==r?isNaN(n)?1:isNaN(t)?-1:n-t:isNaN(n)?1:isNaN(t)?-1:t-n):0},jQuery.fn.jplist.SortService.numbers=function(e,t,r){r.sort(function(r,n){return jQuery.fn.jplist.SortService.numbersHelper(r,n,e,t)})}}(),function(){jQuery.fn.jplist.SortService.textHelper=function(e,t,r,n,o){return e=e.findPathitem(n),t=t.findPathitem(n),e&&t?(o?(n=new RegExp(o,"ig"),o=e.text.toString().replace(n,"").toLowerCase(),e=t.text.toString().replace(n,"").toLowerCase()):(o=e.text.toString().toLowerCase(),e=t.text.toString().toLowerCase()),o===e?0:"".localeCompare?"asc"===r?o.localeCompare(e):e.localeCompare(o):"asc"===r?o>e?1:-1:o<e?1:-1):0},jQuery.fn.jplist.SortService.text=function(e,t,r,n){r.sort(function(r,o){return jQuery.fn.jplist.SortService.textHelper(r,o,e,t,n)})}}(),function(){var e=function(t,r,n,o){var i,a,s=0;return 0<n.length&&(i=n[o],"default"!==i.data.path?(a=jQuery.fn.jplist.DTOMapperService.sort[i.data.type],jQuery.isFunction(a)&&(s=a(i,t,r))):(s=t.index,i=r.index,s=s===i?0:isNaN(s)?1:isNaN(i)?-1:s-i),0===s&&o+1<n.length&&(s=e(t,r,n,o+1))),s};jQuery.fn.jplist.SortService.doubleSort=function(t,r){var n=!1;return 1===t.length&&t[0]&&t[0].data&&"default"===t[0].data.path&&(n=!0),n||r.sort(function(r,n){return e(r,n,t,0)}),r}}(),function(){jQuery.jplist.sort=function(e,t,r,n,o,i,a){return("asc"!==t&&"desc"!==t||"text"!==r&&"number"!==r&&"datetime"!==r)&&console.log("valdation error"),t={action:"sort",name:"sort",type:"sort",data:{path:n,type:r,order:t,dateTimeFormat:i,ignore:o},inStorage:!1,inAnimation:!1,isAnimateToTop:!1,inDeepLinking:!1},n=[new jQuery.fn.jplist.PathModel(n,r)],r=new jQuery.fn.jplist.PubSub(jQuery("<div></div>"),{}),e=new jQuery.fn.jplist.Dataitems(r,e,n),e.sort([t]),"html"===a?e.dataviewToString():e.dataviewToJqueryObject()}}(),function(){var e=function(e,t){var r=null;return"{month}"==e?(t=t.toLowerCase(),"january"!==t&&"jan"!==t&&"jan."!==t||(r=0),"february"!==t&&"feb"!==t&&"feb."!==t||(r=1),"march"!==t&&"mar"!==t&&"mar."!==t||(r=2),"april"!=t&&"apr"!==t&&"apr."!==t||(r=3),"may"===t&&(r=4),"july"!=t&&"jun"!==t&&"jun."!==t||(r=5),"april"!==t&&"jul"!==t&&"jul."!==t||(r=6),"august"!==t&&"aug"!==t&&"aug."!==t||(r=7),"september"!==t&&"sep"!==t&&"sep."!==t||(r=8),"october"!==t&&"oct"!==t&&"oct."!==t||(r=9),"november"!==t&&"nov"!==t&&"nov."!==t||(r=10),"december"!==t&&"dec"!==t&&"dec."!==t||(r=11),null===r&&(r=parseInt(t,10),isNaN(r)||r--)):r=parseInt(t,10),r},t=function(e,t){var r,n=null;return r=e.replace(/{year}|{month}|{day}|{hour}|{min}|{sec}/g,".*"),(r=new RegExp(r,"g").exec(t))&&1<r.length&&(n=r[1]),n};jQuery.fn.jplist.HelperService={},jQuery.fn.jplist.HelperService.getOuterHtml=function(e){var t,r,n="";if(e&&e[0]&&e[0].tagName){t=e[0].attributes,r=e.html(),e=e[0].tagName.toString().toLowerCase();for(var n=n+"<"+e,o=0;o<t.length;o++)t[o].nodeValue&&(n+=" "+t[o].nodeName+"=",n+='"'+t[o].nodeValue+'"');n=n+">"+r,n+="</"+e+">"}return n},jQuery.fn.jplist.HelperService.removeCharacters=function(e,t){return e?e.replace(new RegExp(t,"ig"),"").toLowerCase():""},jQuery.fn.jplist.HelperService.formatDateTime=function(r,n){var o,i,a,s,u,l;return n=n.replace(/\./g,"\\."),n=n.replace(/\(/g,"\\("),n=n.replace(/\)/g,"\\)"),n=n.replace(/\[/g,"\\["),n=n.replace(/\]/g,"\\]"),o=n.replace("{year}","(.*)"),(i=t(o,r))&&(i=e("{year}",i)),o=n.replace("{day}","(.*)"),(s=t(o,r))&&(s=e("{day}",s)),o=n.replace("{month}","(.*)"),(a=t(o,r))&&(a=e("{month}",a)),o=n.replace("{hour}","(.*)"),(u=t(o,r))&&(u=e("{hour}",u)),o=n.replace("{min}","(.*)"),(l=t(o,r))&&(l=e("{min}",l)),o=n.replace("{sec}","(.*)"),(o=t(o,r))&&(o=e("{sec}",o)),i&&!isNaN(i)||(i=1900),a&&!isNaN(a)||(a=0),s&&!isNaN(s)||(s=1),u&&!isNaN(u)||(u=0),l&&!isNaN(l)||(l=0),o&&!isNaN(o)||(o=0),new Date(i,a,s,u,l,o)}}(),function(){jQuery.fn.jplist.DeepLinksService={},jQuery.fn.jplist.DeepLinksService.getUrlParams=function(e){var t,r,n=[],o=[],n=window.decodeURIComponent(jQuery.trim(window.location.hash.replace(e.hashStart,"")));if(e.deepLinking&&""!==jQuery.trim(n))for(var n=n.split(e.delimiter1),i=0;i<n.length;i++)t=n[i],r=t.split("="),2===r.length&&(t=r[0],r=r[1],t=t.split(e.delimiter0),2===t.length&&(t={controlName:t[0],propName:t[1],propValue:r},o.push(t)));return o},jQuery.fn.jplist.DeepLinksService.updateUrlPerControls=function(e,t){if(e.deepLinking){var r,n=jQuery.trim(t.replace(e.hashStart,"")),n=""===n?e.hashStart:e.hashStart+n;window.location.hash!==n&&(r=window.location.href.indexOf(e.hashStart),n=-1==r?window.location.href+n:window.location.href.substring(0,r)+n,"replaceState"in window.history?window.history.replaceState("","",n):window.location.replace(n))}}}(),function(){var e=function(e,t,r,n){var o=t.dataitemsToJqueryObject(),i=t.dataviewToJqueryObject(),a=!1,s=jQuery.extend(!0,{},e.options,{duration:0});return 0>=o.length||0>=i.length?(e.$noResults.removeClass("jplist-hidden"),e.$itemsBox.addClass("jplist-hidden"),jQuery.isFunction(e.redrawCallback)&&e.redrawCallback(t,i,r)):(e.$noResults.addClass("jplist-hidden"),e.$itemsBox.removeClass("jplist-hidden"),e.effect&&jQuery.fn.jplist.animation?(n&&!n.inAnimation&&(a=!0),n=a?s:e.options,jQuery.fn.jplist.animation.drawItems(n,e.$itemsBox,o,i,e.effect,function(){jQuery.isFunction(e.redrawCallback)&&e.redrawCallback(t,i,r)},e.observer)):(o.detach(),e.$itemsBox.append(i),jQuery.isFunction(e.redrawCallback)&&e.redrawCallback(t,i,r))),i};jQuery.fn.jplist.DOMView=function(e,t,r,n,o,i,a){this.options=t,this.$root=e,this.observer=r,this.redrawCallback=i,this.effect=a,this.$itemsBox=e.find(n).eq(0),this.$noResults=e.find(o)},jQuery.fn.jplist.DOMView.prototype.render=function(t,r,n){return e(this,t,r,n)}}(),function(){jQuery.fn.jplist.DOMController=function(e,t,r,n){this.observer=r,this.$root=e,this.listView=new jQuery.fn.jplist.DOMView(e,t,r,t.itemsBox,t.noResults,t.redrawCallback,t.effect),e=t.itemPath,t=this.$root.find(t.itemsBox).eq(0).find(e),this.collection=new jQuery.fn.jplist.Dataitems(this.observer,t,n)},jQuery.fn.jplist.DOMController.prototype.renderStatuses=function(e,t){var r;return this.collection&&(this.collection.applyStatuses(e),r=this.listView.render(this.collection,e,t)),r},jQuery.fn.jplist.DOMController.prototype.addPaths=function(e){this.collection.addPaths(e)}}(),function(){jQuery.fn.jplist.ItemControlFactory=function(e,t,r,n){this.options=e,this.observer=t,this.history=r,this.$root=n},jQuery.fn.jplist.ItemControlFactory.prototype.create=function(e){var t,r,n=null,o=null,i=null;return t=e.attr("data-control-type"),r={},jQuery.fn.jplist.itemControlTypes[t]&&(r=jQuery.extend(!0,{},r,jQuery.fn.jplist.itemControlTypes[t])),this.options.itemControlTypes&&this.options.itemControlTypes[t]&&(r=jQuery.extend(!0,{},r,this.options.itemControlTypes[t])),r&&(r.className&&(o=jQuery.fn.jplist.itemControls[r.className]),r.options&&(i=r.options)),t={type:t,itemControlType:r,controlTypeClass:o,controlOptions:i},t=jQuery.extend(!0,t,{$control:e,history:this.history,observer:this.observer,options:this.options,$root:this.$root}),t.controlTypeClass&&jQuery.isFunction(t.controlTypeClass)&&(n=new t.controlTypeClass(t)),n}}(),function(){var e=function(e,t){t&&0<t.length&&t.find("[data-control-type]").each(function(){var t=jQuery(this);(t=e.controlFactory.create(t))&&e.controls.push(t)})};jQuery.fn.jplist.ItemControlCollection=function(t,r,n,o){this.options=t,this.observer=r,this.history=n,this.$root=o,this.controls=[],this.controlFactory=new jQuery.fn.jplist.ItemControlFactory(t,r,n,o),this.options&&this.options.itemsBox&&e(this,this.$root.find(this.options.itemsBox))}}(),function(){var e=function(e){var t,r=jQuery(window).scrollTop();t=Number(e.data("top")),isNaN(t)||(r>t?e.addClass("jplist-sticky"):e.removeClass("jplist-sticky"))},t=function(t,r){r.each(function(){var t=jQuery(this),r=t.offset().top;t.data("top",r),e(t)}),jQuery(window).scroll(function(){r.each(function(){e(jQuery(this))})})},r=function(e){var t=[];if("cookies"===e.options.storage||"localstorage"===e.options.storage&&jQuery.fn.jplist.LocalStorageService.supported())if("cookies"===e.options.storage&&(t=jQuery.fn.jplist.CookiesService.restoreCookies(e.options.storageName)),"localstorage"===e.options.storage&&jQuery.fn.jplist.LocalStorageService.supported()&&(t=jQuery.fn.jplist.LocalStorageService.restore(e.options.storageName)),0<t.length){for(var r=[],o=0;o<t.length;o++)t[o].inStorage&&r.push(t[o]);0<r.length&&(e.controls.setStatuses(r,!0),e.observer.trigger(e.observer.events.knownStatusesChanged,[r]))}else n(e,!0);else n(e,!0)},n=function(e,t){var r;r=e.controls.getStatuses(t),0<r.length&&e.observer.trigger(e.observer.events.knownStatusesChanged,[r])};jQuery.fn.jplist.PanelController=function(e,r,n,o){this.options=r,this.$root=e,this.history=n,this.observer=o,this.controls=this.paths=this.$sticky=null,r=this.$root.find(this.options.panelPath).find("[data-control-type]"),this.controls=new jQuery.fn.jplist.ControlsCollection,this.controls.addList(r,this.history,this.$root,this.options,this.observer),this.paths=this.controls.getPaths(),this.$sticky=e.find('[data-sticky="true"]'),0<this.$sticky.length&&t(0,this.$sticky)},jQuery.fn.jplist.PanelController.prototype.addControl=function(e){this.controls.add(e,this.history,this.$root,this.options,this.observer),this.paths=this.controls.getPaths()},jQuery.fn.jplist.PanelController.prototype.setStatusesByDeepLink=function(){var e;e=jQuery.fn.jplist.DeepLinksService.getUrlParams(this.options),0>=e.length?r(this):this.controls.setDeepLinks(e,this.observer)},jQuery.fn.jplist.PanelController.prototype.setStatusesFromStorage=function(){r(this)},jQuery.fn.jplist.PanelController.prototype.setStatuses=function(e){this.history.addStatuses(e),this.controls.setStatuses(e,!1),this.history.addList(e)},jQuery.fn.jplist.PanelController.prototype.getStatuses=function(e){return this.controls.getStatuses(e)},jQuery.fn.jplist.PanelController.prototype.mergeStatuses=function(e){return this.controls.merge(!1,e)},jQuery.fn.jplist.PanelController.prototype.statusesChangedByDeepLinks=function(e,t){this.controls&&this.controls.statusesChangedByDeepLinks(t)},jQuery.fn.jplist.PanelController.prototype.getDeepLinksURLPerControls=function(){return this.controls.getDeepLinksUrl(this.options.delimiter1)}}(),function(){jQuery.fn.jplist.ControlFactory=function(e,t,r,n){this.options=e,this.observer=t,this.history=r,this.$root=n},jQuery.fn.jplist.ControlFactory.prototype.create=function(e,t){var r,n,o,i,a,s,u,l,c=null;return r=e.attr("data-control-type"),a=i=o=!0,s=!1,l=u=null,(n=e.attr("data-control-deep-link"))&&"false"===n.toString()&&(o=!1),(n=e.attr("data-control-storage"))&&"false"===n.toString()&&(i=!1),(n=e.attr("data-control-animation"))&&"false"===n.toString()&&(a=!1),(n=e.attr("data-control-animate-to-top"))&&"true"===n.toString()&&(s=!0),n={},jQuery.fn.jplist.controlTypes[r]&&(n=jQuery.extend(!0,{},n,jQuery.fn.jplist.controlTypes[r])),this.options.controlTypes&&this.options.controlTypes[r]&&(n=jQuery.extend(!0,{},n,this.options.controlTypes[r])),n&&(n.className&&(u=jQuery.fn.jplist.controls[n.className]),n.options&&(l=n.options)),r={type:r,action:e.attr("data-control-action"),name:e.attr("data-control-name"),inDeepLinking:o,inStorage:i,inAnimation:a,isAnimateToTop:s,controlType:n,controlTypeClass:u,controlOptions:l,paths:[]},r=jQuery.extend(!0,r,{$control:e,history:this.history,observer:this.observer,options:this.options,$root:this.$root,controlsCollection:t}),r.controlTypeClass&&jQuery.isFunction(r.controlTypeClass)&&(c=new r.controlTypeClass(r)),c},jQuery.fn.jplist.ControlFactory.prototype.getStatus=function(e){return null},jQuery.fn.jplist.ControlFactory.prototype.setStatus=function(e,t){},jQuery.fn.jplist.ControlFactory.prototype.getDeepLink=function(){return""},jQuery.fn.jplist.ControlFactory.prototype.getStatusByDeepLink=function(e,t){return null},jQuery.fn.jplist.ControlFactory.prototype.getPaths=function(e){return[]},jQuery.fn.jplist.ControlFactory.prototype.setByDeepLink=function(e){},jQuery.fn.jplist.ControlFactory.getProp=function(e,t){var r=[],n=new RegExp("^"+t+"[0-9]*$");return jQuery.each(e.data(),function(e,t){n.test(e)&&r.push(t)}),0==r.length?"":1==r.length?r[0]:r},jQuery.fn.jplist.ControlFactory.getPropPath=function(e,t){var r="";if(jQuery.isArray(e))for(var n=0;n<e.length;n++){var o="";0!==n&&(o=""+n),r+="[data-"+t+o+'="'+e[n]+'"]'}else r+="[data-"+t+'="'+e+'"]';return r}}(),function(){var e=function(e,t){for(var r,n=[],o=0;o<e.controls.length;o++)r=e.controls[o],jQuery.isFunction(r.getStatus)&&(r=r.getStatus(t))&&jQuery.fn.jplist.StatusesService.add(n,r,!1);return n},t=function(e,t,r,n,o,i){return(t=new jQuery.fn.jplist.ControlFactory(o,i,r,n).create(t,e))&&e.controls.push(t),t},r=function(e,r,n,o,i,a){r.each(function(){t(e,jQuery(this),n,o,i,a)})};jQuery.fn.jplist.ControlsCollection=function(){this.controls=[]},jQuery.fn.jplist.ControlsCollection.prototype.merge=function(t,r){var n,o;o=[],n=e(this,t);for(var i=0;i<n.length;i++)jQuery.fn.jplist.StatusesService.add(o,n[i],!1);if(r)for(n=0;n<r.length;n++)jQuery.fn.jplist.StatusesService.add(o,r[n],!0);return o},jQuery.fn.jplist.ControlsCollection.prototype.statusesChangedByDeepLinks=function(e){for(var t,r=0;r<this.controls.length;r++)t=this.controls[r],jQuery.isFunction(t.setByDeepLink)&&t.setByDeepLink(e)},jQuery.fn.jplist.ControlsCollection.prototype.setDeepLinks=function(e,t){var r,n,o,i,a=[];for(i=0;i<e.length;i++){r=e[i],n=r.controlName;var s=[];o=void 0;for(var u=0;u<this.controls.length;u++)o=this.controls[u],o.name===n&&s.push(o);for(n=s,s=0;s<n.length;s++)o=n[s],jQuery.isFunction(o.getStatusByDeepLink)&&(o=o.getStatusByDeepLink(r.propName,r.propValue))&&jQuery.fn.jplist.StatusesService.add(a,o,!1)}t.trigger(t.events.knownStatusesChanged,[a]),t.trigger(t.events.statusesChangedByDeepLinks,[,a,e])},jQuery.fn.jplist.ControlsCollection.prototype.setStatuses=function(e,t){for(var r,n,o=[],i=0;i<e.length;i++){r=e[i],n=!1;for(var a=0;a<o.length;a++)o[a].name===r.name&&o[a].action===r.action&&(n=!0,o[a].statuses.push(r));n||o.push({name:r.name,action:r.action,statuses:[r]})}for(a=0;a<o.length;a++)if(r=o[a],r.statuses&&0<r.statuses.length){n=r.statuses[0].name;for(var i=r.statuses[0].action,s=[],u=void 0,l=0;l<this.controls.length;l++)u=this.controls[l],u.name===n&&u.action===i&&s.push(u);for(n=s,i=0;i<n.length;i++)jQuery.isFunction(n[i].setStatus)&&(1<r.statuses.length?n[i].setStatus(r.statuses,t):n[i].setStatus(r.statuses[0],t))}},jQuery.fn.jplist.ControlsCollection.prototype.getDeepLinksUrl=function(e){var t;t="";var r,n=[],o="";r=this.controls;for(var i=0;i<r.length;i++)t=r[i],jQuery.isFunction(t.getDeepLink)&&(o=jQuery.trim(t.getDeepLink())),""!==o&&-1===jQuery.inArray(o,n)&&n.push(o);return t=n.join(e)},jQuery.fn.jplist.ControlsCollection.prototype.getStatuses=function(t){return e(this,t)},jQuery.fn.jplist.ControlsCollection.prototype.getPaths=function(){for(var e,t=[],r=[],n=0;n<this.controls.length;n++)if(e=this.controls[n],jQuery.isFunction(e.getPaths))for(e.getPaths(t),e=0;e<t.length;e++){for(var o=r,i=t[e],a=void 0,s=!1,u=0;u<o.length;u++)if(a=o[u],a.isEqual(i,!0)){s=!0;break}s||r.push(t[e])}return r},jQuery.fn.jplist.ControlsCollection.prototype.add=function(e,r,n,o,i){t(this,e,r,n,o,i)},jQuery.fn.jplist.ControlsCollection.prototype.addList=function(e,t,n,o,i){r(this,e,t,n,o,i)}}(),function(){var e=function(e){var t=[];e=jQuery(),jQuery(document).find("[data-control-type]").each(function(){var e=jQuery(this),r=e.attr("data-control-type");r&&jQuery.fn.jplist.controlTypes[r]&&jQuery.fn.jplist.controlTypes[r].dropdown&&t.push(e)});for(var r=0;r<t.length;r++)e=e.add(t[r]);return e},t=function(t){var r=e(t);0<r.length&&(jQuery(document).click(function(){r.find("ul").hide()}),jQuery(document).off(t.DROPDOWN_CLOSE_EVENT).on(t.DROPDOWN_CLOSE_EVENT,function(e,t){r.each(function(){jQuery(this).is(t)||jQuery(this).find("ul").hide()})})),t.$control.find(".jplist-dd-panel").off().on("click",function(e){var r;e.stopPropagation(),e=jQuery(this).parents("[data-control-type]"),r=e.find("ul"),jQuery(document).trigger(t.DROPDOWN_CLOSE_EVENT,[e]),r.toggle(0)})},r=function(e,r,n,o){return e={options:e,observer:r,history:n,$control:o,DROPDOWN_CLOSE_EVENT:"dropdown-close-event"},r=e.$control.find("li:eq(0)"),r.addClass("active"),r=r.find("span"),0>=e.$control.find(".jplist-dd-panel").length&&e.$control.prepend('<div class="jplist-dd-panel">'+r.text()+"</div>"),t(e),jQuery.extend(this,e)};jQuery.fn.jplist.DropdownControl=function(e,t,n,o){return new r(e,t,n,o)}}(),function(){jQuery.fn.jplist.Storage=function(e,t,r){this.storageType=e,this.storageName=t,this.cookiesExpiration=r,this.isStorageEnabled="cookies"===e||"localstorage"===e&&jQuery.fn.jplist.LocalStorageService.supported()},jQuery.fn.jplist.Storage.prototype.save=function(e){var t,r=[];if(e&&this.isStorageEnabled){for(var n=0;n<e.length;n++)t=e[n],t.inStorage&&r.push(t);"cookies"===this.storageType&&jQuery.fn.jplist.CookiesService.saveCookies(r,this.storageName,this.cookiesExpiration),"localstorage"===this.storageType&&jQuery.fn.jplist.LocalStorageService.supported()&&jQuery.fn.jplist.LocalStorageService.save(r,this.storageName)}}}(),function(){jQuery.fn.jplist.CookiesService={},jQuery.fn.jplist.CookiesService.setCookie=function(e,t,r){t=escape(t);var n=new Date;r=Number(r),-1==r||isNaN(r)?document.cookie=e+"="+t+";path=/;":(n.setMinutes(n.getMinutes()+r),document.cookie=e+"="+t+";path=/; expires="+n.toUTCString())},jQuery.fn.jplist.CookiesService.getCookie=function(e){var t,r,n,o=null;n=document.cookie.split(";");for(var i=0;i<n.length;i++)if(t=n[i].substr(0,n[i].indexOf("=")),r=n[i].substr(n[i].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))==e){o=unescape(r);break}return o},jQuery.fn.jplist.CookiesService.saveCookies=function(e,t,r){e=JSON.stringify(e),jQuery.fn.jplist.CookiesService.setCookie(t,e,r)},jQuery.fn.jplist.CookiesService.restoreCookies=function(e){var t=[];return(e=jQuery.fn.jplist.CookiesService.getCookie(e))&&(t=jQuery.parseJSON(e)),t||(t=[]),t}}(),function(){jQuery.fn.jplist.LocalStorageService={},jQuery.fn.jplist.LocalStorageService.supported=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},jQuery.fn.jplist.LocalStorageService.save=function(e,t){var r;r=JSON.stringify(e),window.localStorage[t]=r},jQuery.fn.jplist.LocalStorageService.restore=function(e){var t=[];return(e=window.localStorage[e])&&(t=jQuery.parseJSON(e)),t||(t=[]),t}}()},function(e,t){!function(){var e=function(e){return jQuery.extend(this,e)};e.prototype.setStatus=function(e,t){var r,n;if(jQuery.isArray(e))for(n=0;n<e.length;n++)e[n].data&&e[n].data.paging&&(r=e[n].data.paging);else e.data&&(r=e.data.paging);!r||0>=r.pagesNumber?(this.$control.html(""),this.$control.addClass("jplist-empty")):(this.$control.removeClass("jplist-empty"),n=this.$control.attr("data-type"),n=n.replace("{current}",r.currentPage+1),n=n.replace("{pages}",r.pagesNumber),n=n.replace("{start}",r.start+1),n=n.replace("{end}",r.end),n=n.replace("{all}",r.itemsNumber),this.$control.html(n))},jQuery.fn.jplist.controls.PaginationInfo=function(t){return new e(t)},jQuery.fn.jplist.controlTypes["pagination-info"]={className:"PaginationInfo",options:{}}}(),function(){var e=function(e,t){var r;r=null;var n;return n=!1,r=e.$control.find("button[data-active]").eq(0),0>=r.length&&(r=e.$control.find("button").eq(0)),r=t?0:Number(r.attr("data-number"))||0,(n="true"===e.$control.attr("data-jump-to-start")||e.controlOptions.jumpToStart)&&(n=e.history.getLastStatus())&&"pagination"!==n.type&&"views"!==n.type&&(r=0),n=Number(e.$control.attr("data-items-per-page"))||0,r=new jQuery.fn.jplist.controls.PaginationDTO(r,n),r=new jQuery.fn.jplist.StatusDTO(e.name,e.action,e.type,r,e.inStorage,e.inAnimation,e.isAnimateToTop,e.inDeepLinking)},t=function(t){t.$control.on("click","button",function(){var r,n=null;r=jQuery(this);var o;r=Number(r.attr("data-number"))||0,n=e(t,!1),n.data.currentPage=r,o=t.$root.find('[data-control-type="pagination"]'),o.find("button").removeAttr("data-active"),o.find('button[data-number="'+r+'"]').each(function(){jQuery(this).attr("data-active",!0)}),t.observer.trigger(t.observer.events.knownStatusesChanged,[[n]])})},r=function(e){return e.params={view:new jQuery.fn.jplist.controls.PaginationView(e.$control,e.controlOptions)},t(e),jQuery.extend(this,e)};r.prototype.getStatus=function(t){return e(this,t)},r.prototype.getDeepLink=function(){var t,r="";return this.inDeepLinking&&(t=e(this,!1),t.data)&&(jQuery.isNumeric(t.data.currentPage)&&(r=this.name+this.options.delimiter0+"currentPage="+t.data.currentPage),this.$control.attr("data-items-per-page")?(r&&(r+=this.options.delimiter1),r+=this.name+this.options.delimiter0+"number="+t.data.number):(jQuery.isNumeric(t.data.number)||"all"===t.data.number)&&(r=this.name+this.options.delimiter0+"number="+t.data.number)),r},r.prototype.getStatusByDeepLink=function(t,r){var n;e:if(n=null,this.inDeepLinking){if("currentPage"!==t){n=null;break e}n=e(this,!0),n.data&&"currentPage"===t&&(n.data.currentPage=r)}return n},r.prototype.setStatus=function(e,t){var r;if(jQuery.isArray(e))for(var n=0;n<e.length;n++)e[n].data&&e[n].data.paging&&(r=e[n].data.paging);else e.data&&(r=e.data.paging);r&&this.params.view.build(r)},jQuery.fn.jplist.controls.Pagination=function(e){return new r(e)},jQuery.fn.jplist.controlTypes.pagination={className:"Pagination",options:{}}}(),function(){var e=function(e,t,r,n){var o="";e=e.$control.attr("data-number-title")||e.options.numberArrowTitle;for(var o=o+'<div class="jplist-pagesbox" data-type="pagesbox">',i=t;i<r;i++)o+='<button type="button" data-type="page" ',i===n&&(o+=' class="jplist-current" data-active="true" '),t=i+1,o+=' data-number="'+i+'" ',o+=' title="'+e.replace("{number}",t)+'" ',o+=">"+t+"</button> ";return o+"</div>"},t=function(e,t){var r,n,o,i,a,s,u,l,c={$control:e,options:t,$pagingprev:null,$pagingmid:null,$pagingnext:null,$jplistFirst:null,$jplistPrev:null,$jplistNext:null,$jplistLast:null,mode:e.attr("data-mode")};return r=c.$control.attr("data-prev")||c.options.prevArrow,n=c.$control.attr("data-prev-title")||c.options.prevArrowTitle,o=c.$control.attr("data-next")||c.options.nextArrow,i=c.$control.attr("data-next-title")||c.options.nextArrowTitle,a=c.$control.attr("data-first")||c.options.firstArrow,s=c.$control.attr("data-first-title")||c.options.firstArrowTitle,u=c.$control.attr("data-last")||c.options.lastArrow,l=c.$control.attr("data-last-title")||c.options.lastArrowTitle,c.$control.html('<div class="jplist-pagingprev" data-type="pagingprev"></div><div class="jplist-pagingmid" data-type="pagingmid"></div><div class="jplist-pagingnext" data-type="pagingnext"></div>'),c.$pagingprev=c.$control.find('[data-type="pagingprev"]'),c.$pagingmid=c.$control.find('[data-type="pagingmid"]'),c.$pagingnext=c.$control.find('[data-type="pagingnext"]'),c.$pagingprev.html('<button type="button" class="jplist-first" data-number="0" data-type="first" title="'+s+'">'+a+'</button><button type="button" class="jplist-prev" data-type="prev" title="'+n+'">'+r+"</button>"),c.$pagingnext.html('<button type="button" class="jplist-next" data-type="next" title="'+i+'">'+o+'</button><button type="button" class="jplist-last" data-type="last" title="'+l+'">'+u+"</button>"),c.$jplistFirst=c.$pagingprev.find('[data-type="first"]'),c.$jplistPrev=c.$pagingprev.find('[data-type="prev"]'),c.$jplistNext=c.$pagingnext.find('[data-type="next"]'),c.$jplistLast=c.$pagingnext.find('[data-type="last"]'),jQuery.extend(this,c)};t.prototype.build=function(t){if(0<=t.currentPage&&t.currentPage<t.pagesNumber){switch(this.$control.removeClass("jplist-hidden"),this.mode){case"google-like":var r,n="";r=Number(this.$control.attr("data-range"))||this.options.range,n=t.currentPage-Math.floor((r-1)/2),0>n&&(n=0),r=n+r,r>t.pagesNumber&&(r=t.pagesNumber),n=e(this,n,r,t.currentPage),this.$pagingmid.html(n);break;default:var o;o=Number(this.$control.attr("data-range"))||this.options.range,r=Math.floor(t.currentPage/o),n=o*(r+1),n>t.pagesNumber&&(n=t.pagesNumber),n=e(this,o*r,n,t.currentPage),this.$pagingmid.html(n)}this.$jplistPrev.attr("data-number",t.prevPage).removeClass("jplist-current"),this.$jplistNext.attr("data-number",t.nextPage).removeClass("jplist-current"),this.$jplistLast.attr("data-number",t.pagesNumber-1).removeClass("jplist-current"),1>=t.pagesNumber?this.$control.addClass("jplist-one-page"):this.$control.removeClass("jplist-one-page")}else this.$control.addClass("jplist-hidden");0===t.currentPage?this.$pagingprev.addClass("jplist-hidden"):this.$pagingprev.removeClass("jplist-hidden"),t.currentPage==t.pagesNumber-1?this.$pagingnext.addClass("jplist-hidden"):this.$pagingnext.removeClass("jplist-hidden")},jQuery.fn.jplist.controls.PaginationView=function(e,r){return new t(e,r)},jQuery.fn.jplist.controlTypes.pagination={className:"Pagination",options:{range:7,jumpToStart:!1,prevArrow:"&lsaquo;",nextArrow:"&rsaquo;",firstArrow:"&laquo;",lastArrow:"&raquo;",prevArrowTitle:"",nextArrowTitle:"",firstArrowTitle:"",lastArrowTitle:"",numberArrowTitle:""}}}(),function(){jQuery.fn.jplist.controls.PaginationDTO=function(e,t){var r={currentPage:e,paging:null};return t&&(r.number=t),r}}(),function(){var e=function(e,t){var r=null;return t?(r=e.$control.find('li:has(span[data-default="true"])').eq(0),0>=r.length&&(r=e.$control.find("li:eq(0)"))):r=e.$control.find(".active"),r=r.find("span"),r=new jQuery.fn.jplist.controls.DropdownPaginationDTO(r.attr("data-number")),r=new jQuery.fn.jplist.StatusDTO(e.name,e.action,e.type,r,e.inStorage,e.inAnimation,e.isAnimateToTop,e.inDeepLinking)},t=function(e,t){var r,n,o;e.$control.find("span").each(function(){r=jQuery(this).attr("data-path"),n=jQuery(this).attr("data-type"),r&&""!==jQuery.trim(r)&&(o=new jQuery.fn.jplist.PathModel(r,n),t.push(o))})},r=function(t){t.$control.find("li").off().on("click",function(){var r,n,o,i;r=e(t,!1),i=jQuery(this).find("span"),n=i.attr("data-path"),o=i.attr("data-number"),n?(r.data.path=n,r.data.type=i.attr("data-type"),r.data.order=i.attr("data-order")):o&&(r.data.number=o),t.observer.trigger(t.observer.events.knownStatusesChanged,[[r]])})},n=function(e){return new jQuery.fn.jplist.DropdownControl(e.options,e.observer,e.history,e.$control),r(e),jQuery.extend(this,e)};n.prototype.getStatus=function(t){return e(this,t)},n.prototype.getDeepLink=function(){var t,r="";return this.inDeepLinking&&(t=e(this,!1),t.data&&(jQuery.isNumeric(t.data.number)||"all"===t.data.number)&&(r=this.name+this.options.delimiter0+"number="+t.data.number)),r},n.prototype.getStatusByDeepLink=function(t,r){var n;e:if(n=null,this.inDeepLinking){if("number"!==t&&t!=="path"+this.options.delimiter2+"type"+this.options.delimiter2+"order"&&"path"!==t){n=null;break e}n=e(this,!0),n.data&&"number"===t&&jQuery.isNumeric(n.data.number)&&(n.data.number=r)}return n},n.prototype.getPaths=function(e){t(this,e)},n.prototype.setStatus=function(e,t){var r,n;if(jQuery.isArray(e))for(n=0;n<e.length;n++)e[n].data&&e[n].data.number&&(r=e[n].data.number);else e.data&&(r=e.data.number);(jQuery.isNumeric(r)||"all"===r)&&(n=this.$control.find("li"),n.removeClass("active"),r=this.$control.find('li:has([data-number="'+r+'"])'),0===r.length&&(r=this.$control.find('li:has([data-number="all"])')),0>=r.length&&(r=n.eq(0)),r.addClass("active"),this.$control.find(".jplist-dd-panel").text(r.eq(0).text()))},jQuery.fn.jplist.controls.ItemsPerPageDropdown=function(e){return new n(e)},jQuery.fn.jplist.controlTypes["items-per-page-drop-down"]={className:"ItemsPerPageDropdown",options:{},dropdown:!0}}(),function(){var e=function(e,t){var r;return r=null,t?(r=e.$control.find('option[data-default="true"]').eq(0),0>=r.length&&(r=e.$control.find("option").eq(0))):r=e.$control.find("option:selected"),r=new jQuery.fn.jplist.controls.DropdownPaginationDTO(r.attr("data-number")),r=new jQuery.fn.jplist.StatusDTO(e.name,e.action,e.type,r,e.inStorage,e.inAnimation,e.isAnimateToTop,e.inDeepLinking)},t=function(e,t){var r,n,o;e.$control.find("option").each(function(){r=jQuery(this).attr("data-path"),n=jQuery(this).attr("data-type"),r&&(o=new jQuery.fn.jplist.PathModel(r,n),t.push(o))})},r=function(t){t.$control.change(function(){var r,n,o;r=e(t,!1),n=jQuery(this).find("option:selected"),o=n.attr("data-path"),n=n.attr("data-number"),o?(r.data.path=o,r.data.type=jQuery(this).attr("data-type"),r.data.order=jQuery(this).attr("data-order")):n&&(r.data.number=n),t.observer.trigger(t.observer.events.knownStatusesChanged,[[r]])})},n=function(e){return r(e),jQuery.extend(this,e)};n.prototype.getStatus=function(t){return e(this,t)},n.prototype.getDeepLink=function(){var t,r="";return this.inDeepLinking&&(t=e(this,!1),t.data&&(jQuery.isNumeric(t.data.number)||"all"===t.data.number)&&(r=this.name+this.options.delimiter0+"number="+t.data.number)),r},n.prototype.getStatusByDeepLink=function(t,r){var n=null;return this.inDeepLinking&&(n=e(this,!0),n.data&&"number"===t&&jQuery.isNumeric(n.data.number)&&(n.data.number=r)),n},n.prototype.getPaths=function(e){t(this,e)},n.prototype.setStatus=function(e,t){var r;if(jQuery.isArray(e))for(var n=0;n<e.length;n++)e[n].data&&e[n].data.number&&(r=e[n].data.number);else e.data&&(r=e.data.number);(jQuery.isNumeric(r)||"all"===r)&&(r=this.$control.find('option[data-number="'+r+'"]'),0===r.length&&(r=this.$control.find('option[data-number="all"]')),r.get(0).selected=!0)},jQuery.fn.jplist.controls.ItemsPerPageSelect=function(e){return new n(e)},jQuery.fn.jplist.controlTypes["items-per-page-select"]={className:"ItemsPerPageSelect",options:{}}}(),function(){jQuery.fn.jplist.controls.DropdownPaginationDTO=function(e){return{number:e}}}()},,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79),o=(r.n(n),r(47)),i=(r.n(o),r(46)),a=(r.n(i),r(123)),s=(r.n(a),r(82)),u=r(19),l=r.n(u),c=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();r(96),r(97),r(98),r(99);var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userflag=!1,t}return c(t,e),t.prototype.render=function(){var e=(this.context.pageContext.web.absoluteUrl,this);Object(s.e)("Corporate Discounts",this.context.pageContext.user.email,function(t){1==t?(e.userflag=!0,e.loadcomponent()):(e.userflag=!1,e.loadcomponent())})},t.prototype.loadcomponent=function(){var e=this,t=this.context.pageContext.web.absoluteUrl;this.domElement.innerHTML="<div class='breadcrumb bread-pos'><ol><li><a href='"+t+"/Pages/Home.aspx' title='Home' class='pointer'>Home</a></li><li><span>Corporate Discounts</span></li></ol><div class='input search'><input id='customSearch' class='CorporateDiscountsearch form-control' type='text' placeholder='Search..' name='search'><a id='corporateSearch' class='close-searchicon pointer' title='search'><i class='icon-search' style='float:right; margin: -20px 10px 10px 5px;'></i></a></div></div><div class='title-section'><div class='button-field'><a href='"+t+"/Pages/AddListItem.aspx?CName=Corporate%20Discounts' title='Add New' class='pointer' id='AddingButtons'><i class='icon-add'></i>Add New</a><a class='delete-icon pointer' title='Delete' id='DeletingButtons'><img src='"+t+"/_catalogs/masterpage/BloomHomepage/images/close-icon.png'>Delete</a></div><h2>Corporate Discounts</h2></div><div class='content-area'></div><div class='modal'>\x3c!-- Place at bottom of page --\x3e</div>",this.CorDis(null);var r=this;document.getElementById("corporateSearch").addEventListener("click",function(t){return e.corporateSearch()}),document.title="Corporate Discounts",$(document).keypress(function(e){if("13"==(e.which||e.keyCode||e.charCode)){$(".ajs-message").length>0&&$(".ajs-message").remove();var t=!0;if($("#customSearch").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Value"),t=!1),t){var n=$("#customSearch").val().trim();r.CorDis(n)}}}),$(document).on("keypress",function(){}).on("keydown",function(e){8!=e.keyCode||$("#customSearch").val().substring(1)||location.reload()})},t.prototype.corporateSearch=function(){$(".ajs-message").length>0&&$(".ajs-message").remove();var e=!0;if($("#customSearch").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Value"),e=!1),e){var t=$("#customSearch").val().trim();this.CorDis(t)}},t.prototype.CorDis=function(e){var t,r=this,n="<div id='pagination-list' class='list-section jplist'><ul class='list'>",o="",i="Not Displayed";t=e&&this.userflag?l.a.sp.web.lists.getByTitle("Corporate%20Discounts").items.select("ID","Title","Modified","VendorLogo","SiteLink","Display").filter("Title eq '"+e+"'"||"SiteLink eq '"+e+"'").top(100).get():e&&0==this.userflag?l.a.sp.web.lists.getByTitle("Corporate%20Discounts").items.select("ID","Title","Modified","VendorLogo","SiteLink","Display").filter("(Display eq '1' and Title eq '"+e+"' )"||"SiteLink eq '"+e+"'").top(100).get():0==this.userflag?Object(s.j)("Corporate%20Discounts",["ID","Title","Modified","VendorLogo","SiteLink","Display"],50,"Modified","Display",1):Object(s.j)("Corporate%20Discounts",["ID","Title","Modified","VendorLogo","SiteLink","Display"],50,"Modified"),t.then(function(e){if($(".content-area").empty(),e.length>0)for(var t=0;t<e.length;t++)"1"==e[t].Display?(o="checked",i="Displayed"):(o="",i="Not Displayed"),n+="<li class='list-item'><div class='list-imgcont'><div class='list-imgsec list-imgsec"+t+"'></div><p class='Modified'><strong>"+Object(s.h)(e[t].Modified)+"</strong></p><h3 class='CorTitle'>"+e[t].Title+"</h3><div class='switch'><input type='checkbox' id='switch"+e[t].ID+"' class='switch-input sndswitch' "+o+"/><label for='switch"+e[t].ID+"' class='switch-label sndswitch'>"+i+"</label><div class='list-icons'><div class='icon-list2 viewitem'><a  title='View' class='viewitem pointer'  id='viewitem"+e[t].ID+"'><i class='icon-eye viewitem'></i></a></div><div class='icon-list2 edititemuser edititem'><a  title='Edit' class='edititem pointer' id='edititem"+e[t].ID+"'><i class='icon-edit edititem' ></i></a></div><div class='icon-list2 deleteitemuser'><div class='check-box'><input type='checkbox' name='' value='' class='delete-item' id='deleteitem"+e[t].ID+"'/><label>Checkbox</label></div></div></div></div></div></li>";else n+="<li class='list-item'>No items to display</li>";n+="</ul>",n+="<div class='jplist-panel box panel-top'><div class='jplist-pagination' data-control-type='pagination' data-control-name='paging' data-control-action='paging'></div><select class='jplist-select' data-control-type='items-per-page-select' data-control-name='paging' data-control-action='paging'><option data-number='5' data-default='true'> 5 </option><option data-number='10'> 10 </option><option data-number='15'> 15 </option></select></div>",$(".content-area").append(n);for(var t=0;t<e.length;t++)if(null!=e[t].VendorLogo)$(".list-imgsec"+t).append("<img src='"+e[t].VendorLogo.Url+"' alt='' title=''>");else{var a=r.context.pageContext.web.absoluteUrl,u=a+"/_catalogs/masterpage/BloomHomepage/images/logo.png";$(".list-imgsec"+t).append("<img src='"+u+"' alt='' title=''>")}0==r.userflag?($(".edititemuser").hide(),$(".deleteitemuser").hide(),$(".sndswitch").hide(),$(".button-field").hide(),$(".viewitem").show()):($(".edititemuser").show(),$(".deleteitemuser").show());for(var l=document.getElementsByClassName("viewitem"),t=0;t<l.length;t++)l[t].addEventListener("click",function(e){return r.viewitem()});for(var c=document.getElementsByClassName("edititem"),t=0;t<c.length;t++)c[t].addEventListener("click",function(e){return r.edititem()});document.getElementById("DeletingButtons").addEventListener("click",function(e){return r.deleteitems()}),$("#pagination-list").jplist({itemsBox:".list",itemPath:".list-item",panelPath:".jplist-panel"}),$(document).on("change",".switch-input",function(){var e=$(this).attr("id").replace("switch",""),t=$(this);if(t.prop("checked")){var r={Display:!0};t.next().text("Displayed"),t.attr("checked","checked");var n=Object(s.k)("Corporate%20Discounts",e,r);n.then(function(e){})}else{var r={Display:!1};t.next().text("Not Displayed"),t.removeAttr("checked");var n=Object(s.k)("Corporate%20Discounts",e,r);n.then(function(e){})}})})},t.prototype.viewitem=function(){var e=this.context.pageContext.web.absoluteUrl;$("a.viewitem").click(function(){$(this).attr("id");window.location.href=e+"/Pages/Viewlistitem.aspx?CName=Corporate%20Discounts&CID="+$(this).attr("id").replace("viewitem","")+"&CMode=ViewMode"})},t.prototype.edititem=function(){var e=this.context.pageContext.web.absoluteUrl;$("a.edititem").click(function(){$(this).attr("id");window.location.href=e+"/Pages/EditListItem.aspx?CName=Corporate%20Discounts&CID="+$(this).attr("id").replace("edititem","")+"&CMode=EditMode"})},t.prototype.deleteitems=function(){var e=[],t=$("body");if($(".delete-item:checked").each(function(){e.push($(this).attr("id").replace("deleteitem",""))}),e.length>0){var r=this;alertify.confirm("Confirmation","Are you sure you want to delete selected item(s)?",function(){var n=e;t.addClass("loading"),Object(s.d)("Corporate Discounts",n,r.context.pageContext.web.absoluteUrl)},function(){}).set("closable",!1)}else alertify.set("notifier","position","top-right"),alertify.error("Please select at least one item")},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return n.Version.parse("1.0")},enumerable:!0,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:a.PropertyPaneDescription},groups:[{groupName:a.BasicGroupName,groupFields:[Object(o.PropertyPaneTextField)("description",{label:a.DescriptionFieldLabel})]}]}]}},t}(o.BaseClientSideWebPart);t.default=p},function(e,t){e.exports=i}])});