define("40c027de-7e35-441d-a789-ca5f8d776ed3_0.0.1",["jquery","@microsoft/sp-webpart-base","bootstrap","AddListItemWebPartStrings"],function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=102)}([function(e,t,n){"use strict";(function(e){function i(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);t.extractWebUrl=i;var o=function(){function t(){}return t.getCtxCallback=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return function(){t.apply(e,n)}},t.urlParamExists=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),new RegExp("[\\?&]"+e+"=([^&#]*)").test(location.search)},t.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},t.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e);return!(""===t||/false|0/i.test(t))},t.stringInsert=function(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e},t.dateAdd=function(e,t,n){var i=new Date(e);switch(t.toLowerCase()){case"year":i.setFullYear(i.getFullYear()+n);break;case"quarter":i.setMonth(i.getMonth()+3*n);break;case"month":i.setMonth(i.getMonth()+n);break;case"week":i.setDate(i.getDate()+7*n);break;case"day":i.setDate(i.getDate()+n);break;case"hour":i.setTime(i.getTime()+36e5*n);break;case"minute":i.setTime(i.getTime()+6e4*n);break;case"second":i.setTime(i.getTime()+1e3*n);break;default:i=void 0}return i},t.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>0){var i=document.createElement("link");n[0].appendChild(i),i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",e)}},t.combinePaths=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.filter(function(e){return!t.stringIsNullOrEmpty(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")},t.getRandomString=function(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<e;i++)t[i]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")},t.getGUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},t.isFunction=function(e){return"function"==typeof e},t.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},t.stringIsNullOrEmpty=function(e){return void 0===e||null===e||e.length<1},t.extend=function(e,t,n){if(void 0===n&&(n=!1),null===t||void 0===t)return e;var i=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return i(e,t)}).reduce(function(e,n){return e[n]=t[n],e},e)},t.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},t.toAbsoluteUrl=function(n){return new Promise(function(i){if(t.isUrlAbsolute(n))return i(n);if(null!==r.RuntimeConfig.spBaseUrl)return i(t.combinePaths(r.RuntimeConfig.spBaseUrl,n));if(void 0!==e._spPageContextInfo){if(e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return i(t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,n));if(e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return i(t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,n))}if(void 0!==e.location){var o=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var r=o.indexOf(e);if(r>0)return i(t.combinePaths(o.substr(0,r),n))})}return i(n)})},t}();t.Util=o}).call(t,n(30))},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(9),a=n(10),s=n(2),l=n(5),c=n(20),d=n(21),u=n(22),p=function(e){function t(t,n){var i=e.call(this)||this;if(i._options={},i._query=new o.Dictionary,i._batch=null,"string"==typeof t){var a=t;if(r.Util.isUrlAbsolute(a)||a.lastIndexOf("/")<0)i._parentUrl=a,i._url=r.Util.combinePaths(a,n);else if(a.lastIndexOf("/")>a.lastIndexOf("(")){var s=a.lastIndexOf("/");i._parentUrl=a.slice(0,s),n=r.Util.combinePaths(a.slice(s),n),i._url=r.Util.combinePaths(i._parentUrl,n)}else{var s=a.lastIndexOf("(");i._parentUrl=a.slice(0,s),i._url=r.Util.combinePaths(a,n)}}else{var l=t;i._parentUrl=l._url,i._options=l._options;var c=l._query.get("@target");null!==c&&i._query.add("@target",c),i._url=r.Util.combinePaths(i._parentUrl,n)}return i}return i(t,e),t.prototype.addBatchDependency=function(){return this.hasBatch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return null!==this._batch},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype.as=function(e){var t=new e(this._url,null);return r.Util.extend(t,this,!0)},t.prototype.inBatch=function(e){if(null!==this._batch)throw new s.AlreadyInBatchException;return this._batch=e,this},t.prototype.toUrlAndQuery=function(){var e=new o.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,i){return l.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+i,l.LogLevel.Verbose),e.add(n,"'"+i+"'"),n});return e.merge(this._query),e.count()>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},t.prototype.getParent=function(e,t,n,i){void 0===t&&(t=this.parentUrl);var r=new e(t,n);r.configure(this._options);var o=this.query.get("@target");return null!==o&&r.query.add("@target",o),void 0!==i&&(r=r.inBatch(i)),r},t.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var i=new e(this,t);i.configure(this._options);var r=this.query.get("@target");return null!==r&&i.query.add("@target",r),n&&this.hasBatch&&(i=i.inBatch(this.batch)),i},t.prototype.toRequestContext=function(e,t,n,i){var o=this;void 0===t&&(t={}),void 0===i&&(i=d.PipelineMethods.default);var s=this.hasBatch?this.addBatchDependency():function(){};return r.Util.toAbsoluteUrl(this.toUrlAndQuery()).then(function(l){return a.mergeOptions(t,o._options),{batch:o._batch,batchDependency:s,cachingOptions:o._cachingOptions,clientFactory:function(){return new u.HttpClient},isBatched:o.hasBatch,isCached:o._useCaching,options:t,parser:n,pipeline:i,requestAbsoluteUrl:l,requestId:r.Util.getGUID(),verb:e}})},t}(c.ODataQueryable);t.SharePointQueryable=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),i=[],r=t?" asc":" desc",o=0;o<n.length;o++)if("$orderby"===n[o]){i.push(this._query.get("$orderby"));break}return i.push(""+e+r),this._query.add("$orderby",i.join(",")),this},t.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t}(p);t.SharePointQueryableCollection=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(p);t.SharePointQueryableInstance=f},function(e,t,n){"use strict";function i(e){o.Logger.log({data:{},level:o.LogLevel.Error,message:"["+e.name+"]::"+e.message})}var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=function(e){function t(t,n,i){var r=e.call(this,"Error making HttpClient request in queryable: ["+t+"] "+n)||this;return r.status=t,r.statusText=n,r.data=i,r.name="ProcessHttpClientResponseException",o.Logger.log({data:r.data,level:o.LogLevel.Error,message:r.message}),r}return r(t,e),t}(Error);t.ProcessHttpClientResponseException=a;var s=function(e){function t(t){void 0===t&&(t="Cannot create a caching configuration provider since cache is not available.");var n=e.call(this,t)||this;return n.name="NoCacheAvailableException",i(n),n}return r(t,e),t}(Error);t.NoCacheAvailableException=s;var l=function(e){function t(t){void 0===t&&(t="Unable to determine API url.");var n=e.call(this,t)||this;return n.name="APIUrlException",i(n),n}return r(t,e),t}(Error);t.APIUrlException=l;var c=function(e){function t(t,n){void 0===n&&(n="Auth URL Endpoint could not be determined from data. Data logged.");var i=e.call(this,n)||this;return i.name="APIUrlException",o.Logger.log({data:t,level:o.LogLevel.Error,message:i.message}),i}return r(t,e),t}(Error);t.AuthUrlException=c;var d=function(e){function t(t){void 0===t&&(t="Using NodeFetchClient in the browser is not supported.");var n=e.call(this,t)||this;return n.name="NodeFetchClientUnsupportedException",i(n),n}return r(t,e),t}(Error);t.NodeFetchClientUnsupportedException=d;var u=function(e){function t(){var t=this,n=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" ");return t=e.call(this,n)||this,t.name="SPRequestExecutorUndefinedException",i(t),t}return r(t,e),t}(Error);t.SPRequestExecutorUndefinedException=u;var p=function(e){function t(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var n=e.call(this,t)||this;return n.name="MaxCommentLengthException",i(n),n}return r(t,e),t}(Error);t.MaxCommentLengthException=p;var h=function(e){function t(t){void 0===t&&(t="This operation");var n=e.call(this,t+" is not supported as part of a batch.")||this;return n.name="NotSupportedInBatchException",i(n),n}return r(t,e),t}(Error);t.NotSupportedInBatchException=h;var f=function(e){function t(t,n){void 0===n&&(n="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var i=e.call(this,n)||this;return i.name="ODataIdException",o.Logger.log({data:t,level:o.LogLevel.Error,message:i.message}),i}return r(t,e),t}(Error);t.ODataIdException=f;var g=function(e){function t(t){var n=e.call(this,t)||this;return n.name="BatchParseException",i(n),n}return r(t,e),t}(Error);t.BatchParseException=g;var m=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var n=e.call(this,t)||this;return n.name="AlreadyInBatchException",i(n),n}return r(t,e),t}(Error);t.AlreadyInBatchException=m;var y=function(e){function t(t){void 0===t&&(t="This query is already part of a batch.");var n=e.call(this,t)||this;return n.name="FunctionExpectedException",i(n),n}return r(t,e),t}(Error);t.FunctionExpectedException=y;var b=function(e){function t(t){var n=e.call(this,t)||this;return n.name="UrlException",i(n),n}return r(t,e),t}(Error);t.UrlException=b},function(e,t,n){"use strict";function i(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new d.ODataIdException(e)}function r(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?l.Util.combinePaths(l.extractWebUrl(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(c.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",c.LogLevel.Warning),"")}function o(e){return new p(e)}function a(e){return new h(e)}var s=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var l=n(0),c=n(5),d=n(2),u=n(14);t.spExtractODataId=i;var p=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){var t=new n.factory(r(e),null);return l.Util.extend(t,e)},n}return s(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){var t=new n.factory(r(e),null);return l.Util.extend(t,e)})},t}(u.ODataParserBase),h=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){return e.map(function(e){var t=new n.factory(r(e),null);return l.Util.extend(t,e)})},n}return s(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new n.factory(r(e),null);return l.Util.extend(t,e)})})},t}(u.ODataParserBase);t.spGetEntityUrl=r,t.spODataEntity=o,t.spODataEntityArray=a},function(e,t,n){"use strict";function i(e){a.set(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),o=function(){function e(){this._defaultCachingStore="session",this._defaultCachingTimeoutSeconds=60,this._globalCacheDisable=!1,this._enableCacheExpiration=!1,this._cacheExpirationIntervalMilliseconds=750,this._spfxContext=null,this._spFetchClientFactory=function(){return new r.FetchClient},this._spBaseUrl=null,this._spHeaders=null,this._graphHeaders=null,this._graphFetchClientFactory=function(){return null}}return e.prototype.set=function(e){var t=this;if(e.hasOwnProperty("globalCacheDisable")&&(this._globalCacheDisable=e.globalCacheDisable),e.hasOwnProperty("defaultCachingStore")&&(this._defaultCachingStore=e.defaultCachingStore),e.hasOwnProperty("defaultCachingTimeoutSeconds")&&(this._defaultCachingTimeoutSeconds=e.defaultCachingTimeoutSeconds),e.hasOwnProperty("sp")&&(e.sp.hasOwnProperty("fetchClientFactory")&&(this._spFetchClientFactory=e.sp.fetchClientFactory),e.sp.hasOwnProperty("baseUrl")&&(this._spBaseUrl=e.sp.baseUrl),e.sp.hasOwnProperty("headers")&&(this._spHeaders=e.sp.headers)),e.hasOwnProperty("spfxContext")&&(this._spfxContext=e.spfxContext,void 0!==this._spfxContext.graphHttpClient&&(this._graphFetchClientFactory=function(){return t._spfxContext.graphHttpClient})),e.hasOwnProperty("graph")&&(e.graph.hasOwnProperty("headers")&&(this._graphHeaders=e.graph.headers),e.graph.hasOwnProperty("fetchClientFactory")&&(this._graphFetchClientFactory=e.graph.fetchClientFactory)),e.hasOwnProperty("enableCacheExpiration")&&(this._enableCacheExpiration=e.enableCacheExpiration),e.hasOwnProperty("cacheExpirationIntervalMilliseconds")){var n=e.cacheExpirationIntervalMilliseconds<300?300:e.cacheExpirationIntervalMilliseconds;this._cacheExpirationIntervalMilliseconds=n}},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this._defaultCachingStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this._defaultCachingTimeoutSeconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this._globalCacheDisable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spFetchClientFactory",{get:function(){return this._spFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spBaseUrl",{get:function(){return null!==this._spBaseUrl?this._spBaseUrl:null!==this._spfxContext?this._spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spHeaders",{get:function(){return this._spHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this._enableCacheExpiration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this._cacheExpirationIntervalMilliseconds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this._spfxContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphFetchClientFactory",{get:function(){return this._graphFetchClientFactory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphHeaders",{get:function(){return this._graphHeaders},enumerable:!0,configurable:!0}),e}();t.RuntimeConfigImpl=o;var a=new o;t.RuntimeConfig=a,t.setRuntimeConfig=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(i=t.LogLevel||(t.LogLevel={}));var r=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new o),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=i.Verbose),e.instance.log({level:n,message:t})},e.writeJSON=function(t,n){void 0===n&&(n=i.Verbose),e.instance.log({level:n,message:JSON.stringify(t)})},e.log=function(t){e.instance.log(t)},e.measure=function(t,n){return e.instance.measure(t,n)},e}();t.Logger=r;var o=function(){function e(e,t){void 0===e&&(e=i.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=i.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){void 0===e||e.level<this.activeLogLevel||this.subscribers.map(function(t){return t.log(e)})},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}(),a=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case i.Verbose:case i.Info:console.log(t);break;case i.Warning:console.warn(t);break;case i.Error:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")},e}();t.ConsoleListener=a;var s=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();t.FunctionListener=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(9),a=n(44),s=n(20),l=n(21),c=function(e){function t(t,n){var i=e.call(this)||this;if(i._query=new o.Dictionary,"string"==typeof t){var a=t;i._parentUrl=a,i._url=r.Util.combinePaths(a,n)}else{var s=t;i._parentUrl=s._url,i._url=r.Util.combinePaths(i._parentUrl,n)}return i}return i(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return r.Util.extend(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this;return this.toUrl()+"?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")},t.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},t.prototype.clone=function(e,t,n){return void 0===n&&(n=!0),new e(this,t)},t.prototype.toRequestContext=function(e,t,n,i){return void 0===t&&(t={}),void 0===i&&(i=l.PipelineMethods.default),Promise.resolve({batch:null,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new a.GraphHttpClient},isBatched:!1,isCached:this._useCaching,options:t,parser:n,pipeline:i,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:r.Util.getGUID(),verb:e})},t}(s.ODataQueryable);t.GraphQueryable=c;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.filter=function(e){return this._query.add("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),i=[],r=t?" asc":" desc",o=0;o<n.length;o++)if("$orderby"===n[o]){i.push(this._query.get("$orderby"));break}return i.push(""+e+r),this._query.add("$orderby",i.join(",")),this},t.prototype.top=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skip=function(e){return this._query.add("$top",e.toString()),this},t.prototype.skipToken=function(e){return this._query.add("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this._query.add("$count","true"),this},enumerable:!0,configurable:!0}),t}(c);t.GraphQueryableCollection=d;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.search=function(e){return this._query.add("$search",e),this},t}(d);t.GraphQueryableSearchableCollection=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},t}(c);t.GraphQueryableInstance=p},function(e,t,n){"use strict";function i(){return new l}var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(14),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(o.ODataParserBase);t.ODataDefaultParser=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})},t}(o.ODataParserBase);t.ODataValue=i;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(o.ODataParserBase);t.ODataRawParserImpl=c,t.ODataRaw=new c;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(o.ODataParserBase);t.TextFileParser=d;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(o.ODataParserBase);t.BlobFileParser=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(o.ODataParserBase);t.JSONFileParser=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){a.Util.isFunction(e.arrayBuffer)&&e.arrayBuffer().then(t),e.buffer().then(t)},t}(o.ODataParserBase);t.BufferFileParser=h},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(7),a=n(0),s=n(2),l=n(38),c=n(12),d=n(16),u=n(3),p=function(e){function t(t,n){return void 0===n&&(n="files"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByName=function(e){var t=new h(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,n,i){var r=this;return void 0===i&&(i=!0),new t(this,"add(overwrite="+i+",url='"+e+"')").postCore({body:n}).then(function(t){return{data:t,file:r.getByName(e)}})},t.prototype.addChunked=function(e,n,i,r,o){var a=this;return void 0===r&&(r=!0),void 0===o&&(o=10485760),this.clone(t,"add(overwrite="+r+",url='"+e+"')",!1).postCore().then(function(){return a.getByName(e)}).then(function(e){return e.setContentChunked(n,i,o)})},t.prototype.addTemplateFile=function(e,n){var i=this;return this.clone(t,"addTemplateFile(urloffile='"+e+"',templatefiletype="+n+")",!1).postCore().then(function(t){return{data:t,file:i.getByName(e)}})},t}(r.SharePointQueryableCollection);t.Files=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new r.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new f(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,n){if(void 0===e&&(e=""),void 0===n&&(n=m.Major),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"checkin(comment='"+e+"',checkintype="+n+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=y.Shared),new l.LimitedWebPartManager(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=b.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+n+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new s.MaxCommentLengthException;return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new o.TextFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new o.BlobFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new o.BufferFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new o.JSONFileParser,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return a.Util.extend(new c.Item(u.spGetEntityUrl(e)),e)})},t.prototype.setContentChunked=function(e,t,n){var i=this;void 0===n&&(n=10485760),void 0===t&&(t=function(){return null});var r=e.size,o=parseInt((e.size/n).toString(),10)+(e.size%n==0?1:0),s=a.Util.getGUID();t({uploadId:s,blockNumber:1,chunkSize:n,currentPointer:0,fileSize:r,stage:"starting",totalBlocks:o});for(var l=this.startUpload(s,e.slice(0,n)),c=2;c<o;c++)!function(a){l=l.then(function(l){return t({uploadId:s,blockNumber:a,chunkSize:n,currentPointer:l,fileSize:r,stage:"continue",totalBlocks:o}),i.continueUpload(s,l,e.slice(l,l+n))})}(c);return l.then(function(a){return t({uploadId:s,blockNumber:o,chunkSize:n,currentPointer:a,fileSize:r,stage:"finishing",totalBlocks:o}),i.finishUpload(s,a,e.slice(a))})},t.prototype.startUpload=function(e,n){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postAsCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,n,i){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postAsCore({body:i}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,n,i){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postAsCore({body:i}).then(function(e){return{data:e,file:new t(e.ServerRelativeUrl)}})},t}(d.SharePointQueryableShareableFile);t.File=h;var f=function(e){function t(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new g(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new t(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(t,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(t,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(t,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(t,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(t,"restoreByLabel(versionlabel='"+e+"')").postCore()},t}(r.SharePointQueryableCollection);t.Versions=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.openBinaryStream=function(){return this.clone(t,"openBinaryStream").postCore()},t}(r.SharePointQueryableInstance);t.Version=g;var m;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(m=t.CheckinType||(t.CheckinType={}));var y;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(y=t.WebPartsPersonalizationScope||(t.WebPartsPersonalizationScope={}));var b;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(b=t.MoveOperations||(t.MoveOperations={}));!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(t.TemplateFileType||(t.TemplateFileType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.keys=e,this.values=t}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?this.values[n]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){var t=this;if("getKeys"in e){var n=e;n.getKeys().map(function(e){t.add(e,n.get(e))})}else{var i=e;for(var r in i)i.hasOwnProperty(r)&&this.add(r,i[r])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();t.Dictionary=i},function(e,t,n){"use strict";function i(e,t){e.headers=e.headers||{};var n=o.Util.extend(e.headers,t.headers);e=o.Util.extend(e,t),e.headers=n}function r(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.mergeOptions=i,t.mergeHeaders=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(15),a=n(26),s=n(28),l=n(24),c=n(25),d=n(55),u=n(18),p=n(23),h=n(8),f=n(0),g=n(15),m=n(37),y=n(27),b=n(3),v=n(29),x=n(39),w=n(16),C=n(56),_=n(40),k=n(41),P=function(e){function t(t,n){return void 0===n&&(n="webs"),e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e,n,i,r,o,a){void 0===i&&(i=""),void 0===r&&(r="STS"),void 0===o&&(o=1033),void 0===a&&(a=!0);var s={Description:i,Language:o,Title:e,Url:n,UseSamePermissionsAsParentSite:a,WebTemplate:r},l=JSON.stringify({parameters:f.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},s)});return this.clone(t,"add").postCore({body:l}).then(function(e){return{data:e,web:new T(b.spExtractODataId(e).replace(/_api\/web\/?/i,""))}})},t}(r.SharePointQueryableCollection);t.Webs=P;var F=function(e){function t(t,n){return void 0===n&&(n="webinfos"),e.call(this,t,n)||this}return i(t,e),t}(r.SharePointQueryableCollection);t.WebInfos=F;var T=function(e){function t(t,n){return void 0===n&&(n="_api/web"),e.call(this,t,n)||this}return i(t,e),t.fromUrl=function(e,n){return new t(f.extractWebUrl(e),n)},Object.defineProperty(t.prototype,"webs",{get:function(){return new P(this)},enumerable:!0,configurable:!0}),t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(P,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(r.SharePointQueryableCollection,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new c.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new o.Lists(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new a.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new x.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new a.Fields(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new s.Navigation(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new m.SiteUsers(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new l.SiteGroups(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new g.List(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new d.RegionalSettings(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new m.CurrentUser(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new u.Folders(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new y.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new r.SharePointQueryable(this,"effectivebasepermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new p.RoleDefinitions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return C.RelatedItemManagerImpl.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new v.ODataBatch(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new u.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new l.SiteGroup(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new l.SiteGroup(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new l.SiteGroup(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new u.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new u.Folder(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new h.File(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new h.File(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new g.List(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,n=JSON.stringify(f.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,n,i,r){var o=JSON.stringify({backgroundImageUrl:i,colorPaletteUrl:e,fontSchemeUrl:n,shareGenerated:r});return this.clone(t,"applytheme").postCore({body:o})},t.prototype.applyWebTemplate=function(e){var n=this.clone(t,"applywebtemplate");return n.concat("(@t)"),n.query.add("@t",e),n.postCore()},t.prototype.ensureUser=function(e){var n=JSON.stringify({logonName:e});return this.clone(t,"ensureuser").postCore({body:n}).then(function(e){return{data:e,user:new m.SiteUser(b.spExtractODataId(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new r.SharePointQueryableCollection(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(t,"getcatalog("+e+")").select("Id").get().then(function(e){return new g.List(b.spExtractODataId(e))})},t.prototype.getChanges=function(e){var n=JSON.stringify({query:f.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(t,"getchanges").postCore({body:n})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new r.SharePointQueryableCollection(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new m.SiteUser(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,n,i){return void 0===n&&(n=0),void 0===i&&(i=""),this.clone(t,"maptoicon(filename='"+e+"', progid='"+i+"', size="+n+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(t,"getStorageEntity('"+e+"')").get()},t.prototype.getAppCatalog=function(e){return new _.AppCatalog(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(r.SharePointQueryableCollection,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t,n){return void 0===t&&(t=e.replace(/\.[^\/.]+$/,"")),void 0===n&&(n="Site Pages"),k.ClientSidePage.create(this.lists.getByTitle(n),e,t)},t.prototype.addClientSidePageByPath=function(e,t,n){return void 0===n&&(n=e.replace(/\.[^\/.]+$/,"")),k.ClientSidePage.create(this.getList(t),e,n)},t}(w.SharePointQueryableShareableWeb);t.Web=T},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(16),a=n(18),s=n(8),l=n(25),c=n(0),d=n(14),u=n(51),p=n(15),h=n(19),f=function(e){function t(t,n){return void 0===n&&(n="items"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new g(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){var t=new g(this);return t.concat("/../getItemByStringId('"+e+"')"),t},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.getAs(new v)},t.prototype.getAll=function(e){var n=this;void 0===e&&(e=2e3),h.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",h.LogLevel.Warning);var i=new t(this,"").top(e).configure({headers:{Accept:"application/json;odata=nometadata"}});return this.query.getKeys().filter(function(e){return/^\$select$|^\$filter$|^\$top$|^\$expand$/.test(e.toLowerCase())}).reduce(function(e,t){return e.query.add(t,n.query.get(t)),e},i),new Promise(function(e,t){var n=[],r=function(i){[].push.apply(n,i.results),i.hasNext?i.getNext().then(r).catch(t):e(n)};i.getPaged().then(r).catch(t)})},t.prototype.add=function(e,n){var i=this;void 0===e&&(e={}),void 0===n&&(n=null);var r=this.addBatchDependency();return this.ensureListItemEntityTypeName(n).then(function(n){var o=JSON.stringify(c.Util.extend({__metadata:{type:n}},e)),a=i.clone(t,null).postAsCore({body:o}).then(function(e){return{data:e,item:i.getById(e.Id)}});return r(),a})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(p.List).getListItemEntityTypeFullName()},t}(r.SharePointQueryableCollection);t.Items=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new u.AttachmentFiles(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new l.ContentType(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new r.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new r.SharePointQueryable(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new r.SharePointQueryableInstance(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new r.SharePointQueryableInstance(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new r.SharePointQueryableInstance(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new a.Folder(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new s.File(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new y(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,n){var i=this;return void 0===t&&(t="*"),void 0===n&&(n=null),new Promise(function(r,o){var a=i.addBatchDependency();return i.ensureListItemEntityTypeName(n).then(function(n){var o=JSON.stringify(c.Util.extend({__metadata:{type:n}},e));return a(),i.postCore({body:o,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new x).then(function(e){r({data:e,item:i})})}).catch(function(e){return o(e)})})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var n=this.clone(t,"getWOPIFrameUrl(@action)");return n._query.add("@action",e),n.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,n){return void 0===n&&(n=!1),this.clone(t,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:n})})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(p.List,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},t}(o.SharePointQueryableShareableItem);t.Item=g;var m=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){if(this.hasNext){return new f(this.nextUrl,null).getPaged()}return new Promise(function(e){return e(null)})},e}();t.PagedItemCollection=m;var y=function(e){function t(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new b(this);return t.concat("("+e+")"),t},t}(r.SharePointQueryableCollection);t.ItemVersions=y;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(r.SharePointQueryableInstance);t.ItemVersion=b;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,i){t.handleError(e,i)&&e.json().then(function(e){var i=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];n(new m(i,t.parseODataJSON(e)))})})},t}(d.ODataParserBase),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,i){t.handleError(e,i)&&n({"odata.etag":e.headers.get("etag")})})},t}(d.ODataParserBase)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(9),o=n(4),a=n(5),s=function(){function e(e,t){this.store=e,this.defaultTimeoutMinutes=t,this.defaultTimeoutMinutes=void 0===t?-1:t,this.enabled=this.test(),o.RuntimeConfig.enableCacheExpiration&&(a.Logger.write("Enabling cache expiration.",a.LogLevel.Info),this.cacheExpirationHandler())}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(a.Logger.write("Removing item with key '"+e+"' from cache due to expiration.",a.LogLevel.Info),this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var i=this;return this.enabled?new Promise(function(r){var o=i.get(e);null==o?t().then(function(t){i.put(e,t,n),r(t)}):r(o)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var i=0;i<e.store.length;i++){var r=e.store.key(i);/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(r))&&e.get(r)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=o.RuntimeConfig.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=i.Util.dateAdd(new Date,"second",n)}return JSON.stringify({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;a.Logger.write("Called cache expiration handler.",a.LogLevel.Verbose),this.deleteExpired().then(function(t){setTimeout(i.Util.getCtxCallback(e,e.cacheExpirationHandler),o.RuntimeConfig.cacheExpirationIntervalMilliseconds)}).catch(function(e){a.Logger.log({data:e,level:a.LogLevel.Error,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},e}();t.PnPClientStorageWrapper=s;var l=function(){function e(e){void 0===e&&(e=new r.Dictionary),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.count()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return this._store.getKeys()[e]},e.prototype.removeItem=function(e){this._store.remove(e)},e.prototype.setItem=function(e,t){this._store.add(e,t)},e}(),c=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=new s("undefined"!=typeof localStorage?localStorage:new l)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=new s("undefined"!=typeof sessionStorage?sessionStorage:new l)),this._session},enumerable:!0,configurable:!0}),e}();t.PnPClientStorage=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=n(5),o=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,i){t.handleError(e,i)&&t.parseImpl(e,n,i)})},e.prototype.parseImpl=function(e,t,n){var i=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(i.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||e.json().then(function(n){var r={responseBody:n,responseHeaders:e.headers};t(new i.ProcessHttpClientResponseException(e.status,e.statusText,r))}).catch(function(n){r.Logger.log({data:n,level:r.LogLevel.Warning,message:"There was an error parsing the error response body. See data for details."});var o={responseBody:"[[body not available]]",responseHeaders:e.headers};t(new i.ProcessHttpClientResponseException(e.status,e.statusText,o))}),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}();t.ODataParserBase=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(52),a=n(25),s=n(26),l=n(53),c=n(54),d=n(1),u=n(36),p=n(0),h=n(27),f=n(3),g=n(2),m=n(18),y=function(e){function t(t,n){return void 0===n&&(n="lists"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByTitle=function(e){return new b(this,"getByTitle('"+e+"')")},t.prototype.getById=function(e){var t=new b(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n,i,r){var o=this;void 0===t&&(t=""),void 0===n&&(n=100),void 0===i&&(i=!1),void 0===r&&(r={});var a=p.Util.extend({AllowContentTypes:i,BaseTemplate:n,ContentTypesEnabled:i,Description:t,Title:e,__metadata:{type:"SP.List"}},r);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:o.getByTitle(a.Title)}})},t.prototype.ensure=function(e,t,n,i,r){var o=this;if(void 0===t&&(t=""),void 0===n&&(n=100),void 0===i&&(i=!1),void 0===r&&(r={}),this.hasBatch)throw new g.NotSupportedInBatchException("The ensure list method");return new Promise(function(a,s){var l=p.Util.extend(r,{Title:e,Description:t,ContentTypesEnabled:i},!0),c=o.getByTitle(l.Title);c.get().then(function(e){c.update(l).then(function(e){a({created:!1,data:e,list:o.getByTitle(l.Title)})}).catch(function(e){return s(e)})}).catch(function(r){o.add(e,t,n,i,l).then(function(e){a({created:!0,data:e.data,list:o.getByTitle(l.Title)})}).catch(function(e){return s(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(t,"ensuresiteassetslibrary").postCore().then(function(e){return new b(f.spExtractODataId(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(t,"ensuresitepageslibrary").postCore().then(function(e){return new b(f.spExtractODataId(e))})},t}(d.SharePointQueryableCollection);t.Lists=y;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new a.ContentTypes(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new r.Items(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new o.Views(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new s.Fields(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new l.Forms(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new o.View(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new h.UserCustomActions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new d.SharePointQueryable(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new d.SharePointQueryableCollection(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new d.SharePointQueryable(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new d.SharePointQueryable(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new c.Subscriptions(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new m.Folder(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new o.View(this,"getView('"+e+"')")},t.prototype.update=function(e,n){var i=this;void 0===n&&(n="*");var r=JSON.stringify(p.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:r,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}}).then(function(n){var r=i;return e.hasOwnProperty("Title")&&(r=i.getParent(t,i.parentUrl,"getByTitle('"+e.Title+"')")),{data:n,list:r}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:JSON.stringify({query:p.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this.clone(t,"getitems");return r.expand.apply(r,n).postCore({body:JSON.stringify({query:p.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:p.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var n=this.clone(t,"renderlistdata(@viewXml)");return n.query.add("@viewXml","'"+e+"'"),n.postCore().then(function(e){return e.hasOwnProperty("RenderListData")?JSON.parse(e.RenderListData):JSON.parse(e)})},t.prototype.renderListDataAsStream=function(e,n){void 0===n&&(n=null);var i={overrideParameters:p.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},n),parameters:p.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(i)})},t.prototype.renderListFormData=function(e,n,i){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+n+"', mode='"+i+"')").postCore().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("ListData")?e.ListData:e})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").getAs().then(function(e){return e.ListItemEntityTypeFullName})},t}(u.SharePointQueryableSecurable);t.List=b},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(11),a=n(3),s=n(1),l=n(36),c=n(17),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getShareLink=function(e,n){void 0===n&&(n=null);var i=null!==n?n.toISOString():null;return this.clone(t,"shareLink").postAsCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:i,linkKind:e}}})})},t.prototype.shareWith=function(e,n,i,a,s){var l=this;void 0===i&&(i=!1),void 0===a&&(a=!1),Array.isArray(e)||(e=[e]);var d=JSON.stringify(e.map(function(e){return{Key:e}})),u=n===c.SharingRole.Edit?c.RoleType.Contributor:c.RoleType.Reader;return o.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").filter("RoleTypeKind eq "+u).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+u);var n={includeAnonymousLinkInEmail:i,peoplePickerInput:d,propagateAcl:a,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==s&&(n=r.Util.extend(n,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),l.clone(t,"shareObject").postAsCore({body:JSON.stringify(n)})})},t.prototype.shareObject=function(e,t){var n=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=r.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var i=JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),o={peoplePickerInput:i,roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=r.Util.extend(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),n.sendShareObjectRequest(o)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postAsCore({body:JSON.stringify({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postAsCore({body:JSON.stringify({recipients:e})})},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(t,"getSharingInformation").postAsCore({body:JSON.stringify({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postAsCore({body:JSON.stringify({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postAsCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},t.prototype.unshareLink=function(e,n){return void 0===n&&(n="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:n})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var n=e===c.SharingRole.Edit?c.RoleType.Contributor:c.RoleType.Reader;return o.Web.fromUrl(this.toUrl()).roleDefinitions.select("Id").top(1).filter("RoleTypeKind eq "+n).getAs().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case c.RoleType.Contributor:return o.Web.fromUrl(this.toUrl()).associatedMemberGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});case c.RoleType.Reader:case c.RoleType.Guest:return o.Web.fromUrl(this.toUrl()).associatedVisitorGroup.select("Id").getAs().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(o.Web.fromUrl(e,"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(n){return n.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:JSON.stringify(e)})})},t}(s.SharePointQueryable);t.SharePointQueryableShareable=d;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.shareWith=function(e,t,n){var i=this;void 0===t&&(t=c.SharingRole.View);var a=this.addBatchDependency();return o.Web.fromUrl(this.toUrl(),"/_api/web/url").get().then(function(o){return a(),i.shareObject(r.Util.combinePaths(o,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,n)})},t.prototype.shareObject=function(e,t,n,i,r,o,a,s){return void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),this.clone(d,null).shareObject({emailData:i,group:r,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:o,role:n,url:e,useSimplifiedRoles:s})},t.prototype.shareObjectRaw=function(e){return this.clone(d,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(d,null).unshareObjectWeb(e)},t}(l.SharePointQueryableSecurable);t.SharePointQueryableShareableWeb=u;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=c.SharingLinkKind.OrganizationView),void 0===t&&(t=null),this.clone(d,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,n,i){return void 0===t&&(t=c.SharingRole.View),void 0===n&&(n=!1),this.clone(d,null).shareWith(e,t,n,!1,i)},t.prototype.checkSharingPermissions=function(e){return this.clone(d,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(d,null).getSharingInformation(e)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(d,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(d,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(d,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(d,null).unshareLink(e,t)},t}(l.SharePointQueryableSecurable);t.SharePointQueryableShareableItem=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=c.SharingLinkKind.OrganizationView),void 0===t&&(t=null);var n=this.addBatchDependency();return this.getShareable().then(function(i){return n(),i.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},t.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getSharingInformation(e)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(i){return n(),i.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(f,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var n=new d(a.spGetEntityUrl(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},t}(s.SharePointQueryableInstance);t.FileFolderShared=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.shareWith=function(e,t,n,i){void 0===t&&(t=c.SharingRole.View),void 0===n&&(n=!1);var r=this.addBatchDependency();return this.getShareable().then(function(o){return r(),o.shareWith(e,t,n,!1,i)})},t}(h);t.SharePointQueryableShareableFile=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.shareWith=function(e,t,n,i,r){void 0===t&&(t=c.SharingRole.View),void 0===n&&(n=!1),void 0===i&&(i=!1);var o=this.addBatchDependency();return this.getShareable().then(function(a){return o(),a.shareWith(e,t,n,i,r)})},t}(h);t.SharePointQueryableShareableFolder=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(t.ControlMode||(t.ControlMode={}));!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(t.FieldTypes||(t.FieldTypes={}));!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(t.DateTimeFieldFormatType||(t.DateTimeFieldFormatType={}));!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(t.AddFieldOptions||(t.AddFieldOptions={}));!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(t.CalendarType||(t.CalendarType={}));!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(t.UrlFieldFormatType||(t.UrlFieldFormatType={}));!function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(t.ChoiceFieldFormatType||(t.ChoiceFieldFormatType={}));!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(t.PermissionKind||(t.PermissionKind={}));!function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(t.RoleType||(t.RoleType={}));!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(t.PageType||(t.PageType={}));!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(t.SharingLinkKind||(t.SharingLinkKind={}));!function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(t.SharingRole||(t.SharingRole={}));!function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(t.SharingOperationStatusCode||(t.SharingOperationStatusCode={}));!function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(t.SPSharedObjectType||(t.SPSharedObjectType={}));!function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(t.SharingDomainRestrictionMode||(t.SharingDomainRestrictionMode={}));!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(t.RenderListDataOptions||(t.RenderListDataOptions={}));!function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(t.FieldUserSelectionMode||(t.FieldUserSelectionMode={}))},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(16),a=n(8),s=n(0),l=n(3),c=n(12),d=function(e){function t(t,n){return void 0===n&&(n="folders"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByName=function(e){var t=new u(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var n=this;return this.clone(t,"add('"+e+"')").postCore().then(function(t){return{data:t,folder:n.getByName(e)}})},t}(r.SharePointQueryableCollection);t.Folders=d;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new r.SharePointQueryableCollection(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new a.Files(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new d(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new r.SharePointQueryableCollection(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new r.SharePointQueryableInstance(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new r.SharePointQueryable(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new r.SharePointQueryableCollection(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,n=JSON.stringify(s.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return s.Util.extend(new c.Item(l.spGetEntityUrl(e)),e)})},t}(o.SharePointQueryableShareableFolder);t.Folder=u},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(13),a=n(48),s=n(5),l=n(49),c=n(4),d=n(59);t.util=r.Util,t.sp=new l.SPRest,t.graph=new d.GraphRest,t.storage=new o.PnPClientStorage,t.config=new a.Settings,t.log=s.Logger,t.setup=c.setRuntimeConfig,i(n(68)),i(n(71)),i(n(73)),i(n(76)),i(n(77));var u={config:t.config,graph:t.graph,log:t.log,setup:t.setup,sp:t.sp,storage:t.storage,util:t.util};t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(10),o=n(7),a=n(4),s=n(21),l=function(){function e(){}return e.prototype.concat=function(e){return this._url+=e,this},e.prototype.append=function(e){this._url=i.Util.combinePaths(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return r.mergeOptions(this._options,e),this},e.prototype.usingCaching=function(e){return a.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,this._cachingOptions=e),this},e.prototype.toUrl=function(){return this._url},e.prototype.get=function(e,t){return void 0===e&&(e=new o.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.getAs=function(e,t){return void 0===e&&(e=new o.ODataDefaultParser),void 0===t&&(t={}),this.toRequestContext("GET",t,e,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new o.ODataDefaultParser),this.toRequestContext("POST",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.postAsCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new o.ODataDefaultParser),this.toRequestContext("POST",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new o.ODataDefaultParser),this.toRequestContext("PATCH",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new o.ODataDefaultParser),this.toRequestContext("DELETE",e,t,s.PipelineMethods.default).then(function(e){return s.pipe(e)})},e}();t.ODataQueryable=l},function(e,t,n){"use strict";function i(e){return d.Logger.log({data:e.result,level:d.LogLevel.Verbose,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(e.result)}function r(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function o(e){return e.pipeline.length<1?Promise.resolve(e):e.pipeline.shift()(e)}function a(e){return o(e).then(function(e){return i(e)}).catch(function(e){throw d.Logger.log({data:e,level:d.LogLevel.Error,message:"Error in request pipeline: "+e.message}),e})}function s(e){return void 0===e&&(e=!1),function(t,n,i){var r=i.value;i.value=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return!e&&i.length>0&&i[0].hasOwnProperty("hasResult")&&i[0].hasResult?(d.Logger.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",d.LogLevel.Verbose),Promise.resolve(i[0])):(d.Logger.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",d.LogLevel.Verbose),r.apply(t,i).then(function(e){return o(e)}))}}}var l=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var c=n(33),d=n(5),u=n(0);t.setResult=r,t.pipe=a,t.requestPipelineMethod=s;var p=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){d.Logger.log({data:d.Logger.activeLogLevel===d.LogLevel.Info?{}:e,level:d.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if("GET"===e.verb&&e.isCached){d.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",d.LogLevel.Info);var n=new c.CachingOptions(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=u.Util.extend(n,e.cachingOptions)),null!==n.store){var i=n.store.get(n.key);if(null!==i)return d.Logger.log({data:d.Logger.activeLogLevel===d.LogLevel.Info?{}:i,level:d.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),e.batchDependency(),e.parser.hasOwnProperty("hydrate")&&(i=e.parser.hydrate(i)),r(e,i).then(function(e){return t(e)})}d.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",d.LogLevel.Info),e.parser=new c.CachingParserWrapper(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var i=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser);e.batchDependency(),d.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",d.LogLevel.Info),t(r(e,i))}else{d.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",d.LogLevel.Info);var o=e.clientFactory(),a=u.Util.extend(e.options||{},{method:e.verb});o.fetch(e.requestAbsoluteUrl,a).then(function(t){return e.parser.parse(t)}).then(function(t){return r(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?d.Logger.log({data:d.Logger.activeLogLevel===d.LogLevel.Info?{}:e,level:d.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):d.Logger.log({data:d.Logger.activeLogLevel===d.LogLevel.Info?{}:e,level:d.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},Object.defineProperty(e,"default",{get:function(){return[e.logStart,e.caching,e.send,e.logEnd]},enumerable:!0,configurable:!0}),l([s(!0)],e,"logStart",null),l([s()],e,"caching",null),l([s()],e,"send",null),l([s(!0)],e,"logEnd",null),e}();t.PipelineMethods=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(50),r=n(0),o=n(4),a=n(2),s=n(10),l=function(){function e(){this._impl=o.RuntimeConfig.spFetchClientFactory(),this._digestCache=new i.DigestCache(this)}return e.prototype.fetch=function(e,t){var n=this;void 0===t&&(t={});var i=r.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),l=new Headers;if(s.mergeHeaders(l,o.RuntimeConfig.spHeaders),s.mergeHeaders(l,t.headers),l.has("Accept")||l.append("Accept","application/json"),l.has("Content-Type")||l.append("Content-Type","application/json;odata=verbose;charset=utf-8"),l.has("X-ClientService-ClientTag")||l.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),l.has("User-Agent")||l.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/3.0.10"),i=r.Util.extend(i,{headers:l}),i.method&&"GET"!==i.method.toUpperCase()&&!l.has("X-RequestDigest")&&!l.has("Authorization")){var c=e.indexOf("_api/");if(c<0)throw new a.APIUrlException;var d=e.substr(0,c);return this._digestCache.getDigest(d).then(function(t){return l.append("X-RequestDigest",t),n.fetchRaw(e,i)})}return this.fetchRaw(e,i)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var i=new Headers;s.mergeHeaders(i,t.headers),t=r.Util.extend(t,{headers:i});var o=function(i){n._impl.fetch(e,t).then(function(e){return i.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&i.reject(e);var t=i.delay;i.delay*=2,i.attempts++,i.retryCount<=i.attempts&&i.reject(e),setTimeout(r.Util.getCtxCallback(n,o,i),t)})};return new Promise(function(e,t){var i={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,i)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"DELETE"});return this.fetch(e,n)},e}();t.HttpClient=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(24),a=n(0),s=function(e){function t(t,n){return void 0===n&&(n="roleassignments"),e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e,n){return this.clone(t,"addroleassignment(principalid="+e+", roledefid="+n+")").postCore()},t.prototype.remove=function(e,n){return this.clone(t,"removeroleassignment(principalid="+e+", roledefid="+n+")").postCore()},t.prototype.getById=function(e){var t=new l(this);return t.concat("("+e+")"),t},t}(r.SharePointQueryableCollection);t.RoleAssignments=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new o.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new u(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(r.SharePointQueryableInstance);t.RoleAssignment=l;var c=function(e){function t(t,n){return void 0===n&&(n="roledefinitions"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new d(this,"getById("+e+")")},t.prototype.getByName=function(e){return new d(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new d(this,"getbytype("+e+")")},t.prototype.add=function(e,t,n,i){var r=this,o=JSON.stringify({BasePermissions:a.Util.extend({__metadata:{type:"SP.BasePermissions"}},i),Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:o}).then(function(e){return{data:e,definition:r.getById(e.Id)}})},t}(r.SharePointQueryableCollection);t.RoleDefinitions=c;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=a.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var n=JSON.stringify(a.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var i=t;if(e.hasOwnProperty("Name")){i=t.getParent(c,t.parentUrl,"").getByName(e.Name)}return{data:n,definition:i}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(r.SharePointQueryableInstance);t.RoleDefinition=d;var u=function(e){function t(t,n){return void 0===n&&(n="roledefinitionbindings"),e.call(this,t,n)||this}return i(t,e),t}(r.SharePointQueryableCollection);t.RoleDefinitionBindings=u},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(37),a=n(0);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(t.PrincipalType||(t.PrincipalType={}));var s=function(e){function t(t,n){return void 0===n&&(n="sitegroups"),e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e){var t=this,n=JSON.stringify(a.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new l(this,"getByName('"+e+"')")},t.prototype.getById=function(e){var t=new l(this);return t.concat("("+e+")"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(t,"removeByLoginName('"+e+"')").postCore()},t}(r.SharePointQueryableCollection);t.SiteGroups=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new o.SiteUsers(this,"users")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var n=this,i=a.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(i),headers:{"X-HTTP-Method":"MERGE"}}).then(function(i){var r=n;return e.hasOwnProperty("Title")&&(r=n.getParent(t,n.parentUrl,"getByName('"+e.Title+"')")),{data:i,group:r}})},t}(r.SharePointQueryableInstance);t.SiteGroup=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),a=function(e){function t(t,n){return void 0===n&&(n="contenttypes"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.addAvailableContentType=function(e){var n=this,i=JSON.stringify({contentTypeId:e});return this.clone(t,"addAvailableContentType").postAsCore({body:i}).then(function(e){return{contentType:n.getById(e.id),data:e}})},t.prototype.add=function(e,t,n,i,o){var a=this;void 0===n&&(n=""),void 0===i&&(i="Custom Content Types"),void 0===o&&(o={});var s=JSON.stringify(r.Util.extend({Description:n,Group:i,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},o));return this.postCore({body:s}).then(function(e){return{contentType:a.getById(e.id),data:e}})},t}(o.SharePointQueryableCollection);t.ContentTypes=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new o.SharePointQueryableCollection(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new o.SharePointQueryableCollection(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(o.SharePointQueryableInstance);t.ContentType=s;var l=function(e){function t(t,n){return void 0===n&&(n="fieldlinks"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new c(this);return t.concat("(guid'"+e+"')"),t},t}(o.SharePointQueryableCollection);t.FieldLinks=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(o.SharePointQueryableInstance);t.FieldLink=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=n(17),s=function(e){function t(t,n){return void 0===n&&(n="fields"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByTitle=function(e){return new l(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new l(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.getById=function(e){var t=new l(this);return t.concat("('"+e+"')"),t},t.prototype.createFieldAsXml=function(e){var n,i=this;n="string"==typeof e?{SchemaXml:e}:e;var r=JSON.stringify({parameters:o.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},n)});return this.clone(t,"createfieldasxml").postAsCore({body:r}).then(function(e){return{data:e,field:i.getById(e.Id)}})},t.prototype.add=function(e,n,i){var r=this,a=JSON.stringify(o.Util.extend({Title:e,__metadata:{type:n}},i));return this.clone(t,null).postAsCore({body:a}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.addText=function(e,t,n){void 0===t&&(t=255);var i={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",o.Util.extend(i,n))},t.prototype.addCalculated=function(e,t,n,i,r){void 0===i&&(i=a.FieldTypes.Text);var s={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:i};return this.add(e,"SP.FieldCalculated",o.Util.extend(s,r))},t.prototype.addDateTime=function(e,t,n,i,r){void 0===t&&(t=a.DateTimeFieldFormatType.DateOnly),void 0===n&&(n=a.CalendarType.Gregorian),void 0===i&&(i=0);var s={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(e,"SP.FieldDateTime",o.Util.extend(s,r))},t.prototype.addNumber=function(e,t,n,i){var r={FieldTypeKind:9};return void 0!==t&&(r=o.Util.extend({MinimumValue:t},r)),void 0!==n&&(r=o.Util.extend({MaximumValue:n},r)),this.add(e,"SP.FieldNumber",o.Util.extend(r,i))},t.prototype.addCurrency=function(e,t,n,i,r){void 0===i&&(i=1033);var a={CurrencyLocaleId:i,FieldTypeKind:10};return void 0!==t&&(a=o.Util.extend({MinimumValue:t},a)),void 0!==n&&(a=o.Util.extend({MaximumValue:n},a)),this.add(e,"SP.FieldCurrency",o.Util.extend(a,r))},t.prototype.addMultilineText=function(e,t,n,i,r,a,s){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===a&&(a=!0);var l={AllowHyperlink:a,AppendOnly:r,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:i,RichText:n};return this.add(e,"SP.FieldMultiLineText",o.Util.extend(l,s))},t.prototype.addUrl=function(e,t,n){void 0===t&&(t=a.UrlFieldFormatType.Hyperlink);var i={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",o.Util.extend(i,n))},t.prototype.addUser=function(e,t,n){var i={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",o.Util.extend(i,n))},t.prototype.addLookup=function(e,n,i,r){var a=this,s=JSON.stringify({parameters:o.Util.extend({FieldTypeKind:7,LookupFieldName:i,LookupListId:n,Title:e,__metadata:{type:"SP.FieldCreationInformation"}},r)});return this.clone(t,"addfield").postAsCore({body:s}).then(function(e){return{data:e,field:a.getById(e.Id)}})},t.prototype.addChoice=function(e,t,n,i,r){void 0===n&&(n=a.ChoiceFieldFormatType.Dropdown);var s={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:i};return this.add(e,"SP.FieldChoice",o.Util.extend(s,r))},t.prototype.addMultiChoice=function(e,t,n,i){var r={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",o.Util.extend(r,i))},t.prototype.addBoolean=function(e,t){var n={FieldTypeKind:8};return this.add(e,"SP.Field",o.Util.extend(n,t))},t}(r.SharePointQueryableCollection);t.Fields=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e,t){var n=this;void 0===t&&(t="SP.Field");var i=JSON.stringify(o.Util.extend({__metadata:{type:t}},e));return this.postCore({body:i,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(r.SharePointQueryableInstance);t.Field=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=function(e){function t(t,n){return void 0===n&&(n="usercustomactions"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,n=JSON.stringify(o.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(t,"clear").postCore()},t}(r.SharePointQueryableCollection);t.UserCustomActions=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e){var t=this,n=JSON.stringify(o.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(r.SharePointQueryableInstance);t.UserCustomAction=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,n,i){var r=this;void 0===i&&(i=!0);var o=JSON.stringify({IsVisible:i,Title:e,Url:n,__metadata:{type:"SP.NavigationNode"}});return this.clone(t,null).postCore({body:o}).then(function(e){return{data:e,node:r.getById(e.Id)}})},t.prototype.moveAfter=function(e,n){var i=JSON.stringify({nodeId:e,previousNodeId:n});return this.clone(t,"MoveAfter").postCore({body:i})},t}(r.SharePointQueryableCollection);t.NavigationNodes=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new o(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(r.SharePointQueryableInstance);t.NavigationNode=a;var s=function(e){function t(t,n){return void 0===n&&(n="navigation"),e.call(this,t,n)||this}return i(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new o(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new o(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t}(r.SharePointQueryable);t.Navigation=s;var l=function(e){function t(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return i(t,e),t.prototype.getMenuState=function(e,n,i,r){return void 0===e&&(e=null),void 0===n&&(n=10),void 0===i&&(i=null),void 0===r&&(r=null),new t("MenuState").postCore({body:JSON.stringify({customProperties:r,depth:n,mapProviderName:i,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,n){return void 0===n&&(n=null),new t("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:n})})},t}(r.SharePointQueryable);t.NavigationService=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(5),o=n(22),a=n(10),s=n(4),l=n(2),c=function(){function e(e,t){void 0===t&&(t=i.Util.getGUID()),this.baseUrl=e,this._batchId=t,this._requests=[],this._dependencies=[]}return e.ParseResponse=function(e){return new Promise(function(t,n){for(var i,r,o=[],a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=e.split("\n"),c="batch",d=0;d<s.length;++d){var u=s[d];switch(c){case"batch":if("--batchresponse_"===u.substr(0,"--batchresponse_".length))c="batchHeaders";else if(""!==u.trim())throw new l.BatchParseException("Invalid response, line "+d);break;case"batchHeaders":""===u.trim()&&(c="status");break;case"status":var p=a.exec(u);if(3!==p.length)throw new l.BatchParseException("Invalid status, line "+d);i=parseInt(p[1],10),r=p[2],c="statusHeaders";break;case"statusHeaders":""===u.trim()&&(c="body");break;case"body":o.push(204===i?new Response:new Response(u,{status:i,statusText:r})),c="batch"}}"status"!==c&&n(new l.BatchParseException("Unexpected end of input")),t(o)})},Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,i){var r={method:t.toUpperCase(),options:n,parser:i,reject:null,resolve:null,url:e},o=new Promise(function(e,t){r.resolve=e,r.reject=t});return this._requests.push(r),o},e.prototype.addDependency=function(){var e,t=new Promise(function(t){e=t});return this._dependencies.push(t),e},e.prototype.execute=function(){var e=this;return Promise.all(this._dependencies).then(function(){return Promise.all(e._dependencies)}).then(function(){return e.executeImpl()})},e.prototype.executeImpl=function(){var t=this;if(r.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this._requests.length+" requests.",r.LogLevel.Info),this._requests.length<1)return r.Logger.write("Resolving empty batch.",r.LogLevel.Info),Promise.resolve();var n=new o.HttpClient;return i.Util.toAbsoluteUrl(this.baseUrl).then(function(o){for(var c=[],d="",u=0;u<t._requests.length;u++){var p=t._requests[u];"GET"===p.method?(d.length>0&&(c.push("--changeset_"+d+"--\n\n"),d=""),c.push("--batch_"+t._batchId+"\n")):(d.length<1&&(d=i.Util.getGUID(),c.push("--batch_"+t._batchId+"\n"),c.push('Content-Type: multipart/mixed; boundary="changeset_'+d+'"\n\n')),c.push("--changeset_"+d+"\n")),c.push("Content-Type: application/http\n"),c.push("Content-Transfer-Encoding: binary\n\n");var h=new Headers,f=i.Util.isUrlAbsolute(p.url)?p.url:i.Util.combinePaths(o,p.url);if(r.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Adding request "+p.method+" "+f+" to batch.",r.LogLevel.Verbose),"GET"!==p.method){var g=p.method;p.hasOwnProperty("options")&&p.options.hasOwnProperty("headers")&&void 0!==p.options.headers["X-HTTP-Method"]&&(g=p.options.headers["X-HTTP-Method"],delete p.options.headers["X-HTTP-Method"]),c.push(g+" "+f+" HTTP/1.1\n"),h.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else c.push(p.method+" "+f+" HTTP/1.1\n");a.mergeHeaders(h,s.RuntimeConfig.spHeaders),p.options&&a.mergeHeaders(h,p.options.headers),h.has("Accept")||h.append("Accept","application/json"),h.has("Content-Type")||h.append("Content-Type","application/json;odata=verbose;charset=utf-8"),h.has("X-ClientService-ClientTag")||h.append("X-ClientService-ClientTag","PnPCoreJS:3.0.10"),h.forEach(function(e,t){c.push(t+": "+e+"\n")}),c.push("\n"),p.options.body&&c.push(p.options.body+"\n\n")}d.length>0&&(c.push("--changeset_"+d+"--\n\n"),d=""),c.push("--batch_"+t._batchId+"--\n");var m={"Content-Type":"multipart/mixed; boundary=batch_"+t._batchId},y={body:c.join(""),headers:m,method:"POST"};return r.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Sending batch request.",r.LogLevel.Info),n.fetch(i.Util.combinePaths(o,"/_api/$batch"),y).then(function(e){return e.text()}).then(e.ParseResponse).then(function(e){if(e.length!==t._requests.length)throw new l.BatchParseException("Could not properly parse responses to match requests in batch.");return r.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",r.LogLevel.Info),e.reduce(function(e,n,i){var o=t._requests[i];return r.Logger.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+o.method+" "+o.url+".",r.LogLevel.Verbose),e.then(function(e){return o.parser.parse(n).then(o.resolve).catch(o.reject)})},Promise.resolve())})})},e}();t.ODataBatch=c},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.fetch=function(t,n){return e.fetch(t,n)},t}();t.FetchClient=n}).call(t,n(30))},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,n){return void 0===t&&(t=""),void 0===n&&(n={}),new e(t,n)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=o.Util.extend(this._query,e),this},e}();t.SearchQueryBuilder=a;var s=function(e){function t(t,n){return void 0===n&&(n="_api/search/postquery"),e.call(this,t,n)||this}return i(t,e),t.prototype.execute=function(e){var t,n=this;t=e,t.SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var i=JSON.stringify({request:o.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:i}).then(function(t){return new l(t,n.toUrl(),e)})},t.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},t}(r.SharePointQueryableInstance);t.Search=s;var l=function(){function e(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null),this._url=t,this._query=n,this._raw=i,this._primary=r,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,i=o.Util.extend(this._query,{RowLimit:n,StartRow:n*(e-1)});return i.StartRow>this.TotalRows?Promise.resolve(null):new s(this._url,null).execute(i)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=e.results?e.results:e,i=0,r=n;i<r.length;i++){var o=r[i],a=o.Cells.results?o.Cells.results:o.Cells;t.push(a.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();t.SearchResults=l;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(t.SortDirection||(t.SortDirection={}));!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(t.ReorderingRuleMatchType||(t.ReorderingRuleMatchType={}));!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(t.QueryPropertyValueType||(t.QueryPropertyValueType={}));var c=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}();t.SearchBuiltInSourceId=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),r=n(0),o=n(4),a=function(){function e(e){this.key=e,this.expiration=r.Util.dateAdd(new Date,"second",o.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=o.RuntimeConfig.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new i.PnPClientStorage,e}();t.CachingOptions=a;var s=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}();t.CachingParserWrapper=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t,n){return void 0===n&&(n="_api/search/suggest"),e.call(this,t,n)||this}return i(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new a(e)})},t.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},t}(r.SharePointQueryableInstance);t.SearchSuggest=o;var a=function(){function e(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}return e}();t.SearchSuggestResult=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(11),a=n(27),s=n(3),l=n(29),c=n(39),d=function(e){function t(t,n){return void 0===n&&(n="_api/site"),e.call(this,t,n)||this}return i(t,e),Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new o.Web(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new c.Features(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new a.UserCustomActions(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new o.Web(e.Url)})},t.prototype.getContextInfo=function(){return new t(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new r.SharePointQueryable("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new r.SharePointQueryable("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new l.ODataBatch(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(t,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:o.Web.fromUrl(s.spExtractODataId(e))}})},t}(r.SharePointQueryableInstance);t.Site=d},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(23),a=n(17),s=n(1),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new o.RoleAssignments(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new s.SharePointQueryableInstance(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(s.SharePointQueryable,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return r.Web.fromUrl(this.toUrl()).currentUser.select("LoginName").getAs().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+n+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;var n=parseFloat(e.Low),i=parseFloat(e.High);if(t===a.PermissionKind.FullMask)return 32767==(32767&i)&&65535===n;t-=1;var r=1;return t>=0&&t<32?(r<<=t,0!=(n&r)):t>=32&&t<64&&(r<<=t-32,0!=(i&r))},t}(s.SharePointQueryableInstance);t.SharePointQueryableSecurable=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(24),a=n(0),s=function(e){function t(t,n){return void 0===n&&(n="siteusers"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByEmail=function(e){return new l(this,"getByEmail('"+e+"')")},t.prototype.getById=function(e){return new l(this,"getById("+e+")")},t.prototype.getByLoginName=function(e){var t=new l(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(t,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var n=this.clone(t,"removeByLoginName(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.postCore()},t.prototype.add=function(e){var n=this;return this.clone(t,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return n.getByLoginName(e)})},t}(r.SharePointQueryableCollection);t.SiteUsers=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new o.SiteGroups(this,"groups")},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,n=a.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t}(r.SharePointQueryableInstance);t.SiteUser=l;var c=function(e){function t(t,n){return void 0===n&&(n="currentuser"),e.call(this,t,n)||this}return i(t,e),t}(r.SharePointQueryableInstance);t.CurrentUser=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new a(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},t}(r.SharePointQueryable);t.LimitedWebPartManager=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getById=function(e){return new s(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new s(this,"getByControlId('"+e+"')")},t}(r.SharePointQueryableCollection);t.WebPartDefinitions=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,n){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+n+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(r.SharePointQueryableInstance);t.WebPartDefinition=s;var l=function(e){function t(t,n){return void 0===n&&(n="webpart"),e.call(this,t,n)||this}return i(t,e),t}(r.SharePointQueryableInstance);t.WebPart=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t,n){return void 0===n&&(n="features"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,n){var i=this;return void 0===n&&(n=!1),this.clone(t,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:n})}).then(function(t){return{data:t,feature:i.getById(e)}})},t.prototype.remove=function(e,n){return void 0===n&&(n=!1),this.clone(t,"remove").postCore({body:JSON.stringify({featureId:e,force:n})})},t}(r.SharePointQueryableCollection);t.Features=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.deactivate=function(e){var n=this;void 0===e&&(e=!1);var i=this.addBatchDependency();return new t(this).select("DefinitionId").getAs().then(function(t){var r=n.getParent(o,n.parentUrl,"",n.batch).remove(t.DefinitionId,e);return i(),r})},t}(r.SharePointQueryableInstance);t.Feature=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(8),a=n(3),s=n(0),l=function(e){function t(t,n){void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps");var i="";return"string"==typeof t?i=t:void 0!==t&&(i=t.toUrl()),e.call(this,s.extractWebUrl(i),n)||this}return i(t,e),t.prototype.getAppById=function(e){return new c(this,"getById('"+e+"')")},t.prototype.add=function(e,n,i){return void 0===i&&(i=!0),new t(s.extractWebUrl(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+i+",url='"+e+"')").postCore({body:n}).then(function(e){return{data:e,file:new o.File(a.spExtractODataId(e))}})},t}(r.SharePointQueryableCollection);t.AppCatalog=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.deploy=function(){return this.clone(t,"Deploy").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(r.SharePointQueryableInstance);t.App=c},function(e,t,n){"use strict";function i(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function r(e,t){void 0===t&&(t=0);var n=this.substring(t).search(e);return n>=0?n+t:n}function o(e,t){var n=new RegExp(t+'="([^"]*?)"',"i"),i=n.exec(e);return i.length>0?i[1]:null}function a(e,t,n){var i=[];if(void 0===e||null===e)return i;var o=e.replace(/[\t\r\n]/g,""),a=r.call(o,t);if(a<0)return i;for(;a>-1;){for(var s=1,l=a+1,c=-1,d=-1;;){if(c=r.call(o,/<div[^>]*>/i,l),d=r.call(o,/<\/div>/i,l),c<0&&(c=o.length+1),c<d?(s++,l=c+1):d<c&&(s--,l=d+1),0===s){var u=o.substring(a,d+6).trim();i.push(n(u));break}if(s>1e3||s<0)throw new Error("getBoundedDivMarkup exceeded depth parameters.")}a=r.call(o,t,d)}return i}function s(e){for(var t=0;t<e.length;t++)e[t].order=t+1,e[t].hasOwnProperty("columns")?s(e[t].columns):e[t].hasOwnProperty("controls")&&s(e[t].controls)}var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var c=n(8),d=n(12),u=n(0),p=function(e){function t(t,n,i){void 0===n&&(n=[]),void 0===i&&(i=!1);var r=e.call(this,t)||this;return r.sections=n,r.commentsDisabled=i,r}return l(t,e),t.create=function(e,n,i,r){return void 0===r&&(r="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+n+"'").get().then(function(o){if(o.length>0)throw new Error("A file with the name '"+n+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(o){var a=u.Util.combinePaths("/",o.ServerRelativePath.DecodedUrl,n);return e.rootFolder.files.addTemplateFile(a,c.TemplateFileType.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:r,PromotedState:0,Title:i}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var n=new t(e);return n.load().then(function(e){return n})},t.jsonToEscapedString=function(e){return JSON.stringify(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")},t.escapedStringToJson=function(e){return JSON.parse(e.replace(/&quot;/g,'"').replace(/&#58;/g,":").replace(/&#123;/g,"{").replace(/&#125;/g,"}"))},t.prototype.addSection=function(){var e=new h(this,i(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){s(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],a(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var n=/controlType&quot;&#58;(\d*?),/i.exec(e),i=null==n||n.length<2?0:parseInt(n[1],10),r=null;switch(i){case 0:r=new g(null,0),r.fromHtml(e),t.mergeColumnToTree(r);break;case 3:r=new y(""),r.fromHtml(e),t.mergeControlToTree(r);break;case 4:r=new m,r.fromHtml(e),t.mergeControlToTree(r)}}),s(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var i=0;i<this.sections[t].columns[n].controls.length;i++)if(e(this.sections[t].columns[n].controls[i]))return this.sections[t].columns[n].controls[i];return null},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new d.Item(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.mergeControlToTree=function(e){var t=null,n=null,i=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});i.length<1?(t=new h(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=i[0];var r=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});r.length<1?(n=new g(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(n)):n=r[0],e.column=n,n.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new h(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0],e.section=t,t.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(n){return n.update(e,t)})},t}(c.File);t.ClientSidePage=p;var h=function(){function e(e,t,n){void 0===n&&(n=[]),this.page=e,this.order=t,this.columns=n}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new g(this,i(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e}();t.CanvasSection=h;var f=function(){function e(e,t,n,i,r,o){void 0===n&&(n=null),void 0===i&&(i=1),void 0===r&&(r=u.Util.getGUID()),void 0===o&&(o=null),this.controlType=e,this.dataVersion=t,this.column=n,this.order=i,this.id=r,this.controlData=o}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return p.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=p.escapedStringToJson(o(e,"data-sp-controldata")),this.dataVersion=o(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}();t.CanvasControl=f;var g=function(e){function t(t,n,i,r,o){void 0===i&&(i=12),void 0===r&&(r=[]),void 0===o&&(o="1.0");var a=e.call(this,0,o)||this;return a.section=t,a.order=n,a.factor=i,a.controls=r,a}return l(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=p.escapedStringToJson(o(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t}(f);t.CanvasColumn=g;var m=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,4,"1.0")||this;return n.text=t,n}return l(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(t);this.text=n.length>1?n[1]:""},t}(f);t.ClientSideText=m;var y=function(e){function t(t,n,i,r,o,a){void 0===n&&(n=""),void 0===i&&(i={}),void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a=null);var s=e.call(this,3,"1.0")||this;return s.title=t,s.description=n,s.propertieJson=i,s.webPartId=r,s.htmlProperties=o,s.serverProcessedContent=a,s}return l(t,e),t.fromComponentDef=function(e){var n=new t("");return n.import(e),n},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"");var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=e,this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,title:this.title},n=[];return n.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),n.push('<div data-sp-webpart="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+p.jsonToEscapedString(t)+'">'),n.push("<div data-sp-componentid>"),n.push(this.webPartId),n.push("</div>"),n.push('<div data-sp-htmlproperties="">'),n.push(this.renderHtmlProperties()),n.push("</div>"),n.push("</div>"),n.push("</div>"),n.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=p.escapedStringToJson(o(t,"data-sp-webpartdata"));this.title=n.title,this.description=n.description,this.webPartId=n.id,this.setProperties(n.properties),void 0!==n.serverProcessedContent&&(this.serverProcessedContent=n.serverProcessedContent);var i=a(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=i.length>0?i[0]:""},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=0;t<this.serverProcessedContent.searchablePlainTexts.length;t++){var n=this.serverProcessedContent.searchablePlainTexts[t];e.push('<div data-sp-prop-name="'+n.Name+'" data-sp-searchableplaintext="true">'),e.push(n.Value),e.push("</div>")}if(void 0!==this.serverProcessedContent.imageSources)for(var t=0;t<this.serverProcessedContent.imageSources.length;t++){var n=this.serverProcessedContent.imageSources[t];e.push('<img data-sp-prop-name="'+n.Name+'" src="'+n.Value+'" />')}if(void 0!==this.serverProcessedContent.links)for(var t=0;t<this.serverProcessedContent.links.length;t++){var n=this.serverProcessedContent.links[t];e.push('<a data-sp-prop-name="'+n.Name+'" href="'+n.Value+'"></a>')}}return e.join("")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(f);t.ClientSideWebpart=y},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=function(e){function t(t,n){return void 0===n&&(n="_api/social.following"),e.call(this,t,n)||this}return i(t,e),Object.defineProperty(t.prototype,"my",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(t,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(t,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(t,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(t,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(t,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return JSON.stringify({actor:o.Util.extend({Id:null,__metadata:{type:"SP.Social.SocialActorInfo"}},e)})},t}(r.SharePointQueryableInstance);t.SocialQuery=a;var s=function(e){function t(t,n){return void 0===n&&(n="my"),e.call(this,t,n)||this}return i(t,e),t.prototype.followed=function(e){return this.clone(t,"followed(types="+e+")").get().then(function(e){return e.hasOwnProperty("Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(t,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(t,"followers").get().then(function(e){return e.hasOwnProperty("Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(t,"suggestions").get().then(function(e){return e.hasOwnProperty("Suggestions")?e.Suggestions.results:e})},t}(r.SharePointQueryableInstance);t.MySocialQuery=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=n(8),s=n(3),l=function(e){function t(n,i){return e.call(this,t.getBaseUrl(n),"_api/SP.Utilities.Utility."+i)||this}return i(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,n=t.toUrl(),i=n.indexOf("_api/");return i<0?n:n.substr(0,i)},t.prototype.excute=function(e){return this.postAsCore({body:JSON.stringify(e)})},t.prototype.sendEmail=function(e){var n={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(n.properties=o.Util.extend(n.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(n.properties=o.Util.extend(n.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(n.properties=o.Util.extend(n.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(n.properties=o.Util.extend(n.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(n)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({})},t.prototype.resolvePrincipal=function(e,n,i,r,o,a){void 0===a&&(a=!1);var s={addToUserInfoList:o,input:e,inputIsEmailOnly:r,matchUserInfoList:a,scopes:n,sources:i};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(s)},t.prototype.searchPrincipals=function(e,n,i,r,o){var a={groupName:r,input:e,maxCount:o,scopes:n,sources:i};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(a)},t.prototype.createEmailBodyForInvitation=function(e){var n={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(n)},t.prototype.expandGroupsToPrincipals=function(e,n){void 0===n&&(n=30);var i={inputs:e,maxCount:n};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(i)},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new a.File(s.spExtractODataId(e))}})},t}(r.SharePointQueryable);t.UtilityMethod=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(4),o=n(10),a=function(){function e(){this._impl=r.RuntimeConfig.graphFetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;o.mergeHeaders(n,r.RuntimeConfig.graphHeaders),o.mergeHeaders(n,t.headers);var a=i.Util.extend(t,{headers:n});return this.fetchRaw(e,a)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;o.mergeHeaders(r,t.headers),t=i.Util.extend(t,{headers:r});var a=function(r){n._impl.fetch(e,{},t).then(function(e){return r.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&r.reject(e);var t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(i.Util.getCtxCallback(n,a,r),t)})};return new Promise(function(e,t){var i={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};a.call(n,i)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=i.Util.extend(t,{method:"DELETE"});return this.fetch(e,n)},e}();t.GraphHttpClient=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(13),r=n(2),o=function(){function e(e,t,n){this.wrappedProvider=e,this.store=n||this.selectPnPCache(),this.cacheKey="_configcache_"+t}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e){e(t)});var n=this.wrappedProvider.getConfiguration();return n.then(function(t){e.store.put(e.cacheKey,t)}),n},e.prototype.selectPnPCache=function(){var e=new i.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new r.NoCacheAvailableException},e}();t.default=o},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),r=function(){function e(){this._settings=new i.Dictionary}return e.prototype.add=function(e,t){this._settings.add(e,t)},e.prototype.addJSON=function(e,t){this._settings.add(e,JSON.stringify(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(n,i){try{t._settings.merge(e),n()}catch(e){i(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(n,i){e.getConfiguration().then(function(e){t._settings.merge(e),n()}).catch(function(e){i(e)})})},e.prototype.get=function(e){return this._settings.get(e)},e.prototype.getJSON=function(e){var t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)},e}();t.Settings=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(32),r=n(34),o=n(35),a=n(11),s=n(0),l=n(57),c=n(42),d=n(28),u=n(2),p=n(43),h=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new r.SearchSuggest(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof i.SearchQueryBuilder?e.toSearchQuery():e,new i.Search(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new o.Site(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new a.Web(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new l.UserProfileQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return new c.SocialQuery(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new d.NavigationService},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new p.UtilityMethod(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e.prototype.crossDomainSite=function(e,t){return this._cdImpl(o.Site,e,t,"site")},e.prototype.crossDomainWeb=function(e,t){return this._cdImpl(a.Web,e,t,"web")},e.prototype._cdImpl=function(e,t,n,i){if(!s.Util.isUrlAbsolute(t))throw new u.UrlException("The addInWebUrl parameter must be an absolute url.");if(!s.Util.isUrlAbsolute(n))throw new u.UrlException("The hostWebUrl parameter must be an absolute url.");var r=s.Util.combinePaths(t,"_api/SP.AppContextSite(@target)"),o=new e(r,i);return o.query.add("@target","'"+encodeURIComponent(n)+"'"),o.configure(this._options)},e}();t.SPRest=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),r=n(0),o=n(7),a=n(4),s=function(){function e(){}return e}();t.CachedDigest=s;var l=new i.Dictionary,c=function(){function e(e,t){void 0===t&&(t=l),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(null!==n){if(new Date<n.expiration)return Promise.resolve(n.value)}var i=r.Util.combinePaths(e,"/_api/contextinfo"),l={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:r.Util.extend(l,a.RuntimeConfig.spHeaders,!0),method:"POST"}).then(function(e){return(new o.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var i=new s;i.value=n.FormDigestValue;var r=n.FormDigestTimeoutSeconds,o=new Date;return o.setTime(o.getTime()+1e3*r),i.expiration=o,t._digests.add(e,i),i.value})},e.prototype.clear=function(){this._digests.clear()},e}();t.DigestCache=c},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(7),a=function(e){function t(t,n){return void 0===n&&(n="AttachmentFiles"),e.call(this,t,n)||this}return i(t,e),t.prototype.getByName=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,n){var i=this;return this.clone(t,"add(FileName='"+e+"')",!1).postCore({body:n}).then(function(t){return{data:t,file:i.getByName(e)}})},t.prototype.addMultiple=function(e){var n=this;return e.reduce(function(e,i){return e.then(function(){return n.clone(t,"add(FileName='"+i.name+"')",!1).postCore({body:i.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).recycle()})},Promise.resolve())},t}(r.SharePointQueryableCollection);t.AttachmentFiles=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new o.TextFileParser)},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new o.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new o.BufferFileParser)},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new o.JSONFileParser)},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(r.SharePointQueryableInstance);t.AttachmentFile=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=function(e){function t(t,n){return void 0===n&&(n="views"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new s(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new s(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i={});var a=JSON.stringify(o.Util.extend({PersonalView:n,Title:e,__metadata:{type:"SP.View"}},i));return this.clone(t,null).postAsCore({body:a}).then(function(e){return{data:e,view:r.getById(e.Id)}})},t}(r.SharePointQueryableCollection);t.Views=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this,n=JSON.stringify(o.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},t.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype.renderAsHtml=function(){return this.clone(r.SharePointQueryable,"renderashtml").get()},t}(r.SharePointQueryableInstance);t.View=s;var l=function(e){function t(t,n){return void 0===n&&(n="viewfields"),e.call(this,t,n)||this}return i(t,e),t.prototype.getSchemaXml=function(){return this.clone(r.SharePointQueryable,"schemaxml").get()},t.prototype.add=function(e){return this.clone(t,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,n){return this.clone(t,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:n})})},t.prototype.removeAll=function(){return this.clone(t,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(t,"removeviewfield('"+e+"')").postCore()},t}(r.SharePointQueryableCollection);t.ViewFields=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t,n){return void 0===n&&(n="forms"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t}(r.SharePointQueryableCollection);t.Forms=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r.SharePointQueryableInstance);t.Form=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t,n){return void 0===n&&(n="subscriptions"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){var t=new a(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n){var i=this,r=JSON.stringify({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:r,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:i.getById(e.id)}})},t}(r.SharePointQueryableCollection);t.Subscriptions=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patchCore({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(r.SharePointQueryableInstance);t.Subscription=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(3),a=n(0),s=function(e){function t(t,n){return void 0===n&&(n="regionalsettings"),e.call(this,t,n)||this}return i(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new l(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new c(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new d(this)},enumerable:!0,configurable:!0}),t}(r.SharePointQueryableInstance);t.RegionalSettings=s;var l=function(e){function t(t,n){return void 0===n&&(n="installedlanguages"),e.call(this,t,n)||this}return i(t,e),t}(r.SharePointQueryableCollection);t.InstalledLanguages=l;var c=function(e){function t(t,n){return void 0===n&&(n="timezone"),e.call(this,t,n)||this}return i(t,e),t.prototype.utcToLocalTime=function(e){var n;return n="string"==typeof e?e:e.toISOString(),this.clone(t,"utctolocaltime('"+n+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var n;return n="string"==typeof e?e:a.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(t,"localtimetoutc('"+n+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},t}(r.SharePointQueryableInstance);t.TimeZone=c;var d=function(e){function t(t,n){return void 0===n&&(n="timezones"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return this.clone(t,"GetById("+e+")").postAsCore({},o.spODataEntity(c))},t}(r.SharePointQueryableCollection);t.TimeZones=d},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t,n){return void 0===n&&(n="_api/SP.RelatedItemManager"),e.call(this,t,n)||this}return i(t,e),t.FromUrl=function(e){if(null===e)return new t("");var n=e.indexOf("_api/");return new t(n>-1?e.substr(0,n):e)},t.prototype.getRelatedItems=function(e,n){var i=this.clone(t,null);return i.concat(".GetRelatedItems"),i.postCore({body:JSON.stringify({SourceItemID:n,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,n){var i=this.clone(t,null);return i.concat(".GetPageOneRelatedItems"),i.postCore({body:JSON.stringify({SourceItemID:n,SourceListName:e})})},t.prototype.addSingleLink=function(e,n,i,r,o,a,s){void 0===s&&(s=!1);var l=this.clone(t,null);return l.concat(".AddSingleLink"),l.postCore({body:JSON.stringify({SourceItemID:n,SourceListName:e,SourceWebUrl:i,TargetItemID:o,TargetListName:r,TargetWebUrl:a,TryAddReverseLink:s})})},t.prototype.addSingleLinkToUrl=function(e,n,i,r){void 0===r&&(r=!1);var o=this.clone(t,null);return o.concat(".AddSingleLinkToUrl"),o.postCore({body:JSON.stringify({SourceItemID:n,SourceListName:e,TargetItemUrl:i,TryAddReverseLink:r})})},t.prototype.addSingleLinkFromUrl=function(e,n,i,r){void 0===r&&(r=!1);var o=this.clone(t,null);return o.concat(".AddSingleLinkFromUrl"),o.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:i,TargetListName:n,TryAddReverseLink:r})})},t.prototype.deleteSingleLink=function(e,n,i,r,o,a,s){void 0===s&&(s=!1);var l=this.clone(t,null);return l.concat(".DeleteSingleLink"),l.postCore({body:JSON.stringify({SourceItemID:n,SourceListName:e,SourceWebUrl:i,TargetItemID:o,TargetListName:r,TargetWebUrl:a,TryDeleteReverseLink:s})})},t}(r.SharePointQueryable);t.RelatedItemManagerImpl=o},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(58),a=n(0),s=n(7),l=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var i=e.call(this,t,n)||this;return i.clientPeoplePickerQuery=new d(t),i.profileLoader=new c(t),i}return i(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").getAs(s.ODataValue())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").getAs(s.ODataValue())},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=this.clone(t,"amifollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.amIFollowing=function(e){var n=this.clone(t,"amifollowing(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var n=this.clone(t,"getfollowersfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new r.SharePointQueryableCollection(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=this.clone(t,"getpeoplefollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getPropertiesFor=function(e){var n=this.clone(t,"getpropertiesfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var i=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return i.query.add("@v","'"+encodeURIComponent(e)+"'"),i.get()},t.prototype.hideSuggestion=function(e){var n=this.clone(t,"hidesuggestion(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.postCore()},t.prototype.isFollowing=function(e,n){var i=this.clone(t,null);return i.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),i.query.add("@v","'"+encodeURIComponent(e)+"'"),i.query.add("@y","'"+encodeURIComponent(n)+"'"),i.get()},t.prototype.setMyProfilePic=function(e){var n=this;return new Promise(function(i,r){o.readBlobAsArrayBuffer(e).then(function(e){new t(n,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return i()})}).catch(function(e){return r(e)})})},t.prototype.setSingleValueProfileProperty=function(e,n,i){var r=JSON.stringify({accountName:e,propertyName:n,propertyValue:i});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:r})},t.prototype.setMultiValuedProfileProperty=function(e,n,i){var r=JSON.stringify({accountName:e,propertyName:n,propertyValues:i});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:r})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(r.SharePointQueryableInstance);t.UserProfileQuery=l;var c=function(e){function t(t,n){return void 0===n&&(n="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,n)||this}return i(t,e),t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(t,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postAsCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(t,"getuserprofile").postAsCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(t,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(t,"getuserprofile/shareallsocialdata("+e+")").postCore()},t}(r.SharePointQueryable),d=function(e){function t(t,n){return void 0===n&&(n="_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface"),e.call(this,t,n)||this}return i(t,e),t.prototype.clientPeoplePickerResolveUser=function(e){var n=this.clone(t,null);return n.concat(".clientpeoplepickerresolveuser"),n.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.clientPeoplePickerSearchUser=function(e){var n=this.clone(t,null);return n.concat(".clientpeoplepickersearchuser"),n.postAsCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return JSON.stringify({queryParams:a.Util.extend({__metadata:{type:"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"}},e)})},t}(r.SharePointQueryable)},function(e,t,n){"use strict";function i(e){return o(e,"string")}function r(e){return o(e,"buffer")}function o(e,t){return new Promise(function(n,i){try{var r=new FileReader;switch(r.onload=function(e){n(e.target.result)},t){case"string":r.readAsText(e);break;case"buffer":r.readAsArrayBuffer(e)}}catch(e){i(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.readBlobAsText=i,t.readBlobAsArrayBuffer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(60),r=function(){function e(){}return Object.defineProperty(e.prototype,"v1",{get:function(){return new i.V1("")},enumerable:!0,configurable:!0}),e}();t.GraphRest=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(61),a=function(e){function t(t,n){return void 0===n&&(n="v1.0"),e.call(this,t,n)||this}return i(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new o.Groups(this)},enumerable:!0,configurable:!0}),t}(r.GraphQueryable);t.V1=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(6),a=n(62),s=n(0),l=n(63),c=n(64),d=n(66),u=n(67);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(r=t.GroupType||(t.GroupType={}));var p=function(e){function t(t,n){return void 0===n&&(n="groups"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new h(this,e)},t.prototype.add=function(e,t,n,i){var o=this;void 0===i&&(i={});var a=s.Util.extend({displayName:e,mailEnabled:n===r.Office365,mailNickname:t,securityEnabled:n!==r.Office365},i);return n!==r.Security&&(a=s.Util.extend(a,{groupTypes:[n===r.Office365?"Unified":"DynamicMembership"]})),this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,group:o.getById(e.id)}})},t}(o.GraphQueryableCollection);t.Groups=p;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"caldendar",{get:function(){return new l.Calendar(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new l.Events(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new a.Owners(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new d.Plans(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new a.Members(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new c.Conversations(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new c.Senders(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new c.Senders(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new u.Photo(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:JSON.stringify({securityEnabledOnly:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,n){var i=this.clone(t,"calendarView");return i.query.add("startDateTime",e.toISOString()),i.query.add("endDateTime",n.toISOString()),i.get()},t}(o.GraphQueryableInstance);t.Group=h},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=function(e){function t(t,n){return void 0===n&&(n="members"),e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.getById=function(e){return new a(this,e)},t}(r.GraphQueryableCollection);t.Members=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r.GraphQueryableInstance);t.Member=a;var s=function(e){function t(t,n){return void 0===n&&(n="owners"),e.call(this,t,n)||this}return i(t,e),t}(o);t.Owners=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=function(e){function t(t,n){return void 0===n&&(n="calendars"),e.call(this,t,n)||this}return i(t,e),t}(r.GraphQueryableCollection);t.Calendars=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t}(r.GraphQueryableInstance);t.Calendar=a;var s=function(e){function t(t,n){return void 0===n&&(n="events"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new l(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:JSON.stringify(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t}(r.GraphQueryableCollection);t.Events=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(r.GraphQueryableInstance);t.Event=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(65),a=function(e){function t(t,n){return void 0===n&&(n="conversations"),e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getById=function(e){return new c(this,e)},t}(r.GraphQueryableCollection);t.Conversations=a;var s=function(e){function t(t,n){return void 0===n&&(n="threads"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new d(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(r.GraphQueryableCollection);t.Threads=s;var l=function(e){function t(t,n){return void 0===n&&(n="posts"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new u(this,e)},t.prototype.add=function(e){return this.postCore({body:JSON.stringify(e)})},t}(r.GraphQueryableCollection);t.Posts=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:JSON.stringify(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(r.GraphQueryableInstance);t.Conversation=c;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new l(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(r.GraphQueryableInstance);t.Thread=d;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new o.Attachments(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:JSON.stringify(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:JSON.stringify({post:e})})},t}(r.GraphQueryableInstance);t.Post=u;var p=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:JSON.stringify({"@odata.id":e})})},t.prototype.remove=function(e){var n=this.clone(t,"$ref");return n.query.add("$id",e),n.deleteCore()},t}(r.GraphQueryableCollection);t.Senders=p},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=function(e){function t(t,n){return void 0===n&&(n="attachments"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new a(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:JSON.stringify({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t}(r.GraphQueryableCollection);t.Attachments=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r.GraphQueryableInstance);t.Attachment=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=function(e){function t(t,n){return void 0===n&&(n="planner/plans"),e.call(this,t,n)||this}return i(t,e),t.prototype.getById=function(e){return new a(this,e)},t}(r.GraphQueryableCollection);t.Plans=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r.GraphQueryableInstance);t.Plan=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(7),a=function(e){function t(t,n){return void 0===n&&(n="photo"),e.call(this,t,n)||this}return i(t,e),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new o.BlobFileParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new o.BufferFileParser)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(r.GraphQueryableInstance);t.Photo=a},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(69));var r=n(9);t.Dictionary=r.Dictionary;var o=n(0);t.Util=o.Util,i(n(5)),i(n(2)),i(n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(45);t.CachingConfigurationProvider=i.default;var r=n(70);t.SPListConfigurationProvider=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(45),r=function(){function e(e,t){void 0===t&&(t="config"),this.sourceWeb=e,this.sourceListTitle=t}return Object.defineProperty(e.prototype,"web",{get:function(){return this.sourceWeb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listTitle",{get:function(){return this.sourceListTitle},enumerable:!0,configurable:!0}),e.prototype.getConfiguration=function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(e){return e.reduce(function(e,t){return Object.defineProperty(e,t.Title,{configurable:!1,enumerable:!1,value:t.Value,writable:!1})},{})})},e.prototype.asCaching=function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new i.default(this,e)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(72))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6);t.GraphQueryable=i.GraphQueryable,t.GraphQueryableCollection=i.GraphQueryableCollection,t.GraphQueryableInstance=i.GraphQueryableInstance,t.GraphQueryableSearchableCollection=i.GraphQueryableSearchableCollection},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(22);t.HttpClient=i.HttpClient;var r=n(74);t.SPRequestExecutorClient=r.SPRequestExecutorClient;var o=n(75);t.NodeFetchClient=o.NodeFetchClient;var a=n(31);t.FetchClient=a.FetchClient;var s=n(44);t.GraphHttpClient=s.GraphHttpClient},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2),o=function(){function e(){this.convertToResponse=function(e){var t=new Headers;for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var i=204===e.statusCode?null:e.body;return new Response(i,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(e,t){var n=this;if("undefined"==typeof SP||void 0===SP.RequestExecutor)throw new r.SPRequestExecutorUndefinedException;var o,a,s=e.substring(0,e.indexOf("/_api")),l=new SP.RequestExecutor(s),c={};if(t.headers&&t.headers instanceof Headers)for(o=t.headers.entries(),a=o.next();!a.done;)c[a.value[0]]=a.value[1],a=o.next();else c=t.headers;var d=["files/add","files/addTemplateFile","file/startUpload","file/continueUpload","file/finishUpload","attachmentfiles/add"],u=new RegExp(d.join("|"),"i").test(e);return new Promise(function(r,o){var a={error:function(e){o(n.convertToResponse(e))},headers:c,method:t.method,success:function(e){r(n.convertToResponse(e))},url:e};t.body&&(a=i.Util.extend(a,{body:t.body}),u&&(a=i.Util.extend(a,{binaryStringRequestBody:!0}))),l.executeAsync(a)})},e}();t.SPRequestExecutorClient=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=function(){function e(){}return e.prototype.fetch=function(){throw new i.NodeFetchClientUnsupportedException},e}();t.NodeFetchClient=r},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(14)),i(n(7)),i(n(33)),i(n(20))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(78))},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var r=n(40);t.AppCatalog=r.AppCatalog,t.App=r.App,i(n(41));var o=n(29);t.ODataBatch=o.ODataBatch;var a=n(26);t.Field=a.Field,t.Fields=a.Fields;var s=n(8);t.CheckinType=s.CheckinType,t.WebPartsPersonalizationScope=s.WebPartsPersonalizationScope,t.MoveOperations=s.MoveOperations,t.TemplateFileType=s.TemplateFileType,t.File=s.File,t.Files=s.Files;var l=n(18);t.Folder=l.Folder,t.Folders=l.Folders;var c=n(12);t.Item=c.Item,t.Items=c.Items,t.ItemVersion=c.ItemVersion,t.ItemVersions=c.ItemVersions,t.PagedItemCollection=c.PagedItemCollection;var d=n(28);t.NavigationNodes=d.NavigationNodes,t.NavigationNode=d.NavigationNode;var u=n(15);t.List=u.List,t.Lists=u.Lists;var p=n(3);t.spExtractODataId=p.spExtractODataId,t.spODataEntity=p.spODataEntity,t.spODataEntityArray=p.spODataEntityArray;var h=n(1);t.SharePointQueryable=h.SharePointQueryable,t.SharePointQueryableInstance=h.SharePointQueryableInstance,t.SharePointQueryableCollection=h.SharePointQueryableCollection;var f=n(23);t.RoleDefinitionBindings=f.RoleDefinitionBindings;var g=n(32);t.Search=g.Search,t.SearchQueryBuilder=g.SearchQueryBuilder,t.SearchResults=g.SearchResults,t.SortDirection=g.SortDirection,t.ReorderingRuleMatchType=g.ReorderingRuleMatchType,t.QueryPropertyValueType=g.QueryPropertyValueType,t.SearchBuiltInSourceId=g.SearchBuiltInSourceId;var m=n(34);t.SearchSuggest=m.SearchSuggest,t.SearchSuggestResult=m.SearchSuggestResult;var y=n(35);t.Site=y.Site,i(n(42)),i(n(17));var b=n(43);t.UtilityMethod=b.UtilityMethod;var v=n(38);t.WebPartDefinitions=v.WebPartDefinitions,t.WebPartDefinition=v.WebPartDefinition,t.WebPart=v.WebPart;var x=n(11);t.Web=x.Web},,function(e,t){function n(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=i(r);return[n].concat(r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"})).concat([o]).join("\n")}return[n].join("\n")}function i(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=n(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){"use strict";(function(e){function n(e){var t=P();e();var n=P();C.perf.duration+=n-t}function i(e,t){void 0===t&&(t=!1),n(function(){var n=Array.isArray(e)?e:g(e);void 0===x&&(x=b());var i=C.runState,r=i.mode,o=i.buffer,a=i.flushTimer;t||1===r?(o.push(n),a||(C.runState.flushTimer=s())):l(n)})}function r(e){C.loadStyles=e}function o(e){C.runState.mode=e}function a(){n(function(){var e=C.runState.buffer.slice();C.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&l(t)})}function s(){return setTimeout(function(){C.runState.flushTimer=0,a()},0)}function l(e,t){C.loadStyles?C.loadStyles(f(e).styleString,e):x?y(e,t):m(e)}function c(e){C.theme=e,p()}function d(e){void 0===e&&(e=3),3!==e&&2!==e||(u(C.registeredStyles),C.registeredStyles=[]),3!==e&&1!==e||(u(C.registeredThemableStyles),C.registeredThemableStyles=[])}function u(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function p(){if(C.theme){for(var e=[],t=0,n=C.registeredThemableStyles;t<n.length;t++){var i=n[t];e.push(i.themableStyle)}e.length>0&&(d(1),l([].concat.apply([],e)))}}function h(e){return e&&(e=f(g(e)).styleString),e}function f(e){var t=C.theme,n=!1;return{styleString:(e||[]).map(function(e){var i=e.theme;if(i){n=!0;var r=t?t[i]:void 0,o=e.defaultValue||"inherit";return t&&!r&&console,r||o}return e.rawString}).join(""),themable:n}}function g(e){var t=[];if(e){for(var n=0,i=void 0;i=_.exec(e);){var r=i.index;r>n&&t.push({rawString:e.substring(n,r)}),t.push({theme:i[1],defaultValue:i[2]}),n=_.lastIndex}t.push({rawString:e.substring(n)})}return t}function m(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),i=f(e),r=i.styleString,o=i.themable;n.type="text/css",n.appendChild(document.createTextNode(r)),C.perf.count++,t.appendChild(n);var a={styleElement:n,themableStyle:e};o?C.registeredThemableStyles.push(a):C.registeredStyles.push(a)}function y(e,t){var n=document.getElementsByTagName("head")[0],i=C.registeredStyles,r=C.lastStyleElement,o=r?r.styleSheet:void 0,a=o?o.cssText:"",s=i[i.length-1],l=f(e).styleString;(!r||a.length+l.length>k)&&(r=document.createElement("style"),r.type="text/css",t?(n.replaceChild(r,t.styleElement),t.styleElement=r):n.appendChild(r),t||(s={styleElement:r,themableStyle:e},i.push(s))),r.styleSheet.cssText+=h(l),Array.prototype.push.apply(s.themableStyle,e),C.lastStyleElement=r}function b(){var e=!1;if("undefined"!=typeof document){var t=document.createElement("style");t.type="text/css",e=!!t.styleSheet}return e}var v=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var x,w="undefined"==typeof window?e:window,C=function(){var e=w.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};return e.runState||(e=v({},e,{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),e.registeredThemableStyles||(e=v({},e,{registeredThemableStyles:[]})),w.__themeState__=e,e}(),_=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,k=1e4,P=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};t.loadStyles=i,t.configureLoadStyles=r,t.configureRunMode=o,t.flush=a,t.loadTheme=c,t.clearStyles=d,t.detokenize=h,t.splitStyles=g}).call(t,n(30))},,function(e,t){e.exports=n},,function(e,t){!function(e){e.fn.richText=function(t){function n(e,t,n){if(void 0===t&&(t=null),f(n),"heading"===e&&l())g("<"+t+">"+l()+"</"+t+">");else if("fontSize"===e&&parseInt(t)>0){var i=l();i=(i+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2");var r=_.useSingleQuotes?"<span style='font-size:"+t+"px;'>"+i+"</span>":'<span style="font-size:'+t+'px;">'+i+"</span>";g(r)}else document.execCommand(e,!1,t)}function i(){var t=e("#"+K),n=t.html();!0===_.useSingleQuotes&&(n=m(n)),t.siblings(".richText-initial").val(n)}function r(t){var n=e("#"+t),i=n.siblings(".richText-initial").val();n.html(i)}function o(t){var n,i,r,o,a=document.getElementById(t);if(window.getSelection&&document.createRange){var s=window.getSelection&&window.getSelection();if(s&&s.rangeCount>0&&e(s.anchorNode).parents("#"+t).length>0){n=window.getSelection().getRangeAt(0);var l=n.cloneRange();return l.selectNodeContents(a),l.setEnd(n.startContainer,n.startOffset),i=l.toString().length,r=i+n.toString().length,o=i===r?"caret":"selection",anchor=s.anchorNode,i="caret"===o&&!1!==anchor?0:l.toString().length,r="caret"===o&&!1!==anchor?0:i+n.toString().length,{start:i,end:r,type:o,anchor:anchor,editorID:t}}}return $||{start:0,end:0}}function a(t,n,i){var r=document.getElementById(t),o=$;if(o||(o={start:0,end:0,type:"caret",editorID:t,anchor:e("#"+t).children("div")[0]}),o.editorID!==t)return!1;if(!0===n?r=o.anchor?o.anchor:r:!0===i&&0===o.start&&0===o.end&&(r=o.anchor?o.anchor:r),window.getSelection&&document.createRange){var a=0,s=document.createRange();if(!s||!r)return window.getSelection().removeAllRanges(),!0;s.setStart(r,0),s.collapse(!0);for(var l,c=[r],d=!1,u=!1;!u&&(l=c.pop());)if(3===l.nodeType){var p=a+l.length;!d&&o.start>=a&&o.start<=p&&(s.setStart(l,o.start-a),d=!0),d&&o.end>=a&&o.end<=p&&(s.setEnd(l,o.end-a),u=!0),a=p}else for(var h=l.childNodes.length;h--;)c.push(l.childNodes[h]);var f=window.getSelection();f.removeAllRanges(),f.addRange(s)}}function s(t,n){if(9!==n.keyCode)return!1;var i;if(t.getSelection&&(i=t.getSelection(),i.rangeCount>0)){var r=null,o=null;if(n.shiftKey?(o="previous",r="TD"===i.focusNode.nodeName?null!=i.focusNode.previousSibling?i.focusNode.previousSibling:null!=i.focusNode.parentNode.previousSibling?i.focusNode.parentNode.previousSibling.childNodes[i.focusNode.parentNode.previousSibling.childNodes.length-1]:null:null!=i.focusNode.parentNode.previousSibling?i.focusNode.parentNode.previousSibling:null!=i.focusNode.parentNode.parentNode.previousSibling?i.focusNode.parentNode.parentNode.previousSibling.childNodes[i.focusNode.parentNode.parentNode.previousSibling.childNodes.length-1]:null):(o="next",r="TD"===i.focusNode.nodeName?null!=i.focusNode.nextSibling?i.focusNode.nextSibling:null!=i.focusNode.parentNode.nextSibling?i.focusNode.parentNode.nextSibling.childNodes[0]:null:null!=i.focusNode.parentNode.nextSibling?i.focusNode.parentNode.nextSibling:null!=i.focusNode.parentNode.parentNode.nextSibling?i.focusNode.parentNode.parentNode.nextSibling.childNodes[0]:null),null!=r)return i.collapse(r,Math.min(r.length,i.focusOffset+1)),null!=r.textContent&&i.selectAllChildren(r),n.preventDefault(),!0;if(null===r&&"next"===o&&"TD"===i.focusNode.nodeName){for(var a=e(i.focusNode).parents("table"),l=a.find("tr").first().children("td").length,c=e("<tr />"),d=e("<td />"),u=1;u<=l;u++)c.append(d.clone());a.append(c),s(window,{keyCode:9,shiftKey:!1,preventDefault:function(){}})}}return!1}function l(){var e;return window.getSelection?(e=window.getSelection(),e.toString()?e.toString():e.focusNode.nodeValue):!!document.selection.createRange&&(e=document.selection.createRange(),e.text)}function c(t){d(e(".richText-editor#"+t).siblings(".richText-initial").val(),t),$=o(t)}function d(e,t){if(!ee[t])return!1;ee[t].length-1>te[t]&&(ee[t].length=te[t]+1),ee[t][ee[t].length-1]!==e&&ee[t].push(e),te[t]=ee[t].length-1,u(t)}function u(e){te[e]<=0?P.find(".richText-undo").addClass("is-disabled"):P.find(".richText-undo").removeClass("is-disabled"),te[e]>=ee[e].length-1||0===ee[e].length?P.find(".richText-redo").addClass("is-disabled"):P.find(".richText-redo").removeClass("is-disabled")}function p(e){var t=e.children(".richText-editor").attr("id");if(!--te[t]&&0!==te[t])return!1;var n=ee[t][te[t]];e.find("textarea").val(n),e.find(".richText-editor").html(n),u(t)}function h(e){var t=e.children(".richText-editor").attr("id");if(!++te[t]&&0!==te[t])return!1;var n=ee[t][te[t]];e.find("textarea").val(n),e.find(".richText-editor").html(n),u(t)}function f(e){$&&a(e||$.editorID)}function g(e){var t,n;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt&&t.rangeCount){n=t.getRangeAt(0),n.deleteContents();var i=document.createElement("div");i.innerHTML=e;for(var r,o,a=document.createDocumentFragment();r=i.firstChild;)o=a.appendChild(r);n.insertNode(a),o&&(n=n.cloneRange(),n.setStartAfter(o),n.collapse(!0),t.removeAllRanges(),t.addRange(n))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(e)}function m(e){if(!e)return"";var t,n;return!0===_.useSingleQuotes?(t=/\s+(\w+\s*=\s*(["][^"]*["])|(['][^']*[']))+/g,n=e.replace(t,function(e,t,n){return n?e.replace(n,n.replace(/\"/g,"'")):e})):(t=/\s+(\w+\s*=\s*(['][^']*['])|(["][^"]*["]))+/g,n=e.replace(t,function(e,t,n){return n?e.replace(n,n.replace(/'/g,'"')):e})),n}function y(t){f(t),P.find(".richText-editor").is(":visible")?(P.find(".richText-initial").show(),P.find(".richText-editor").hide(),e(".richText-toolbar").find(".richText-btn").each(function(){0===e(this).children(".fa-code").length&&e(this).parent("li").attr("data-disable","true")}),b(t,$)):(P.find(".richText-initial").hide(),P.find(".richText-editor").show(),b(t,$,!0),e(".richText-toolbar").find("li").removeAttr("data-disable"))}function b(t,n,i){var r=e("#"+t),o=r.siblings(".richText-initial"),s=o.val();if(!n||!s)return{start:0,end:0};if(!0===i)return $={start:r.text().length,end:r.text().length,editorID:t},a(t),!0;n.node=o[0];for(var l={start:!1,end:!1,tag:!1,isTag:!1,tagsCount:0,isHighlight:n.start!==n.end},c=0;c<s.length;c++)"<"===s[c]?(l.isTag=!0,l.tag=!1,l.tagsCount++):!0===l.isTag&&">"!==s[c]?l.tagsCount++:!0===l.isTag&&">"===s[c]?(l.isTag=!1,l.tag=!0,l.tagsCount++):!0===l.tag&&(l.tag=!1),i||(n.start+l.tagsCount<=c&&l.isHighlight&&!l.isTag&&!l.tag&&!l.start?(n.start=c,l.start=!0):!(n.start+l.tagsCount<=c+1)||l.isHighlight||l.isTag||l.tag||l.start||(n.start=c+1,l.start=!0),n.end+l.tagsCount<=c+1&&!l.isTag&&!l.tag&&!l.end&&(n.end=c+1,l.end=!0));return v(n.node,n.start,n.end),n}function v(e,t,n){if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",t),i.moveEnd("character",n),i.select(),e.focus()}else e.setSelectionRange?(e.focus(),e.setSelectionRange(t,n)):void 0!==e.selectionStart&&(e.selectionStart=t,e.selectionEnd=n,e.focus())}function x(e,t){var n=w(e),i=!1,r=!1;if(!n)return!1;t?"responsive"!==t?t=t.split("x"):(i=!0,t="640x360",t=t.split("x")):(t="640x360",t=t.split("x"));var o="<br><br>";!0===i&&(o+='<div class="videoEmbed" style="position:relative;height:0;padding-bottom:56.25%">');var a="webkitallowfullscreen mozallowfullscreen allowfullscreen";if("YouTube"===n.platform){o+='<iframe src="https://'+(_.youtubeCookies?"www.youtube.com":"www.youtube-nocookie.com")+"/embed/"+n.id+'?ecver=2" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(!0===i?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+a+"></iframe>",r=!0}else"Vimeo"===n.platform?(o+='<iframe src="https://player.vimeo.com/video/'+n.id+'" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(!0===i?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+a+"></iframe>",r=!0):"Facebook"===n.platform?(o+='<iframe src="https://www.facebook.com/plugins/video.php?href='+encodeURI(e)+"&show_text=0&width="+t[0]+'" width="'+t[0]+'" height="'+t[1]+'" style="'+(!0===i?'position:absolute;width:100%;height:100%;left:0;border:none;overflow:hidden"':"border:none;overflow:hidden")+'" scrolling="no" frameborder="0" allowTransparency="true" '+a+"></iframe>",r=!0):"Dailymotion"===n.platform&&(o+='<iframe frameborder="0" width="'+t[0]+'" height="'+t[1]+'" src="//www.dailymotion.com/embed/video/'+n.id+'"'+(!0===i?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+a+"></iframe>",r=!0);return!0===i&&(o+="</div>"),o+="<br><br>",!!r&&o}function w(e){var t=/(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(.+)/,n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,i=/(?:http?s?:\/\/)?(?:www\.)?(?:facebook\.com)\/.*\/videos\/[0-9]+/,r=/(?:http?s?:\/\/)?(?:www\.)?(?:dailymotion\.com)\/video\/([a-zA-Z0-9]+)/,o=e.match(n),a=e.match(t),s=e.match(i),l=e.match(r);return o&&11===o[2].length?{platform:"YouTube",id:o[2]}:a&&a[1]?{platform:"Vimeo",id:a[1]}:s&&s[0]?{platform:"Facebook",id:s[0]}:!(!l||!l[1])&&{platform:"Dailymotion",id:l[1]}}function C(){P&&!P.find(".richText-editor").html()?!1!==_.useParagraph?P.find(".richText-editor").html("<p><br></p>"):P.find(".richText-editor").html("<div><br></div>"):!1!==_.useParagraph?P.find(".richText-editor").find("div:not(.videoEmbed)").replaceWith(function(){return e("<p />",{html:e(this).html()})}):P.find(".richText-editor").find("p").replaceWith(function(){return e("<div />",{html:e(this).html()})}),i()}var _=e.extend({bold:!0,italic:!0,underline:!0,leftAlign:!0,centerAlign:!0,rightAlign:!0,justify:!0,ol:!0,ul:!0,heading:!0,fonts:!0,fontList:["Arial","Arial Black","Comic Sans MS","Courier New","Geneva","Georgia","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman","Verdana"],fontColor:!0,fontSize:!0,imageUpload:!0,fileUpload:!0,videoEmbed:!0,urls:!0,table:!0,removeStyles:!0,code:!0,colors:[],fileHTML:"",imageHTML:"",translations:{title:"Title",white:"White",black:"Black",brown:"Brown",beige:"Beige",darkBlue:"Dark Blue",blue:"Blue",lightBlue:"Light Blue",darkRed:"Dark Red",red:"Red",darkGreen:"Dark Green",green:"Green",purple:"Purple",darkTurquois:"Dark Turquois",turquois:"Turquois",darkOrange:"Dark Orange",orange:"Orange",yellow:"Yellow",imageURL:"Image URL",fileURL:"File URL",linkText:"Link text",url:"URL",size:"Size",responsive:"Responsive",text:"Text",openIn:"Open in",sameTab:"Same tab",newTab:"New tab",align:"Align",left:"Left",justify:"Justify",center:"Center",right:"Right",rows:"Rows",columns:"Columns",add:"Add",pleaseEnterURL:"Please enter an URL",videoURLnotSupported:"Video URL not supported",pleaseSelectImage:"Please select an image",pleaseSelectFile:"Please select a file",bold:"Bold",italic:"Italic",underline:"Underline",alignLeft:"Align left",alignCenter:"Align centered",alignRight:"Align right",addOrderedList:"Add ordered list",addUnorderedList:"Add unordered list",addHeading:"Add Heading/title",addFont:"Add font",addFontColor:"Add font color",addFontSize:"Add font size",undo:"Undo",redo:"Redo",close:"Close"},youtubeCookies:!1,useSingleQuotes:!1,height:0,heightPercentage:0,id:"",class:"",useParagraph:!1},t),k=e(this);k.addClass("richText-initial");var P,F=e("<ul />"),T=e("<li />"),D=e("<a />",{class:"richText-btn","data-command":"bold",title:_.translations.bold,html:'<span class="fa fa-bold"></span>'}),S=e("<a />",{class:"richText-btn","data-command":"italic",title:_.translations.italic,html:'<span class="fa fa-italic"></span>'}),O=e("<a />",{class:"richText-btn","data-command":"underline",title:_.translations.underline,html:'<span class="fa fa-underline"></span>'}),A=e("<a />",{class:"richText-btn","data-command":"justifyFull",title:_.translations.justify,html:'<span class="fa fa-align-justify"></span>'}),j=e("<a />",{class:"richText-btn","data-command":"justifyLeft",title:_.translations.alignLeft,html:'<span class="fa fa-align-left"></span>'}),I=e("<a />",{class:"richText-btn","data-command":"justifyCenter",title:_.translations.alignCenter,html:'<span class="fa fa-align-center"></span>'}),U=e("<a />",{class:"richText-btn","data-command":"justifyRight",title:_.translations.alignRight,html:'<span class="fa fa-align-right"></span>'}),E=e("<a />",{class:"richText-btn","data-command":"insertOrderedList",title:_.translations.addOrderedList,html:'<span class="fa fa-list-ol"></span>'}),L=e("<a />",{class:"richText-btn","data-command":"insertUnorderedList",title:_.translations.addUnorderedList,html:'<span class="fa fa-list"></span>'}),M=e("<a />",{class:"richText-btn",title:_.translations.addHeading,html:'<span class="fa fa-header fa-heading"></span>'}),B=e("<a />",{class:"richText-btn",title:_.translations.addFont,html:'<span class="fa fa-font"></span>'}),R=e("<a />",{class:"richText-btn",title:_.translations.addFontColor,html:'<span class="fa fa-paint-brush"></span>'}),N=e("<a />",{class:"richText-btn",title:_.translations.addFontSize,html:'<span class="fa fa-text-height"></span>'});$btnImageUpload=e("<a />",{class:"richText-btn",title:_.translations.addImage,html:'<span class="fa fa-image" style="display:none"></span>'}),$btnVideoEmbed=e("<a />",{class:"richText-btn",title:_.translations.addVideo,html:'<span class="fa fa-video-camera fa-video" style="display:none"></span>'}),$btnFileUpload=e("<a />",{class:"richText-btn",title:_.translations.addFile,html:'<span class="fa fa-file-text-o far fa-file-alt" style="display:none"></span>'}),$btnURLs=e("<a />",{class:"richText-btn",title:_.translations.addURL,html:'<span class="fa fa-link" style="display:none"></span>'}),$btnTable=e("<a />",{class:"richText-btn",title:_.translations.addTable,html:'<span class="fa fa-table" style="display:none"></span>'}),$btnRemoveStyles=e("<a />",{class:"richText-btn","data-command":"removeFormat",title:_.translations.removeStyles,html:'<span class="fa fa-recycle" style="display:none"></span>'}),$btnCode=e("<a />",{class:"richText-btn","data-command":"toggleCode",title:_.translations.code,html:'<span class="fa fa-code" style="display:none"></span>'});var $,H=e("<div />",{class:"richText-dropdown-outer"}),z=e("<span />",{class:"richText-dropdown-close",html:'<span title="'+_.translations.close+'"><span class="fa fa-times"></span></span>'}),Q=e("<ul />",{class:"richText-dropdown"}),V=e("<div />",{class:"richText-dropdown"}),W=e("<div />",{class:"richText-form"}),q=e("<div />",{class:"richText-form-item"}),G=e("<label />"),Y=e("<input />",{type:"text"}),X=(e("<input />",{type:"file"}),e("<select />")),J=e("<button />",{text:_.translations.add,class:"btn"}),K="richText-"+Math.random().toString(36).substring(7),Z=null,ee=[];ee[K]=[];var te=[];te[K]=0;var ne=Q.clone();ne.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h1">'+_.translations.title+" #1</a>"})),ne.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h2">'+_.translations.title+" #2</a>"})),ne.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h3">'+_.translations.title+" #3</a>"})),ne.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h4">'+_.translations.title+" #4</a>"})),M.append(H.clone().append(ne.prepend(z.clone())));for(var ie=_.fontList,re=Q.clone(),oe=0;oe<ie.length;oe++)re.append(e("<li />",{html:'<a style="font-family:'+ie[oe]+';" data-command="fontName" data-option="'+ie[oe]+'">'+ie[oe]+"</a>"}));B.append(H.clone().append(re.prepend(z.clone())));for(var ae=[24,18,16,14,12],se=Q.clone(),oe=0;oe<ae.length;oe++)se.append(e("<li />",{html:'<a style="font-size:'+ae[oe]+'px;" data-command="fontSize" data-option="'+ae[oe]+'">Text '+ae[oe]+"px</a>"}));N.append(H.clone().append(se.prepend(z.clone())));var le=Q.clone();le.html(function(e){var t=[],n="";t["#FFFFFF"]=_.translations.white,t["#000000"]=_.translations.black,t["#7F6000"]=_.translations.brown,t["#938953"]=_.translations.beige,t["#1F497D"]=_.translations.darkBlue,t.blue=_.translations.blue,t["#4F81BD"]=_.translations.lightBlue,t["#953734"]=_.translations.darkRed,t.red=_.translations.red,t["#4F6128"]=_.translations.darkGreen,t.green=_.translations.green,t["#3F3151"]=_.translations.purple,t["#31859B"]=_.translations.darkTurquois,t["#4BACC6"]=_.translations.turquois,t["#E36C09"]=_.translations.darkOrange,t["#F79646"]=_.translations.orange,t["#FFFF00"]=_.translations.yellow,_.colors&&_.colors.length>0&&(t=_.colors);for(var i in t)n+='<li class="inline"><a data-command="'+e+'" data-option="'+i+'" style="text-align:left;" title="'+t[i]+'"><span class="box-color" style="background-color:'+i+'"></span></a></li>';return n}("forecolor")),R.append(H.clone().append(le.prepend(z.clone())));var ce=V.clone(),de=W.clone().attr("id","richText-URL").attr("data-editor",K);de.append(q.clone().append(G.clone().text(_.translations.url).attr("for","url")).append(Y.clone().attr("id","url"))),de.append(q.clone().append(G.clone().text(_.translations.text).attr("for","urlText")).append(Y.clone().attr("id","urlText"))),de.append(q.clone().append(G.clone().text(_.translations.openIn).attr("for","openIn")).append(X.clone().attr("id","openIn").append(e("<option />",{value:"_self",text:_.translations.sameTab})).append(e("<option />",{value:"_blank",text:_.translations.newTab})))),de.append(q.clone().append(J.clone())),ce.append(de),$btnURLs.append(H.clone().append(ce.prepend(z.clone())));var ue=V.clone(),pe=W.clone().attr("id","richText-Video").attr("data-editor",K);pe.append(q.clone().append(G.clone().text(_.translations.url).attr("for","videoURL")).append(Y.clone().attr("id","videoURL"))),pe.append(q.clone().append(G.clone().text(_.translations.size).attr("for","size")).append(X.clone().attr("id","size").append(e("<option />",{value:"responsive",text:_.translations.responsive})).append(e("<option />",{value:"640x360",text:"640x360"})).append(e("<option />",{value:"560x315",text:"560x315"})).append(e("<option />",{value:"480x270",text:"480x270"})).append(e("<option />",{value:"320x180",text:"320x180"})))),pe.append(q.clone().append(J.clone())),ue.append(pe),$btnVideoEmbed.append(H.clone().append(ue.prepend(z.clone())));var he=V.clone(),fe=W.clone().attr("id","richText-Image").attr("data-editor",K);_.imageHTML&&(e(_.imageHTML).find("#imageURL").length>0||"imageURL"===e(_.imageHTML).attr("id"))?fe.html(_.imageHTML):(fe.append(q.clone().append(G.clone().text(_.translations.imageURL).attr("for","imageURL")).append(Y.clone().attr("id","imageURL"))),fe.append(q.clone().append(G.clone().text(_.translations.align).attr("for","align")).append(X.clone().attr("id","align").append(e("<option />",{value:"left",text:_.translations.left})).append(e("<option />",{value:"center",text:_.translations.center})).append(e("<option />",{value:"right",text:_.translations.right}))))),fe.append(q.clone().append(J.clone())),he.append(fe),$btnImageUpload.append(H.clone().append(he.prepend(z.clone())));var ge=V.clone(),me=W.clone().attr("id","richText-File").attr("data-editor",K);_.fileHTML&&(e(_.fileHTML).find("#fileURL").length>0||"fileURL"===e(_.fileHTML).attr("id"))?me.html(_.fileHTML):(me.append(q.clone().append(G.clone().text(_.translations.fileURL).attr("for","fileURL")).append(Y.clone().attr("id","fileURL"))),me.append(q.clone().append(G.clone().text(_.translations.linkText).attr("for","fileText")).append(Y.clone().attr("id","fileText")))),me.append(q.clone().append(J.clone())),ge.append(me),$btnFileUpload.append(H.clone().append(ge.prepend(z.clone())));var ye=V.clone(),be=W.clone().attr("id","richText-Table").attr("data-editor",K);return be.append(q.clone().append(G.clone().text(_.translations.rows).attr("for","tableRows")).append(Y.clone().attr("id","tableRows").attr("type","number"))),be.append(q.clone().append(G.clone().text(_.translations.columns).attr("for","tableColumns")).append(Y.clone().attr("id","tableColumns").attr("type","number"))),be.append(q.clone().append(J.clone())),ye.append(be),$btnTable.append(H.clone().append(ye.prepend(z.clone()))),function(){var t,n,i="";!1!==_.useParagraph&&document.execCommand("DefaultParagraphSeparator",!1,"p"),"TEXTAREA"===k.prop("tagName")||(k.val()?(t=k.val(),n=k.prop("attributes"),e.each(n,function(){this.name&&(i+=" "+this.name+'="'+this.value+'"')}),k.replaceWith(e("<textarea"+i+' data-richtext="init">'+t+"</textarea>")),k=e('[data-richtext="init"]'),k.removeAttr("data-richtext")):k.html()?(t=k.html(),n=k.prop("attributes"),e.each(n,function(){this.name&&(i+=" "+this.name+'="'+this.value+'"')}),k.replaceWith(e("<textarea"+i+' data-richtext="init">'+t+"</textarea>")),k=e('[data-richtext="init"]'),k.removeAttr("data-richtext")):(n=k.prop("attributes"),e.each(n,function(){this.name&&(i+=" "+this.name+'="'+this.value+'"')}),k.replaceWith(e("<textarea"+i+' data-richtext="init"></textarea>')),k=e('[data-richtext="init"]'),k.removeAttr("data-richtext"))),P=e("<div />",{class:"richText"});var r=e("<div />",{class:"richText-toolbar"}),o=e("<div />",{class:"richText-editor",id:K,contenteditable:!0});if(r.append(F),!0===_.bold&&F.append(T.clone().append(D)),!0===_.italic&&F.append(T.clone().append(S)),!0===_.underline&&F.append(T.clone().append(O)),!0===_.leftAlign&&F.append(T.clone().append(j)),!0===_.centerAlign&&F.append(T.clone().append(I)),!0===_.rightAlign&&F.append(T.clone().append(U)),!0===_.justify&&F.append(T.clone().append(A)),!0===_.ol&&F.append(T.clone().append(E)),!0===_.ul&&F.append(T.clone().append(L)),!0===_.fonts&&_.fontList.length>0&&F.append(T.clone().append(B)),!0===_.fontSize&&F.append(T.clone().append(N)),!0===_.heading&&F.append(T.clone().append(M)),!0===_.fontColor&&F.append(T.clone().append(R)),!0===_.imageUpload&&F.append(T.clone().append($btnImageUpload)),!0===_.fileUpload&&F.append(T.clone().append($btnFileUpload)),!0===_.videoEmbed&&F.append(T.clone().append($btnVideoEmbed)),!0===_.urls&&F.append(T.clone().append($btnURLs)),!0===_.table&&F.append(T.clone().append($btnTable)),!0===_.removeStyles&&F.append(T.clone().append($btnRemoveStyles)),!0===_.code&&F.append(T.clone().append($btnCode)),o.html(k.val()),P.append(r),P.append(o),P.append(k.clone().hide()),k.replaceWith(P),P.append(e("<div />",{class:"richText-toolbar"}).append(e("<a />",{class:"richText-undo is-disabled",html:'<span class="fa fa-undo" style="display:none"></span>',title:_.translations.undo})).append(e("<a />",{class:"richText-redo is-disabled",html:'<span class="fa fa-repeat fa-redo" style="display:none"></span>',title:_.translations.redo})).append(e("<a />",{class:"richText-help",html:'<span class="fa fa-question-circle"></span>'}))),_.height&&_.height>0)P.children(".richText-editor, .richText-initial").css({"min-height":_.height+"px",height:_.height+"px"});else if(_.heightPercentage&&_.heightPercentage>0){var a=P.parent().innerHeight(),s=_.heightPercentage/100*a;s-=2*r.outerHeight(),s-=parseInt(P.css("margin-top")),s-=parseInt(P.css("margin-bottom")),s-=parseInt(P.find(".richText-editor").css("padding-top")),s-=parseInt(P.find(".richText-editor").css("padding-bottom")),P.children(".richText-editor, .richText-initial").css({"min-height":s+"px",height:s+"px"})}_.class&&P.addClass(_.class),_.id&&P.attr("id",_.id),C(),ee[K].push(P.find("textarea").val())}(),P.find(".richText-help").on("click",function(){var t=e(this).parents(".richText");if(t){var n=e("<div />",{class:"richText-help-popup",style:"position:absolute;top:0;right:0;bottom:0;left:0;background-color: rgba(0,0,0,0.3);"}),i=e("<div />",{style:"position:relative;margin:60px auto;padding:20px;background-color:#FAFAFA;width:70%;font-family:Calibri,Verdana,Helvetica,sans-serif;font-size:small;"}),r=e("<div />",{html:'<span id="closeHelp" style="display:block;position:absolute;top:0;right:0;padding:10px;cursor:pointer;" title="'+_.translations.close+'"><span class="fa fa-times"></span></span>'});r.append('<h3 style="margin:0;">RichText</h3>'),r.append('<hr><br>Powered by <a href="https://github.com/webfashionist/RichText" target="_blank">webfashionist/RichText</a> (Github) <br>License: <a href="https://github.com/webfashionist/RichText/blob/master/LICENSE" target="_blank">AGPL-3.0</a>'),n.append(i.append(r)),t.append(n),n.on("click","#closeHelp",function(){e(this).parents(".richText-help-popup").remove()})}}),e(document).on("click",".richText-undo, .richText-redo",function(t){var n=e(this),i=n.parents(".richText");n.hasClass("richText-undo")&&!n.hasClass("is-disabled")?p(i):n.hasClass("richText-redo")&&!n.hasClass("is-disabled")&&h(i)}),e(document).on("input change blur keydown keyup",".richText-editor",function(t){if((9===t.keyCode||"9"===t.keyCode)&&"keydown"===t.type)return t.preventDefault(),s(window,t),!1;C(),i(),c(e(this).attr("id"))}),e(document).on("contextmenu",".richText-editor",function(t){var n=e("<ul />",{class:"list-rightclick richText-list"}),i=e("<li />");e(".richText-editor").find(".richText-editNode").removeClass("richText-editNode");var r=e(t.target),o=r.parents(".richText"),a=o.find(".richText-toolbar"),s=t.pageX-o.offset().left,l=t.pageY-o.offset().top;return n.css({top:l,left:s}),"A"===r.prop("tagName")?(t.preventDefault(),n.append(i.clone().html('<span class="fa fa-link"></span>')),r.parents(".richText").append(n),n.find(".fa-link").on("click",function(){e(".list-rightclick.richText-list").remove(),r.addClass("richText-editNode");var t=a.find("#richText-URL");t.find("input#url").val(r.attr("href")),t.find("input#urlText").val(r.text()),t.find("select#openIn").val(r.attr("target")),a.find(".richText-btn").children(".fa-link").parents("li").addClass("is-selected")}),!1):"IMG"===r.prop("tagName")?(t.preventDefault(),n.append(i.clone().html('<span class="fa fa-image"></span>')),r.parents(".richText").append(n),n.find(".fa-image").on("click",function(){var t;t=r.parent("div").length>0&&"text-align:center;"===r.parent("div").attr("style")?"center":r.attr("align"),e(".list-rightclick.richText-list").remove(),r.addClass("richText-editNode");var n=a.find("#richText-Image");n.find("input#imageURL").val(r.attr("src")),n.find("select#align").val(t),a.find(".richText-btn").children(".fa-image").parents("li").addClass("is-selected")}),!1):void 0}),e(document).on("input change blur",".richText-initial",function(){!0===_.useSingleQuotes&&e(this).val(m(e(this).val()));var t=e(this).siblings(".richText-editor").attr("id");r(t),c(t)}),e(document).on("dblclick mouseup",".richText-editor",function(){c(e(this).attr("id"))}),e(document).on("click","#richText-Video button.btn",function(t){t.preventDefault();var n=e(this),r=n.parent(".richText-form-item").parent(".richText-form");if(r.attr("data-editor")===K){var o=r.find("input#videoURL").val(),s=r.find("select#size").val();if(o){var l="";l=x(o,s),l?(_.useSingleQuotes,a(K,!0),g(l),i(),r.find("input#videoURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")):(r.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:_.translations.videoURLnotSupported})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3))}else r.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:_.translations.pleaseEnterURL})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("mousedown",function(t){var n=e(t.target);if(n.hasClass("richText-list")||0!==n.parents(".richText-list").length||(e(".richText-list.list-rightclick").remove(),n.hasClass("richText-form")||0!==n.parents(".richText-form").length||e(".richText-editNode").each(function(){var t=e(this);t.removeClass("richText-editNode"),""===t.attr("class")&&t.removeAttr("class")})),"IMG"===n.prop("tagName")&&n.parents("#"+K)){startX=t.pageX,startY=t.pageY,startW=n.innerWidth(),startH=n.innerHeight();var i=(n.offset().left,n.offset().left+n.innerWidth()),r=n.offset().top+n.innerHeight(),o=(n.offset().top,!1);n.css({cursor:"default"}),startY<=r&&startY>=r-20&&startX>=i-20&&startX<=i&&(Z=n,Z.css({cursor:"nwse-resize"}),o=!0),!0!==o&&!Z||Z.data("width")?!0===o||Z?t.preventDefault():Z=null:(Z.data("width",n.parents("#"+K).innerWidth()),Z.data("height",3*n.parents("#"+K).innerHeight()),t.preventDefault())}}),e(document).mouseup(function(){Z&&Z.css({cursor:"default"}),Z=null}).mousemove(function(e){if(null!==Z){var t=Z.data("width"),n=Z.width(),r=Z.data("height"),o=Z.height();startW+e.pageX-startX<=t&&startH+e.pageY-startY<=r?(Z.innerWidth(startW+e.pageX-startX),i()):startW+e.pageX-startX<=n&&startH+e.pageY-startY<=o&&(Z.innerWidth(startW+e.pageX-startX),i())}}),e(document).on("click","#richText-URL button.btn",function(t){t.preventDefault();var n=e(this),i=n.parent(".richText-form-item").parent(".richText-form");if(i.attr("data-editor")===K){var r=i.find("input#url").val(),o=i.find("input#urlText").val(),s=i.find("#openIn").val();if(s||(s="_self"),o||(o=r),r){var l="";l=!0===_.useSingleQuotes?"<a href='"+r+"' target='"+s+"'>"+o+"</a>":'<a href="'+r+'" target="'+s+'">'+o+"</a>",a(K,!1,!0);var c=e(".richText-editNode");c.length>0&&"A"===c.prop("tagName")?(c.attr("href",r),c.attr("target",s),c.text(o),c.removeClass("richText-editNode"),""===c.attr("class")&&c.removeAttr("class")):g(l),i.find("input#url").val(""),i.find("input#urlText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else i.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:_.translations.pleaseEnterURL})),i.children(".form-item.is-error").slideDown(),setTimeout(function(){i.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Image button.btn",function(t){t.preventDefault();var n=e(this),i=n.parent(".richText-form-item").parent(".richText-form");if(i.attr("data-editor")===K){var r=i.find("#imageURL").val(),o=i.find("select#align").val();if(o||(o="center"),r){var s="";s=!0===_.useSingleQuotes?"center"===o?"<div style='text-align:center;'><img src='"+r+"'></div>":"<img src='"+r+"' align='"+o+"'>":"center"===o?'<div style="text-align:center;"><img src="'+r+'"></div>':'<img src="'+r+'" align="'+o+'">',a(K,!0);var l=e(".richText-editNode");l.length>0&&"IMG"===l.prop("tagName")?(l.attr("src",r),l.parent("div").length>0&&"text-align:center;"===l.parent("div").attr("style")&&"center"!==o?(l.unwrap("div"),l.attr("align",o)):0!==l.parent("div").length&&"text-align:center;"===l.parent("div").attr("style")||"center"!==o?l.attr("align",o):(l.wrap('<div style="text-align:center;"></div>'),l.removeAttr("align")),l.removeClass("richText-editNode"),""===l.attr("class")&&l.removeAttr("class")):g(s),i.find("input#imageURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else i.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:_.translations.pleaseSelectImage})),i.children(".form-item.is-error").slideDown(),setTimeout(function(){i.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-File button.btn",function(t){t.preventDefault();var n=e(this),i=n.parent(".richText-form-item").parent(".richText-form");if(i.attr("data-editor")===K){var r=i.find("#fileURL").val(),o=i.find("#fileText").val();if(o||(o=r),r){var s="";s=!0===_.useSingleQuotes?"<a href='"+r+"' target='_blank'>"+o+"</a>":'<a href="'+r+'" target="_blank">'+o+"</a>",a(K,!0),g(s),i.find("input#fileURL").val(""),i.find("input#fileText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else i.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:_.translations.pleaseSelectFile})),i.children(".form-item.is-error").slideDown(),setTimeout(function(){i.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Table button.btn",function(t){t.preventDefault();var n=e(this),i=n.parent(".richText-form-item").parent(".richText-form");if(i.attr("data-editor")===K){var r=i.find("input#tableRows").val(),o=i.find("input#tableColumns").val();(!r||r<=0)&&(r=2),(!o||o<=0)&&(o=2);var s="";s=!0===_.useSingleQuotes?"<table class='table-1'><tbody>":'<table class="table-1"><tbody>';for(var l=1;l<=r;l++){s+="<tr>";for(var c=1;c<=o;c++)s+="<td> </td>";s+="</tr>"}s+="</tbody></table>",a(K,!0),g(s),i.find("input#tableColumns").val(""),i.find("input#tableRows").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}}),e(document).on("click",function(t){var n=e(t.target);if(0===n.parents(".richText-toolbar").length);else if(n.hasClass("richText-dropdown-outer"))n.parent("a").parent("li").removeClass("is-selected");else if(n.find(".richText").length>0)e(".richText-toolbar li").removeClass("is-selected");else if(n.parent().hasClass("richText-dropdown-close"))e(".richText-toolbar li").removeClass("is-selected");else if(n.hasClass("richText-btn")&&e(t.target).children(".richText-dropdown-outer").length>0)if(n.parent("li").addClass("is-selected"),n.children(".fa,svg").hasClass("fa-link")){a(K,!1,!0);var i=l();n.find("input#urlText").val(""),n.find("input#url").val(""),i&&n.find("input#urlText").val(i)}else n.hasClass("fa-image")}),e(document).on("click",".richText-toolbar a[data-command]",function(t){var i=e(this),r=i.closest(".richText-toolbar"),o=r.siblings(".richText-editor"),a=o.attr("id");if(o.length>0&&a===K&&(!i.parent("li").attr("data-disable")||"false"===i.parent("li").attr("data-disable"))){t.preventDefault();var s=e(this).data("command");if("toggleCode"===s)y(o.attr("id"));else{var l=null;e(this).data("option")&&(l=e(this).data("option").toString(),l.match(/^h[1-6]$/)&&(s="heading")),n(s,l,a),"removeFormat"===s&&(o.find("*").each(function(){var t=["id","class","name","action","method","src","align","alt","title","style","webkitallowfullscreen","mozallowfullscreen","allowfullscreen","width","height","frameborder"],n=e(this),i=e.map(this.attributes,function(e){return e.name});e.each(i,function(e,i){t.indexOf(i)<0&&"data-"!==i.substr(0,5)&&n.removeAttr(i)}),"A"===n.prop("tagName")&&n.replaceWith(function(){return e("<span />",{html:e(this).html()})})}),n("formatBlock","div",a)),o.find("div:empty,p:empty,li:empty,h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty").remove(),o.find("h1,h2,h3,h4,h5,h6").unwrap("h1,h2,h3,h4,h5,h6")}}i.parents("li.is-selected").removeClass("is-selected")}),e(this)},e.fn.unRichText=function(t){function n(){o.find(".richText-toolbar").remove(),o.find(".richText-editor").remove(),r.unwrap(".richText").data("editor","richText").removeClass("richText-initial").show()}var i,r,o,a=e.extend({delay:0},t),s=e(this);!function(){if(s.hasClass("richText")?o=s:(s.hasClass("richText-initial")||s.hasClass("richText-editor"))&&(o=s.parents(".richText")),!o)return!1;i=o.find(".richText-editor"),r=o.find(".richText-initial"),parseInt(a.delay)>0?setTimeout(n,parseInt(a.delay)):n()}()}}(jQuery)},function(e,t,n){var i=n(92),r=n(81);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!0);i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(95),r=n(81);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!0);i.locals&&(e.exports=i.locals)},function(e,t){$(function(){"use strict";var e=window.console||{log:function(){}},t=$("#image"),n=$("#download"),i=$("#dataX"),r=$("#dataY"),o=$("#dataHeight"),a=$("#dataWidth"),s=$("#dataRotate"),l=$("#dataScaleX"),c=$("#dataScaleY"),d={aspectRatio:16/9,preview:".img-preview",strict:!1,cropBoxResizable:!1,crop:function(e){i.val(Math.round(e.x)),r.val(Math.round(e.y)),o.val(Math.round(e.height)),a.val(Math.round(e.width)),s.val(e.rotate),l.val(e.scaleX),c.val(e.scaleY)},built:function(){var e=$(this).cropper("getContainerData");$(this).cropper("setCropBoxData",{width:668,height:226,left:(e.width-668)/2,top:(e.height-226)/2})}};$('[data-toggle="tooltip"]').tooltip(),t.on({"build.cropper":function(t){e.log(t.type)},"built.cropper":function(t){e.log(t.type)},"cropstart.cropper":function(t){e.log(t.type,t.action)},"cropmove.cropper":function(t){e.log(t.type,t.action)},"cropend.cropper":function(t){e.log(t.type,t.action)},"crop.cropper":function(t){e.log(t.type,t.x,t.y,t.width,t.height,t.rotate,t.scaleX,t.scaleY)},"zoom.cropper":function(t){e.log(t.type,t.ratio)}}).cropper(d),$.isFunction(document.createElement("canvas").getContext)||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),void 0===document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),void 0===n[0].download&&n.addClass("disabled"),$(".docs-toggles").on("change","input",function(){var e,n,i=$(this),r=i.attr("name"),o=i.prop("type");t.data("cropper")&&("checkbox"===o?(d[r]=i.prop("checked"),e=t.cropper("getCropBoxData"),n=t.cropper("getCanvasData"),d.built=function(){t.cropper("setCropBoxData",e),t.cropper("setCanvasData",n)}):"radio"===o&&(d[r]=i.val()),t.cropper("destroy").cropper(d))}),$(".docs-buttons").on("click","[data-method]",function(){var i,r,o=$(this),a=o.data();if(!o.prop("disabled")&&!o.hasClass("disabled")&&t.data("cropper")&&a.method){if(a=$.extend({},a),void 0!==a.target&&(i=$(a.target),void 0===a.option))try{a.option=JSON.parse(i.val())}catch(t){e.log(t.message)}switch("rotate"===a.method&&t.cropper("clear"),r=t.cropper(a.method,a.option,a.secondOption),"rotate"===a.method&&t.cropper("crop"),a.method){case"scaleX":case"scaleY":$(this).data("option",-a.option);break;case"getCroppedCanvas":r&&($("#getCroppedCanvasModal").modal().find(".modal-body").html(r),n.hasClass("disabled")||n.attr("href",r.toDataURL("image/jpeg")))}if($.isPlainObject(r)&&i)try{i.val(JSON.stringify(r))}catch(t){e.log(t.message)}}}),$(document.body).on("keydown",function(e){if(t.data("cropper")&&!(this.scrollTop>300))switch(e.which){case 37:e.preventDefault(),t.cropper("move",-1,0);break;case 38:e.preventDefault(),t.cropper("move",0,-1);break;case 39:e.preventDefault(),t.cropper("move",1,0);break;case 40:e.preventDefault(),t.cropper("move",0,1)}});var u,p=$("#inputImage"),h=window.URL||window.webkitURL;h?p.change(function(){var e,n=this.files;t.data("cropper")&&n&&n.length&&(e=n[0],/^image\/\w+$/.test(e.type)?(u=h.createObjectURL(e),$(".logo-cropsec").show(),$(".themelogo-upload").hide(),t.one("built.cropper",function(){h.revokeObjectURL(u)}).cropper("reset").cropper("replace",u),p.val("")):window.alert("Please choose an image file."))}):p.prop("disabled",!0).parent().addClass("disabled"),$(".crop-cancel").click(function(){$(".logo-cropsec").hide(),$(".themelogo-upload").show()})})},function(e,t,n){var i,r,o;/*!
 * Cropper v2.3.4
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2016 Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: 2016-09-03T05:50:45.412Z
 */
!function(a){r=[n(46)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e){"use strict";function t(e){return"number"==typeof e&&!isNaN(e)}function n(e){return void 0===e}function i(e,n){var i=[];return t(n)&&i.push(n),i.slice.apply(e,i)}function r(e,t){var n=i(arguments,2);return function(){return e.apply(t,n.concat(i(arguments)))}}function o(e){var t=e.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return t&&(t[1]!==x.protocol||t[2]!==x.hostname||t[3]!==x.port)}function a(e){var t="timestamp="+(new Date).getTime();return e+(-1===e.indexOf("?")?"?":"&")+t}function s(e){return e?' crossOrigin="'+e+'"':""}function l(e,t){var n;return e.naturalWidth&&!le?t(e.naturalWidth,e.naturalHeight):(n=document.createElement("img"),n.onload=function(){t(this.width,this.height)},void(n.src=e.src))}function c(e){var n=[],i=e.rotate,r=e.scaleX,o=e.scaleY;return t(i)&&0!==i&&n.push("rotate("+i+"deg)"),t(r)&&1!==r&&n.push("scaleX("+r+")"),t(o)&&1!==o&&n.push("scaleY("+o+")"),n.length?n.join(" "):"none"}function d(e,t){var n,i,r=pe(e.degree)%180,o=(r>90?180-r:r)*Math.PI/180,a=he(o),s=fe(o),l=e.width,c=e.height,d=e.aspectRatio;return t?(n=l/(s+a/d),i=n/d):(n=l*s+c*a,i=l*a+c*s),{width:n,height:i}}function u(n,i){var r,o,a,s=e("<canvas>")[0],l=s.getContext("2d"),c=0,u=0,p=i.naturalWidth,h=i.naturalHeight,f=i.rotate,g=i.scaleX,m=i.scaleY,y=t(g)&&t(m)&&(1!==g||1!==m),b=t(f)&&0!==f,v=b||y,x=p*pe(g||1),w=h*pe(m||1);return y&&(r=x/2,o=w/2),b&&(a=d({width:x,height:w,degree:f}),x=a.width,w=a.height,r=x/2,o=w/2),s.width=x,s.height=w,v&&(c=-p/2,u=-h/2,l.save(),l.translate(r,o)),b&&l.rotate(f*Math.PI/180),y&&l.scale(g,m),l.drawImage(n,ye(c),ye(u),ye(p),ye(h)),v&&l.restore(),s}function p(t){var n=t.length,i=0,r=0;return n&&(e.each(t,function(e,t){i+=t.pageX,r+=t.pageY}),i/=n,r/=n),{pageX:i,pageY:r}}function h(e,t,n){var i,r="";for(i=t,n+=t;i<n;i++)r+=be(e.getUint8(i));return r}function f(e){var t,n,i,r,o,a,s,l,c,d,u=new k(e),p=u.byteLength;if(255===u.getUint8(0)&&216===u.getUint8(1))for(c=2;c<p;){if(255===u.getUint8(c)&&225===u.getUint8(c+1)){s=c;break}c++}if(s&&(n=s+4,i=s+10,"Exif"===h(u,n,4)&&(a=u.getUint16(i),((o=18761===a)||19789===a)&&42===u.getUint16(i+2,o)&&(r=u.getUint32(i+4,o))>=8&&(l=i+r))),l)for(p=u.getUint16(l,o),d=0;d<p;d++)if(c=l+12*d+2,274===u.getUint16(c,o)){c+=8,t=u.getUint16(c,o),le&&u.setUint16(c,1,o);break}return t}function g(e){var t,n=e.replace(X,""),i=atob(n),r=i.length,o=new C(r),a=new _(o);for(t=0;t<r;t++)a[t]=i.charCodeAt(t);return o}function m(e){var t,n=new _(e),i=n.length,r="";for(t=0;t<i;t++)r+=be(n[t]);return"data:image/jpeg;base64,"+P(r)}function y(t,n){this.$element=e(t),this.options=e.extend({},y.DEFAULTS,e.isPlainObject(n)&&n),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.wheeling=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var b=e(window),v=e(document),x=window.location,w=window.navigator,C=window.ArrayBuffer,_=window.Uint8Array,k=window.DataView,P=window.btoa,F="cropper",T="cropper-modal",D="cropper-hide",S="cropper-hidden",O="cropper-move",A="cropper-crop",j="cropper-disabled",I="mousedown touchstart pointerdown MSPointerDown",U="mousemove touchmove pointermove MSPointerMove",E="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",L="wheel mousewheel DOMMouseScroll",M="dblclick",B="load."+F,R="error."+F,N="resize."+F,$="build."+F,H="built."+F,z="cropstart."+F,Q="cropmove."+F,V="cropend."+F,W="crop."+F,q="zoom."+F,G=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,Y=/^data:/,X=/^data:([^;]+);base64,/,J=/^data:image\/jpeg.*;base64,/,K="preview",Z="action",ee="se",te="sw",ne="ne",ie="nw",re="crop",oe="move",ae="zoom",se=e.isFunction(e("<canvas>")[0].getContext),le=w&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(w.userAgent),ce=Number,de=Math.min,ue=Math.max,pe=Math.abs,he=Math.sin,fe=Math.cos,ge=Math.sqrt,me=Math.round,ye=Math.floor,be=String.fromCharCode;y.prototype={constructor:y,init:function(){var e,t=this.$element;if(t.is("img")){if(this.isImg=!0,this.originalUrl=e=t.attr("src"),!e)return;e=t.prop("src")}else t.is("canvas")&&se&&(e=t[0].toDataURL());this.load(e)},trigger:function(t,n){var i=e.Event(t,n);return this.$element.trigger(i),i},load:function(t){var n,i,r=this.options,s=this.$element;if(t&&(s.one($,r.build),!this.trigger($).isDefaultPrevented())){if(this.url=t,this.image={},!r.checkOrientation||!C)return this.clone();if(n=e.proxy(this.read,this),Y.test(t))return J.test(t)?n(g(t)):this.clone();i=new XMLHttpRequest,i.onerror=i.onabort=e.proxy(function(){this.clone()},this),i.onload=function(){n(this.response)},r.checkCrossOrigin&&o(t)&&s.prop("crossOrigin")&&(t=a(t)),i.open("get",t),i.responseType="arraybuffer",i.send()}},read:function(e){var t=this.options,n=f(e),i=this.image,r=0,o=1,a=1;if(n>1)switch(this.url=m(e),n){case 2:o=-1;break;case 3:r=-180;break;case 4:a=-1;break;case 5:r=90,a=-1;break;case 6:r=90;break;case 7:r=90,o=-1;break;case 8:r=-90}t.rotatable&&(i.rotate=r),t.scalable&&(i.scaleX=o,i.scaleY=a),this.clone()},clone:function(){var t,n,i=this.options,r=this.$element,l=this.url,c="";i.checkCrossOrigin&&o(l)&&(c=r.prop("crossOrigin"),c?t=l:(c="anonymous",t=a(l))),this.crossOrigin=c,this.crossOriginUrl=t,this.$clone=n=e("<img"+s(c)+' src="'+(t||l)+'">'),this.isImg?r[0].complete?this.start():r.one(B,e.proxy(this.start,this)):n.one(B,e.proxy(this.start,this)).one(R,e.proxy(this.stop,this)).addClass(D).insertAfter(r)},start:function(){var t=this.$element,n=this.$clone;this.isImg||(n.off(R,this.stop),t=n),l(t[0],e.proxy(function(t,n){e.extend(this.image,{naturalWidth:t,naturalHeight:n,aspectRatio:t/n}),this.isLoaded=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null},build:function(){var t,n,i,r=this.options,o=this.$element,a=this.$clone;this.isLoaded&&(this.isBuilt&&this.unbuild(),this.$container=o.parent(),this.$cropper=t=e(y.TEMPLATE),this.$canvas=t.find(".cropper-canvas").append(a),this.$dragBox=t.find(".cropper-drag-box"),this.$cropBox=n=t.find(".cropper-crop-box"),this.$viewBox=t.find(".cropper-view-box"),this.$face=i=n.find(".cropper-face"),o.addClass(S).after(t),this.isImg||a.removeClass(D),this.initPreview(),this.bind(),r.aspectRatio=ue(0,r.aspectRatio)||NaN,r.viewMode=ue(0,de(3,me(r.viewMode)))||0,r.autoCrop?(this.isCropped=!0,r.modal&&this.$dragBox.addClass(T)):n.addClass(S),r.guides||n.find(".cropper-dashed").addClass(S),r.center||n.find(".cropper-center").addClass(S),r.cropBoxMovable&&i.addClass(O).data(Z,"all"),r.highlight||i.addClass("cropper-invisible"),r.background&&t.addClass("cropper-bg"),r.cropBoxResizable||n.find(".cropper-line, .cropper-point").addClass(S),this.setDragMode(r.dragMode),this.render(),this.isBuilt=!0,this.setData(r.data),o.one(H,r.built),this.completing=setTimeout(e.proxy(function(){this.trigger(H),this.trigger(W,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isCompleted||clearTimeout(this.completing),this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var e=this.options,t=this.$element,n=this.$container,i=this.$cropper;i.addClass(S),t.removeClass(S),i.css(this.container={width:ue(n.width(),ce(e.minContainerWidth)||200),height:ue(n.height(),ce(e.minContainerHeight)||100)}),t.addClass(S),i.removeClass(S)},initCanvas:function(){var t,n=this.options.viewMode,i=this.container,r=i.width,o=i.height,a=this.image,s=a.naturalWidth,l=a.naturalHeight,c=90===pe(a.rotate),d=c?l:s,u=c?s:l,p=d/u,h=r,f=o;o*p>r?3===n?h=o*p:f=r/p:3===n?f=r/p:h=o*p,t={naturalWidth:d,naturalHeight:u,aspectRatio:p,width:h,height:f},t.oldLeft=t.left=(r-h)/2,t.oldTop=t.top=(o-f)/2,this.canvas=t,this.isLimited=1===n||2===n,this.limitCanvas(!0,!0),this.initialImage=e.extend({},a),this.initialCanvas=e.extend({},t)},limitCanvas:function(e,t){var n,i,r,o,a=this.options,s=a.viewMode,l=this.container,c=l.width,d=l.height,u=this.canvas,p=u.aspectRatio,h=this.cropBox,f=this.isCropped&&h;e&&(n=ce(a.minCanvasWidth)||0,i=ce(a.minCanvasHeight)||0,s&&(s>1?(n=ue(n,c),i=ue(i,d),3===s&&(i*p>n?n=i*p:i=n/p)):n?n=ue(n,f?h.width:0):i?i=ue(i,f?h.height:0):f&&(n=h.width,i=h.height,i*p>n?n=i*p:i=n/p)),n&&i?i*p>n?i=n/p:n=i*p:n?i=n/p:i&&(n=i*p),u.minWidth=n,u.minHeight=i,u.maxWidth=1/0,u.maxHeight=1/0),t&&(s?(r=c-u.width,o=d-u.height,u.minLeft=de(0,r),u.minTop=de(0,o),u.maxLeft=ue(0,r),u.maxTop=ue(0,o),f&&this.isLimited&&(u.minLeft=de(h.left,h.left+h.width-u.width),u.minTop=de(h.top,h.top+h.height-u.height),u.maxLeft=h.left,u.maxTop=h.top,2===s&&(u.width>=c&&(u.minLeft=de(0,r),u.maxLeft=ue(0,r)),u.height>=d&&(u.minTop=de(0,o),u.maxTop=ue(0,o))))):(u.minLeft=-u.width,u.minTop=-u.height,u.maxLeft=c,u.maxTop=d))},renderCanvas:function(e){var t,n,i=this.canvas,r=this.image,o=r.rotate,a=r.naturalWidth,s=r.naturalHeight;this.isRotated&&(this.isRotated=!1,n=d({width:r.width,height:r.height,degree:o}),(t=n.width/n.height)!==i.aspectRatio&&(i.left-=(n.width-i.width)/2,i.top-=(n.height-i.height)/2,i.width=n.width,i.height=n.height,i.aspectRatio=t,i.naturalWidth=a,i.naturalHeight=s,o%180&&(n=d({width:a,height:s,degree:o}),i.naturalWidth=n.width,i.naturalHeight=n.height),this.limitCanvas(!0,!1))),(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=de(ue(i.width,i.minWidth),i.maxWidth),i.height=de(ue(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.oldLeft=i.left=de(ue(i.left,i.minLeft),i.maxLeft),i.oldTop=i.top=de(ue(i.top,i.minTop),i.maxTop),this.$canvas.css({width:i.width,height:i.height,left:i.left,top:i.top}),this.renderImage(),this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0),e&&this.output()},renderImage:function(t){var n,i=this.canvas,r=this.image;r.rotate&&(n=d({width:i.width,height:i.height,degree:r.rotate,aspectRatio:r.aspectRatio},!0)),e.extend(r,n?{width:n.width,height:n.height,left:(i.width-n.width)/2,top:(i.height-n.height)/2}:{width:i.width,height:i.height,left:0,top:0}),this.$clone.css({width:r.width,height:r.height,marginLeft:r.left,marginTop:r.top,transform:c(r)}),t&&this.output()},initCropBox:function(){var t=this.options,n=this.canvas,i=t.aspectRatio,r=ce(t.autoCropArea)||.8,o={width:n.width,height:n.height};i&&(n.height*i>n.width?o.height=o.width/i:o.width=o.height*i),this.cropBox=o,this.limitCropBox(!0,!0),o.width=de(ue(o.width,o.minWidth),o.maxWidth),o.height=de(ue(o.height,o.minHeight),o.maxHeight),o.width=ue(o.minWidth,o.width*r),o.height=ue(o.minHeight,o.height*r),o.oldLeft=o.left=n.left+(n.width-o.width)/2,o.oldTop=o.top=n.top+(n.height-o.height)/2,this.initialCropBox=e.extend({},o)},limitCropBox:function(e,t){var n,i,r,o,a=this.options,s=a.aspectRatio,l=this.container,c=l.width,d=l.height,u=this.canvas,p=this.cropBox,h=this.isLimited;e&&(n=ce(a.minCropBoxWidth)||0,i=ce(a.minCropBoxHeight)||0,n=de(n,c),i=de(i,d),r=de(c,h?u.width:c),o=de(d,h?u.height:d),s&&(n&&i?i*s>n?i=n/s:n=i*s:n?i=n/s:i&&(n=i*s),o*s>r?o=r/s:r=o*s),p.minWidth=de(n,r),p.minHeight=de(i,o),p.maxWidth=r,p.maxHeight=o),t&&(h?(p.minLeft=ue(0,u.left),p.minTop=ue(0,u.top),p.maxLeft=de(c,u.left+u.width)-p.width,p.maxTop=de(d,u.top+u.height)-p.height):(p.minLeft=0,p.minTop=0,p.maxLeft=c-p.width,p.maxTop=d-p.height))},renderCropBox:function(){var e=this.options,t=this.container,n=t.width,i=t.height,r=this.cropBox;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=de(ue(r.width,r.minWidth),r.maxWidth),r.height=de(ue(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.oldLeft=r.left=de(ue(r.left,r.minLeft),r.maxLeft),r.oldTop=r.top=de(ue(r.top,r.minTop),r.maxTop),e.movable&&e.cropBoxMovable&&this.$face.data(Z,r.width===n&&r.height===i?oe:"all"),this.$cropBox.css({width:r.width,height:r.height,left:r.left,top:r.top}),this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){this.preview(),this.isCompleted&&this.trigger(W,this.getData())},initPreview:function(){var t,n=s(this.crossOrigin),i=n?this.crossOriginUrl:this.url;this.$preview=e(this.options.preview),this.$clone2=t=e("<img"+n+' src="'+i+'">'),this.$viewBox.html(t),this.$preview.each(function(){var t=e(this);t.data(K,{width:t.width(),height:t.height(),html:t.html()}),t.html("<img"+n+' src="'+i+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var t=e(this),n=t.data(K);t.css({width:n.width,height:n.height}).html(n.html).removeData(K)})},preview:function(){var t=this.image,n=this.canvas,i=this.cropBox,r=i.width,o=i.height,a=t.width,s=t.height,l=i.left-n.left-t.left,d=i.top-n.top-t.top;this.isCropped&&!this.isDisabled&&(this.$clone2.css({width:a,height:s,marginLeft:-l,marginTop:-d,transform:c(t)}),this.$preview.each(function(){var n=e(this),i=n.data(K),u=i.width,p=i.height,h=u,f=p,g=1;r&&(g=u/r,f=o*g),o&&f>p&&(g=p/o,h=r*g,f=p),n.css({width:h,height:f}).find("img").css({width:a*g,height:s*g,marginLeft:-l*g,marginTop:-d*g,transform:c(t)})}))},bind:function(){var t=this.options,n=this.$element,i=this.$cropper;e.isFunction(t.cropstart)&&n.on(z,t.cropstart),e.isFunction(t.cropmove)&&n.on(Q,t.cropmove),e.isFunction(t.cropend)&&n.on(V,t.cropend),e.isFunction(t.crop)&&n.on(W,t.crop),e.isFunction(t.zoom)&&n.on(q,t.zoom),i.on(I,e.proxy(this.cropStart,this)),t.zoomable&&t.zoomOnWheel&&i.on(L,e.proxy(this.wheel,this)),t.toggleDragModeOnDblclick&&i.on(M,e.proxy(this.dblclick,this)),v.on(U,this._cropMove=r(this.cropMove,this)).on(E,this._cropEnd=r(this.cropEnd,this)),t.responsive&&b.on(N,this._resize=r(this.resize,this))},unbind:function(){var t=this.options,n=this.$element,i=this.$cropper;e.isFunction(t.cropstart)&&n.off(z,t.cropstart),e.isFunction(t.cropmove)&&n.off(Q,t.cropmove),e.isFunction(t.cropend)&&n.off(V,t.cropend),e.isFunction(t.crop)&&n.off(W,t.crop),e.isFunction(t.zoom)&&n.off(q,t.zoom),i.off(I,this.cropStart),t.zoomable&&t.zoomOnWheel&&i.off(L,this.wheel),t.toggleDragModeOnDblclick&&i.off(M,this.dblclick),v.off(U,this._cropMove).off(E,this._cropEnd),t.responsive&&b.off(N,this._resize)},resize:function(){var t,n,i,r=this.options.restore,o=this.$container,a=this.container;!this.isDisabled&&a&&(1===(i=o.width()/a.width)&&o.height()===a.height||(r&&(t=this.getCanvasData(),n=this.getCropBoxData()),this.render(),r&&(this.setCanvasData(e.each(t,function(e,n){t[e]=n*i})),this.setCropBoxData(e.each(n,function(e,t){n[e]=t*i})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(A)?this.setDragMode(oe):this.setDragMode(re))},wheel:function(t){var n=t.originalEvent||t,i=ce(this.options.wheelZoomRatio)||.1,r=1;this.isDisabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(e.proxy(function(){this.wheeling=!1},this),50),n.deltaY?r=n.deltaY>0?1:-1:n.wheelDelta?r=-n.wheelDelta/120:n.detail&&(r=n.detail>0?1:-1),this.zoom(-r*i,t)))},cropStart:function(t){var n,i,r=this.options,o=t.originalEvent,a=o&&o.touches,s=t;if(!this.isDisabled){if(a){if((n=a.length)>1){if(!r.zoomable||!r.zoomOnTouch||2!==n)return;s=a[1],this.startX2=s.pageX,this.startY2=s.pageY,i=ae}s=a[0]}if(i=i||e(s.target).data(Z),G.test(i)){if(this.trigger(z,{originalEvent:o,action:i}).isDefaultPrevented())return;t.preventDefault(),this.action=i,this.cropping=!1,this.startX=s.pageX||o&&o.pageX,this.startY=s.pageY||o&&o.pageY,i===re&&(this.cropping=!0,this.$dragBox.addClass(T))}}},cropMove:function(e){var t,n=this.options,i=e.originalEvent,r=i&&i.touches,o=e,a=this.action;if(!this.isDisabled){if(r){if((t=r.length)>1){if(!n.zoomable||!n.zoomOnTouch||2!==t)return;o=r[1],this.endX2=o.pageX,this.endY2=o.pageY}o=r[0]}if(a){if(this.trigger(Q,{originalEvent:i,action:a}).isDefaultPrevented())return;e.preventDefault(),this.endX=o.pageX||i&&i.pageX,this.endY=o.pageY||i&&i.pageY,this.change(o.shiftKey,a===ae?e:null)}}},cropEnd:function(e){var t=e.originalEvent,n=this.action;this.isDisabled||n&&(e.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(T,this.isCropped&&this.options.modal)),this.action="",this.trigger(V,{originalEvent:t,action:n}))},change:function(e,t){var n,i,r=this.options,o=r.aspectRatio,a=this.action,s=this.container,l=this.canvas,c=this.cropBox,d=c.width,u=c.height,p=c.left,h=c.top,f=p+d,g=h+u,m=0,y=0,b=s.width,v=s.height,x=!0;switch(!o&&e&&(o=d&&u?d/u:1),this.isLimited&&(m=c.minLeft,y=c.minTop,b=m+de(s.width,l.width,l.left+l.width),v=y+de(s.height,l.height,l.top+l.height)),i={x:this.endX-this.startX,y:this.endY-this.startY},o&&(i.X=i.y*o,i.Y=i.x/o),a){case"all":p+=i.x,h+=i.y;break;case"e":if(i.x>=0&&(f>=b||o&&(h<=y||g>=v))){x=!1;break}d+=i.x,o&&(u=d/o,h-=i.Y/2),d<0&&(a="w",d=0);break;case"n":if(i.y<=0&&(h<=y||o&&(p<=m||f>=b))){x=!1;break}u-=i.y,h+=i.y,o&&(d=u*o,p+=i.X/2),u<0&&(a="s",u=0);break;case"w":if(i.x<=0&&(p<=m||o&&(h<=y||g>=v))){x=!1;break}d-=i.x,p+=i.x,o&&(u=d/o,h+=i.Y/2),d<0&&(a="e",d=0);break;case"s":if(i.y>=0&&(g>=v||o&&(p<=m||f>=b))){x=!1;break}u+=i.y,o&&(d=u*o,p-=i.X/2),u<0&&(a="n",u=0);break;case ne:if(o){if(i.y<=0&&(h<=y||f>=b)){x=!1;break}u-=i.y,h+=i.y,d=u*o}else i.x>=0?f<b?d+=i.x:i.y<=0&&h<=y&&(x=!1):d+=i.x,i.y<=0?h>y&&(u-=i.y,h+=i.y):(u-=i.y,h+=i.y);d<0&&u<0?(a=te,u=0,d=0):d<0?(a=ie,d=0):u<0&&(a=ee,u=0);break;case ie:if(o){if(i.y<=0&&(h<=y||p<=m)){x=!1;break}u-=i.y,h+=i.y,d=u*o,p+=i.X}else i.x<=0?p>m?(d-=i.x,p+=i.x):i.y<=0&&h<=y&&(x=!1):(d-=i.x,p+=i.x),i.y<=0?h>y&&(u-=i.y,h+=i.y):(u-=i.y,h+=i.y);d<0&&u<0?(a=ee,u=0,d=0):d<0?(a=ne,d=0):u<0&&(a=te,u=0);break;case te:if(o){if(i.x<=0&&(p<=m||g>=v)){x=!1;break}d-=i.x,p+=i.x,u=d/o}else i.x<=0?p>m?(d-=i.x,p+=i.x):i.y>=0&&g>=v&&(x=!1):(d-=i.x,p+=i.x),i.y>=0?g<v&&(u+=i.y):u+=i.y;d<0&&u<0?(a=ne,u=0,d=0):d<0?(a=ee,d=0):u<0&&(a=ie,u=0);break;case ee:if(o){if(i.x>=0&&(f>=b||g>=v)){x=!1;break}d+=i.x,u=d/o}else i.x>=0?f<b?d+=i.x:i.y>=0&&g>=v&&(x=!1):d+=i.x,i.y>=0?g<v&&(u+=i.y):u+=i.y;d<0&&u<0?(a=ie,u=0,d=0):d<0?(a=te,d=0):u<0&&(a=ne,u=0);break;case oe:this.move(i.x,i.y),x=!1;break;case ae:this.zoom(function(e,t,n,i){var r=ge(e*e+t*t);return(ge(n*n+i*i)-r)/r}(pe(this.startX-this.startX2),pe(this.startY-this.startY2),pe(this.endX-this.endX2),pe(this.endY-this.endY2)),t),this.startX2=this.endX2,this.startY2=this.endY2,x=!1;break;case re:if(!i.x||!i.y){x=!1;break}n=this.$cropper.offset(),p=this.startX-n.left,h=this.startY-n.top,d=c.minWidth,u=c.minHeight,i.x>0?a=i.y>0?ee:ne:i.x<0&&(p-=d,a=i.y>0?te:ie),i.y<0&&(h-=u),this.isCropped||(this.$cropBox.removeClass(S),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0))}x&&(c.width=d,c.height=u,c.left=p,c.top=h,this.action=a,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},crop:function(){this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(T),this.$cropBox.removeClass(S)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.isBuilt&&!this.isDisabled&&(this.image=e.extend({},this.initialImage),this.canvas=e.extend({},this.initialCanvas),this.cropBox=e.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){this.isCropped&&!this.isDisabled&&(e.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(T),this.$cropBox.addClass(S))},replace:function(e,t){!this.isDisabled&&e&&(this.isImg&&this.$element.attr("src",e),t?(this.url=e,this.$clone.attr("src",e),this.isBuilt&&this.$preview.find("img").add(this.$clone2).attr("src",e)):(this.isImg&&(this.isReplaced=!0),this.options.data=null,this.load(e)))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(j))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(j))},destroy:function(){var e=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&e.attr("src",this.originalUrl),this.unbuild(),e.removeClass(S)):this.isImg?e.off(B,this.start):this.$clone&&this.$clone.remove(),e.removeData(F)},move:function(e,t){var i=this.canvas;this.moveTo(n(e)?e:i.left+ce(e),n(t)?t:i.top+ce(t))},moveTo:function(e,i){var r=this.canvas,o=!1;n(i)&&(i=e),e=ce(e),i=ce(i),this.isBuilt&&!this.isDisabled&&this.options.movable&&(t(e)&&(r.left=e,o=!0),t(i)&&(r.top=i,o=!0),o&&this.renderCanvas(!0))},zoom:function(e,t){var n=this.canvas;e=ce(e),e=e<0?1/(1-e):1+e,this.zoomTo(n.width*e/n.naturalWidth,t)},zoomTo:function(e,t){var n,i,r,o,a,s=this.options,l=this.canvas,c=l.width,d=l.height,u=l.naturalWidth,h=l.naturalHeight;if((e=ce(e))>=0&&this.isBuilt&&!this.isDisabled&&s.zoomable){if(i=u*e,r=h*e,t&&(n=t.originalEvent),this.trigger(q,{originalEvent:n,oldRatio:c/u,ratio:i/u}).isDefaultPrevented())return;n?(o=this.$cropper.offset(),a=n.touches?p(n.touches):{pageX:t.pageX||n.pageX||0,pageY:t.pageY||n.pageY||0},l.left-=(i-c)*((a.pageX-o.left-l.left)/c),l.top-=(r-d)*((a.pageY-o.top-l.top)/d)):(l.left-=(i-c)/2,l.top-=(r-d)/2),l.width=i,l.height=r,this.renderCanvas(!0)}},rotate:function(e){this.rotateTo((this.image.rotate||0)+ce(e))},rotateTo:function(e){e=ce(e),t(e)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=e%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(e,i){var r=this.image,o=!1;n(i)&&(i=e),e=ce(e),i=ce(i),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(t(e)&&(r.scaleX=e,o=!0),t(i)&&(r.scaleY=i,o=!0),o&&this.renderImage(!0))},scaleX:function(e){var n=this.image.scaleY;this.scale(e,t(n)?n:1)},scaleY:function(e){var n=this.image.scaleX;this.scale(t(n)?n:1,e)},getData:function(t){var n,i,r=this.options,o=this.image,a=this.canvas,s=this.cropBox;return this.isBuilt&&this.isCropped?(i={x:s.left-a.left,y:s.top-a.top,width:s.width,height:s.height},n=o.width/o.naturalWidth,e.each(i,function(e,r){r/=n,i[e]=t?me(r):r})):i={x:0,y:0,width:0,height:0},r.rotatable&&(i.rotate=o.rotate||0),r.scalable&&(i.scaleX=o.scaleX||1,i.scaleY=o.scaleY||1),i},setData:function(n){var i,r,o,a=this.options,s=this.image,l=this.canvas,c={};e.isFunction(n)&&(n=n.call(this.element)),this.isBuilt&&!this.isDisabled&&e.isPlainObject(n)&&(a.rotatable&&t(n.rotate)&&n.rotate!==s.rotate&&(s.rotate=n.rotate,this.isRotated=i=!0),a.scalable&&(t(n.scaleX)&&n.scaleX!==s.scaleX&&(s.scaleX=n.scaleX,r=!0),t(n.scaleY)&&n.scaleY!==s.scaleY&&(s.scaleY=n.scaleY,r=!0)),i?this.renderCanvas():r&&this.renderImage(),o=s.width/s.naturalWidth,t(n.x)&&(c.left=n.x*o+l.left),t(n.y)&&(c.top=n.y*o+l.top),t(n.width)&&(c.width=n.width*o),t(n.height)&&(c.height=n.height*o),this.setCropBoxData(c))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var t=this.canvas,n={};return this.isBuilt&&e.each(["left","top","width","height","naturalWidth","naturalHeight"],function(e,i){n[i]=t[i]}),n},setCanvasData:function(n){var i=this.canvas,r=i.aspectRatio;e.isFunction(n)&&(n=n.call(this.$element)),this.isBuilt&&!this.isDisabled&&e.isPlainObject(n)&&(t(n.left)&&(i.left=n.left),t(n.top)&&(i.top=n.top),t(n.width)?(i.width=n.width,i.height=n.width/r):t(n.height)&&(i.height=n.height,i.width=n.height*r),this.renderCanvas(!0))},getCropBoxData:function(){var e,t=this.cropBox;return this.isBuilt&&this.isCropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(n){var i,r,o=this.cropBox,a=this.options.aspectRatio;e.isFunction(n)&&(n=n.call(this.$element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&e.isPlainObject(n)&&(t(n.left)&&(o.left=n.left),t(n.top)&&(o.top=n.top),t(n.width)&&(i=!0,o.width=n.width),t(n.height)&&(r=!0,o.height=n.height),a&&(i?o.height=o.width/a:r&&(o.width=o.height*a)),this.renderCropBox())},getCroppedCanvas:function(t){var n,i,r,o,a,s,l,c,d,p,h;if(this.isBuilt&&se)return this.isCropped?(e.isPlainObject(t)||(t={}),h=this.getData(),n=h.width,i=h.height,c=n/i,e.isPlainObject(t)&&(a=t.width,s=t.height,a?(s=a/c,l=a/n):s&&(a=s*c,l=s/i)),r=ye(a||n),o=ye(s||i),d=e("<canvas>")[0],d.width=r,d.height=o,p=d.getContext("2d"),t.fillColor&&(p.fillStyle=t.fillColor,p.fillRect(0,0,r,o)),p.drawImage.apply(p,function(){var e,t,r,o,a,s,c=u(this.$clone[0],this.image),d=c.width,p=c.height,f=this.canvas,g=[c],m=h.x+f.naturalWidth*(pe(h.scaleX||1)-1)/2,y=h.y+f.naturalHeight*(pe(h.scaleY||1)-1)/2;return m<=-n||m>d?m=e=r=a=0:m<=0?(r=-m,m=0,e=a=de(d,n+m)):m<=d&&(r=0,e=a=de(n,d-m)),e<=0||y<=-i||y>p?y=t=o=s=0:y<=0?(o=-y,y=0,t=s=de(p,i+y)):y<=p&&(o=0,t=s=de(i,p-y)),g.push(ye(m),ye(y),ye(e),ye(t)),l&&(r*=l,o*=l,a*=l,s*=l),a>0&&s>0&&g.push(ye(r),ye(o),ye(a),ye(s)),g}.call(this)),d):u(this.$clone[0],this.image)},setAspectRatio:function(e){var t=this.options;this.isDisabled||n(e)||(t.aspectRatio=ue(0,e)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(e){var t,n,i=this.options;this.isLoaded&&!this.isDisabled&&(t=e===re,n=i.movable&&e===oe,e=t||n?e:"none",this.$dragBox.data(Z,e).toggleClass(A,t).toggleClass(O,n),i.cropBoxMovable||this.$face.data(Z,e).toggleClass(A,t).toggleClass(O,n))}},y.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},y.setDefaults=function(t){e.extend(y.DEFAULTS,t)},y.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',y.other=e.fn.cropper,e.fn.cropper=function(t){var r,o=i(arguments,1);return this.each(function(){var n,i,a=e(this),s=a.data(F);if(!s){if(/destroy/.test(t))return;n=e.extend({},a.data(),e.isPlainObject(t)&&t),a.data(F,s=new y(this,n))}"string"==typeof t&&e.isFunction(i=s[t])&&(r=i.apply(s,o))}),n(r)?this:r},e.fn.cropper.Constructor=y,e.fn.cropper.setDefaults=y.setDefaults,e.fn.cropper.noConflict=function(){return e.fn.cropper=y.other,this}})},function(e,t,n){var i=n(96),r=n(81);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!0);i.locals&&(e.exports=i.locals)},function(e,t,n){var i,r,o;/*!
 * Datepicker for Bootstrap v1.6.4 (https://github.com/eternicode/bootstrap-datepicker)
 *
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 * Licensed under the Apache License v2.0 (http://www.apache.org/licenses/LICENSE-2.0)
 */
!function(a){r=[n(46)],i=a,void 0!==(o="function"==typeof i?i.apply(t,r):i)&&(e.exports=o)}(function(e,t){function n(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return n(e.getFullYear(),e.getMonth(),e.getDate())}function r(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function o(e){return function(){return this[e].apply(this,arguments)}}function a(e){return e&&!isNaN(e.getTime())}function s(t,n){function i(e,t){return t.toLowerCase()}var r,o=e(t).data(),a={},s=new RegExp("^"+n.toLowerCase()+"([A-Z])");n=new RegExp("^"+n.toLowerCase());for(var l in o)n.test(l)&&(r=l.replace(s,i),a[r]=o[l]);return a}function l(t){var n={};if(m[t]||(t=t.split("-")[0],m[t])){var i=m[t];return e.each(g,function(e,t){t in i&&(n[t]=i[t])}),n}}var c=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=e&&e.valueOf(),n=0,i=this.length;i>n;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){t&&(e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var e=new c;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),d=function(t,n){e(t).data("datepicker",this),this._process_options(n),this.dates=new c,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=e(t),this.isInput=this.element.is("input"),this.inputField=this.isInput?this.element:this.element.find("input"),this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.hasInput=this.component&&this.inputField.length,this.component&&0===this.component.length&&(this.component=!1),this.isInline=!this.component&&this.element.is("div"),this.picker=e(y.template),this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow),this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};d.prototype={constructor:d,_resolveViewName:function(e,n){return 0===e||"days"===e||"month"===e?0:1===e||"months"===e||"year"===e?1:2===e||"years"===e||"decade"===e?2:3===e||"decades"===e||"century"===e?3:4===e||"centuries"===e||"millennium"===e?4:n!==t&&n},_check_template:function(n){try{if(n===t||""===n)return!1;if((n.match(/[<>]/g)||[]).length<=0)return!0;return e(n).length>0}catch(e){return!1}},_process_options:function(t){this._o=e.extend({},this._o,t);var r=this.o=e.extend({},this._o),o=r.language;m[o]||(o=o.split("-")[0],m[o]||(o=f.language)),r.language=o,r.startView=this._resolveViewName(r.startView,0),r.minViewMode=this._resolveViewName(r.minViewMode,0),r.maxViewMode=this._resolveViewName(r.maxViewMode,4),r.startView=Math.min(r.startView,r.maxViewMode),r.startView=Math.max(r.startView,r.minViewMode),!0!==r.multidate&&(r.multidate=Number(r.multidate)||!1,!1!==r.multidate&&(r.multidate=Math.max(0,r.multidate))),r.multidateSeparator=String(r.multidateSeparator),r.weekStart%=7,r.weekEnd=(r.weekStart+6)%7;var a=y.parseFormat(r.format);r.startDate!==-1/0&&(r.startDate?r.startDate instanceof Date?r.startDate=this._local_to_utc(this._zero_time(r.startDate)):r.startDate=y.parseDate(r.startDate,a,r.language,r.assumeNearbyYear):r.startDate=-1/0),r.endDate!==1/0&&(r.endDate?r.endDate instanceof Date?r.endDate=this._local_to_utc(this._zero_time(r.endDate)):r.endDate=y.parseDate(r.endDate,a,r.language,r.assumeNearbyYear):r.endDate=1/0),r.daysOfWeekDisabled=r.daysOfWeekDisabled||[],e.isArray(r.daysOfWeekDisabled)||(r.daysOfWeekDisabled=r.daysOfWeekDisabled.split(/[,\s]*/)),r.daysOfWeekDisabled=e.map(r.daysOfWeekDisabled,function(e){return parseInt(e,10)}),r.daysOfWeekHighlighted=r.daysOfWeekHighlighted||[],e.isArray(r.daysOfWeekHighlighted)||(r.daysOfWeekHighlighted=r.daysOfWeekHighlighted.split(/[,\s]*/)),r.daysOfWeekHighlighted=e.map(r.daysOfWeekHighlighted,function(e){return parseInt(e,10)}),r.datesDisabled=r.datesDisabled||[],e.isArray(r.datesDisabled)||(r.datesDisabled=[r.datesDisabled]),r.datesDisabled=e.map(r.datesDisabled,function(e){return y.parseDate(e,a,r.language,r.assumeNearbyYear)});var s=String(r.orientation).toLowerCase().split(/\s+/g),l=r.orientation.toLowerCase();if(s=e.grep(s,function(e){return/^auto|left|right|top|bottom$/.test(e)}),r.orientation={x:"auto",y:"auto"},l&&"auto"!==l)if(1===s.length)switch(s[0]){case"top":case"bottom":r.orientation.y=s[0];break;case"left":case"right":r.orientation.x=s[0]}else l=e.grep(s,function(e){return/^left|right$/.test(e)}),r.orientation.x=l[0]||"auto",l=e.grep(s,function(e){return/^top|bottom$/.test(e)}),r.orientation.y=l[0]||"auto";if(r.defaultViewDate){var c=r.defaultViewDate.year||(new Date).getFullYear(),d=r.defaultViewDate.month||0,u=r.defaultViewDate.day||1;r.defaultViewDate=n(c,d,u)}else r.defaultViewDate=i()},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var n,i,r,o=0;o<e.length;o++)n=e[o][0],2===e[o].length?(i=t,r=e[o][1]):3===e[o].length&&(i=e[o][1],r=e[o][2]),n.on(r,i)},_unapplyEvents:function(e){for(var n,i,r,o=0;o<e.length;o++)n=e[o][0],2===e[o].length?(r=t,i=e[o][1]):3===e[o].length&&(r=e[o][1],i=e[o][2]),n.off(i,r)},_buildEvents:function(){var t={keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this),paste:e.proxy(this.paste,this)};!0===this.o.showOnFocus&&(t.focus=e.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.hasInput?this._events=[[this.inputField,t],[this.component,{click:e.proxy(this.show,this)}]]:this._events=[[this.element,{click:e.proxy(this.show,this),keydown:e.proxy(this.keydown,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":e.proxy(function(e){this.update(e.date)},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var i=n||this.dates.get(-1),r=this._utc_to_local(i);this.element.trigger({type:t,date:r,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return y.formatDate(n,t,this.o.language)},this)})},show:function(){return this.inputField.prop("disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&e(this.element).blur(),this)},hide:function(){return this.isInline||!this.picker.is(":visible")?this:(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide"),this)},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var n;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&-1!==e.inArray("text/plain",t.originalEvent.clipboardData.types))n=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;n=window.clipboardData.getData("Text")}this.setDate(n),this.update(),t.preventDefault()},_utc_to_local:function(e){return e&&new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var e=this.dates.get(-1);return void 0!==e?new Date(e):null},clearDates:function(){this.inputField&&this.inputField.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:o("setDates"),setUTCDate:o("setUTCDates"),remove:o("destroy"),setValue:function(){var e=this.getFormattedDate();return this.inputField.val(e),this},getFormattedDate:function(n){n===t&&(n=this.o.format);var i=this.o.language;return e.map(this.dates,function(e){return y.formatDate(e,n,i)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(e){return this._process_options({startDate:e}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(e){return this._process_options({endDate:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(e){return this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(e){return this._process_options({daysOfWeekHighlighted:e}),this.update(),this},setDatesDisabled:function(e){this._process_options({datesDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var t=this.picker.outerWidth(),n=this.picker.outerHeight(),i=e(this.o.container),r=i.width(),o="body"===this.o.container?e(document).scrollTop():i.scrollTop(),a=i.offset(),s=[];this.element.parents().each(function(){var t=e(this).css("z-index");"auto"!==t&&0!==t&&s.push(parseInt(t))});var l=Math.max.apply(Math,s)+this.o.zIndexOffset,c=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),u=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),p=c.left-a.left,h=c.top-a.top;"body"!==this.o.container&&(h+=o),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(p-=t-u)):c.left<0?(this.picker.addClass("datepicker-orient-left"),p-=c.left-10):p+t>r?(this.picker.addClass("datepicker-orient-right"),p+=u-t):this.picker.addClass("datepicker-orient-left");var f,g=this.o.orientation.y;if("auto"===g&&(f=-o+h-n,g=0>f?"bottom":"top"),this.picker.addClass("datepicker-orient-"+g),"top"===g?h-=n+parseInt(this.picker.css("padding-top")):h+=d,this.o.rtl){var m=r-(p+u);this.picker.css({top:h,right:m,zIndex:l})}else this.picker.css({top:h,left:p,zIndex:l});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var t=this.dates.copy(),n=[],i=!1;return arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),i=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.inputField.val(),n=n&&this.o.multidate?n.split(this.o.multidateSeparator):[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return y.parseDate(e,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),n=e.grep(n,e.proxy(function(e){return!this.dateWithinRange(e)||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,i?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var t=this.o.weekStart,n="<tr>";for(this.o.calendarWeeks&&(this.picker.find(".datepicker-days .datepicker-switch").attr("colspan",function(e,t){return parseInt(t)+1}),n+='<th class="cw">&#160;</th>');t<this.o.weekStart+7;)n+='<th class="dow',e.inArray(t,this.o.daysOfWeekDisabled)>-1&&(n+=" disabled"),n+='">'+m[this.o.language].daysMin[t++%7]+"</th>";n+="</tr>",this.picker.find(".datepicker-days thead").append(n)},fillMonths:function(){for(var e=this._utc_to_local(this.viewDate),t="",n=0;12>n;){t+='<span class="month'+(e&&e.getMonth()===n?" focused":"")+'">'+m[this.o.language].monthsShort[n++]+"</span>"}this.picker.find(".datepicker-months td").html(t)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var n=[],i=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),o=new Date;return t.getUTCFullYear()<i||t.getUTCFullYear()===i&&t.getUTCMonth()<r?n.push("old"):(t.getUTCFullYear()>i||t.getUTCFullYear()===i&&t.getUTCMonth()>r)&&n.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===o.getFullYear()&&t.getUTCMonth()===o.getMonth()&&t.getUTCDate()===o.getDate()&&n.push("today"),-1!==this.dates.contains(t)&&n.push("active"),this.dateWithinRange(t)||n.push("disabled"),this.dateIsDisabled(t)&&n.push("disabled","disabled-date"),-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekHighlighted)&&n.push("highlighted"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),-1!==e.inArray(t.valueOf(),this.range)&&n.push("selected"),t.valueOf()===this.range[0]&&n.push("range-start"),t.valueOf()===this.range[this.range.length-1]&&n.push("range-end")),n},_fill_yearsView:function(n,i,r,o,a,s,l,c){var d,u,p,h,f,g,m,y,b,v,x;for(d="",u=this.picker.find(n),p=parseInt(a/r,10)*r,f=parseInt(s/o,10)*o,g=parseInt(l/o,10)*o,h=e.map(this.dates,function(e){return parseInt(e.getUTCFullYear()/o,10)*o}),u.find(".datepicker-switch").text(p+"-"+(p+9*o)),m=p-o,y=-1;11>y;y+=1)b=[i],v=null,-1===y?b.push("old"):10===y&&b.push("new"),-1!==e.inArray(m,h)&&b.push("active"),(f>m||m>g)&&b.push("disabled"),m===this.viewDate.getFullYear()&&b.push("focused"),c!==e.noop&&(x=c(new Date(m,0,1)),x===t?x={}:"boolean"==typeof x?x={enabled:x}:"string"==typeof x&&(x={classes:x}),!1===x.enabled&&b.push("disabled"),x.classes&&(b=b.concat(x.classes.split(/\s+/))),x.tooltip&&(v=x.tooltip)),d+='<span class="'+b.join(" ")+'"'+(v?' title="'+v+'"':"")+">"+m+"</span>",m+=o;u.find("td").html(d)},fill:function(){var i,r,o=new Date(this.viewDate),a=o.getUTCFullYear(),s=o.getUTCMonth(),l=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,c=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,d=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,u=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,p=m[this.o.language].today||m.en.today||"",h=m[this.o.language].clear||m.en.clear||"",f=m[this.o.language].titleFormat||m.en.titleFormat;if(!isNaN(a)&&!isNaN(s)){this.picker.find(".datepicker-days .datepicker-switch").text(y.formatDate(o,f,this.o.language)),this.picker.find("tfoot .today").text(p).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot .clear").text(h).toggle(!1!==this.o.clearBtn),this.picker.find("thead .datepicker-title").text(this.o.title).toggle(""!==this.o.title),this.updateNavArrows(),this.fillMonths();var g=n(a,s-1,28),b=y.getDaysInMonth(g.getUTCFullYear(),g.getUTCMonth());g.setUTCDate(b),g.setUTCDate(b-(g.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(g);g.getUTCFullYear()<100&&v.setUTCFullYear(g.getUTCFullYear()),v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var x,w=[];g.valueOf()<v;){if(g.getUTCDay()===this.o.weekStart&&(w.push("<tr>"),this.o.calendarWeeks)){var C=new Date(+g+(this.o.weekStart-g.getUTCDay()-7)%7*864e5),_=new Date(Number(C)+(11-C.getUTCDay())%7*864e5),k=new Date(Number(k=n(_.getUTCFullYear(),0,1))+(11-k.getUTCDay())%7*864e5),P=(_-k)/864e5/7+1;w.push('<td class="cw">'+P+"</td>")}x=this.getClassNames(g),x.push("day"),this.o.beforeShowDay!==e.noop&&(r=this.o.beforeShowDay(this._utc_to_local(g)),r===t?r={}:"boolean"==typeof r?r={enabled:r}:"string"==typeof r&&(r={classes:r}),!1===r.enabled&&x.push("disabled"),r.classes&&(x=x.concat(r.classes.split(/\s+/))),r.tooltip&&(i=r.tooltip)),x=e.isFunction(e.uniqueSort)?e.uniqueSort(x):e.unique(x),w.push('<td class="'+x.join(" ")+'"'+(i?' title="'+i+'"':"")+">"+g.getUTCDate()+"</td>"),i=null,g.getUTCDay()===this.o.weekEnd&&w.push("</tr>"),g.setUTCDate(g.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(w.join(""));var F=m[this.o.language].monthsTitle||m.en.monthsTitle||"Months",T=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?F:a).end().find("span").removeClass("active");if(e.each(this.dates,function(e,t){t.getUTCFullYear()===a&&T.eq(t.getUTCMonth()).addClass("active")}),(l>a||a>d)&&T.addClass("disabled"),a===l&&T.slice(0,c).addClass("disabled"),a===d&&T.slice(u+1).addClass("disabled"),this.o.beforeShowMonth!==e.noop){var D=this;e.each(T,function(n,i){var r=new Date(a,n,1),o=D.o.beforeShowMonth(r);o===t?o={}:"boolean"==typeof o?o={enabled:o}:"string"==typeof o&&(o={classes:o}),!1!==o.enabled||e(i).hasClass("disabled")||e(i).addClass("disabled"),o.classes&&e(i).addClass(o.classes),o.tooltip&&e(i).prop("title",o.tooltip)})}this._fill_yearsView(".datepicker-years","year",10,1,a,l,d,this.o.beforeShowYear),this._fill_yearsView(".datepicker-decades","decade",100,10,a,l,d,this.o.beforeShowDecade),this._fill_yearsView(".datepicker-centuries","century",1e3,100,a,l,d,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:case 3:case 4:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(t){t.preventDefault(),t.stopPropagation();var r,o,a,s,l,c,d;r=e(t.target),r.hasClass("datepicker-switch")&&this.showMode(1);var u=r.closest(".prev, .next");u.length>0&&(o=y.modes[this.viewMode].navStep*(u.hasClass("prev")?-1:1),0===this.viewMode?(this.viewDate=this.moveMonth(this.viewDate,o),this._trigger("changeMonth",this.viewDate)):(this.viewDate=this.moveYear(this.viewDate,o),1===this.viewMode&&this._trigger("changeYear",this.viewDate)),this.fill()),r.hasClass("today")&&!r.hasClass("day")&&(this.showMode(-2),this._setDate(i(),"linked"===this.o.todayBtn?null:"view")),r.hasClass("clear")&&this.clearDates(),r.hasClass("disabled")||(r.hasClass("day")&&(a=parseInt(r.text(),10)||1,s=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),r.hasClass("old")&&(0===l?(l=11,s-=1,c=!0,d=!0):(l-=1,c=!0)),r.hasClass("new")&&(11===l?(l=0,s+=1,c=!0,d=!0):(l+=1,c=!0)),this._setDate(n(s,l,a)),d&&this._trigger("changeYear",this.viewDate),c&&this._trigger("changeMonth",this.viewDate)),r.hasClass("month")&&(this.viewDate.setUTCDate(1),a=1,l=r.parent().find("span").index(r),s=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(l),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode?(this._setDate(n(s,l,a)),this.showMode()):this.showMode(-1),this.fill()),(r.hasClass("year")||r.hasClass("decade")||r.hasClass("century"))&&(this.viewDate.setUTCDate(1),a=1,l=0,s=parseInt(r.text(),10)||0,this.viewDate.setUTCFullYear(s),r.hasClass("year")&&(this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(n(s,l,a))),r.hasClass("decade")&&(this._trigger("changeDecade",this.viewDate),3===this.o.minViewMode&&this._setDate(n(s,l,a))),r.hasClass("century")&&(this._trigger("changeCentury",this.viewDate),4===this.o.minViewMode&&this._setDate(n(s,l,a))),this.showMode(-1),this.fill())),this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e||this.dates.clear(),-1!==t?(!0===this.o.multidate||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(t):!1===this.o.multidate?(this.dates.clear(),this.dates.push(e)):this.dates.push(e),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),t&&"view"!==t||(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),t&&"view"===t||this._trigger("changeDate"),this.inputField&&this.inputField.change(),!this.o.autoclose||t&&"date"!==t||this.hide()},moveDay:function(e,t){var n=new Date(e);return n.setUTCDate(e.getUTCDate()+t),n},moveWeek:function(e,t){return this.moveDay(e,7*t)},moveMonth:function(e,t){if(!a(e))return this.o.defaultViewDate;if(!t)return e;var n,i,r=new Date(e.valueOf()),o=r.getUTCDate(),s=r.getUTCMonth(),l=Math.abs(t);if(t=t>0?1:-1,1===l)i=-1===t?function(){return r.getUTCMonth()===s}:function(){return r.getUTCMonth()!==n},n=s+t,r.setUTCMonth(n),(0>n||n>11)&&(n=(n+12)%12);else{for(var c=0;l>c;c++)r=this.moveMonth(r,t);n=r.getUTCMonth(),r.setUTCDate(o),i=function(){return n!==r.getUTCMonth()}}for(;i();)r.setUTCDate(--o),r.setUTCMonth(n);return r},moveYear:function(e,t){return this.moveMonth(e,12*t)},moveAvailableDate:function(e,t,n){do{if(e=this[n](e,t),!this.dateWithinRange(e))return!1;n="moveDay"}while(this.dateIsDisabled(e));return e},weekOfDateIsDisabled:function(t){return-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(t){return this.weekOfDateIsDisabled(t)||e.grep(this.o.datesDisabled,function(e){return r(t,e)}).length>0},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(!this.picker.is(":visible"))return void((40===e.keyCode||27===e.keyCode)&&(this.show(),e.stopPropagation()));var t,n,i=!1,r=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault(),e.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;t=37===e.keyCode||38===e.keyCode?-1:1,0===this.viewMode?e.ctrlKey?(n=this.moveAvailableDate(r,t,"moveYear"))&&this._trigger("changeYear",this.viewDate):e.shiftKey?(n=this.moveAvailableDate(r,t,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===e.keyCode||39===e.keyCode?n=this.moveAvailableDate(r,t,"moveDay"):this.weekOfDateIsDisabled(r)||(n=this.moveAvailableDate(r,t,"moveWeek")):1===this.viewMode?((38===e.keyCode||40===e.keyCode)&&(t*=4),n=this.moveAvailableDate(r,t,"moveMonth")):2===this.viewMode&&((38===e.keyCode||40===e.keyCode)&&(t*=4),n=this.moveAvailableDate(r,t,"moveYear")),n&&(this.focusDate=this.viewDate=n,this.setValue(),this.fill(),e.preventDefault());break;case 13:if(!this.o.forceParse)break;r=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(r),i=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),e.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}i&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField&&this.inputField.change())},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+e))),this.picker.children("div").hide().filter(".datepicker-"+y.modes[this.viewMode].clsName).show(),this.updateNavArrows()}};var u=function(t,n){e(t).data("datepicker",this),this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,h.call(e(this.inputs),n).on("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};u.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var n=e(t.target).data("datepicker");if(void 0!==n){var i=n.getUTCDate(),r=e.inArray(t.target,this.inputs),o=r-1,a=r+1,s=this.inputs.length;if(-1!==r){if(e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(i)}),i<this.dates[o])for(;o>=0&&i<this.dates[o];)this.pickers[o--].setUTCDate(i);else if(i>this.dates[a])for(;s>a&&i>this.dates[a];)this.pickers[a++].setUTCDate(i);this.updateDates(),delete this.updating}}}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var p=e.fn.datepicker,h=function(n){var i=Array.apply(null,arguments);i.shift();var r;if(this.each(function(){var t=e(this),o=t.data("datepicker"),a="object"==typeof n&&n;if(!o){var c=s(this,"date"),p=e.extend({},f,c,a),h=l(p.language),g=e.extend({},f,h,c,a);t.hasClass("input-daterange")||g.inputs?(e.extend(g,{inputs:g.inputs||t.find("input").toArray()}),o=new u(this,g)):o=new d(this,g),t.data("datepicker",o)}"string"==typeof n&&"function"==typeof o[n]&&(r=o[n].apply(o,i))}),r===t||r instanceof d||r instanceof u)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+n+" function)");return r};e.fn.datepicker=h;var f=e.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:e.noop,beforeShowMonth:e.noop,beforeShowYear:e.noop,beforeShowDecade:e.noop,beforeShowCentury:e.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&laquo;",rightArrow:"&raquo;"}},g=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=d;var m=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},y={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10},{clsName:"decades",navFnc:"FullDecade",navStep:100},{clsName:"centuries",navFnc:"FullCentury",navStep:1e3}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,y.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(e){if("function"==typeof e.toValue&&"function"==typeof e.toDisplay)return e;var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(r,o,a,s){function l(e,t){return!0===t&&(t=10),100>e&&(e+=2e3)>(new Date).getFullYear()+t&&(e-=100),e}function c(){var e=this.slice(0,b[h].length),t=b[h].slice(0,e.length);return e.toLowerCase()===t.toLowerCase()}if(!r)return t;if(r instanceof Date)return r;if("string"==typeof o&&(o=y.parseFormat(o)),o.toValue)return o.toValue(r,o,a);var u,p,h,f,g=/([\-+]\d+)([dmwy])/,b=r.match(/([\-+]\d+)([dmwy])/g),v={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},x={yesterday:"-1d",today:"+0d",tomorrow:"+1d"};if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(r)){for(r=new Date,h=0;h<b.length;h++)u=g.exec(b[h]),p=parseInt(u[1]),f=v[u[2]],r=d.prototype[f](r,p);return n(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())}if(void 0!==x[r]&&(r=x[r],b=r.match(/([\-+]\d+)([dmwy])/g),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(r))){for(r=new Date,h=0;h<b.length;h++)u=g.exec(b[h]),p=parseInt(u[1]),f=v[u[2]],r=d.prototype[f](r,p);return n(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())}b=r&&r.match(this.nonpunctuation)||[],r=new Date;var w,C,_={},k=["yyyy","yy","M","MM","m","mm","d","dd"],P={yyyy:function(e,t){return e.setUTCFullYear(s?l(t,s):t)},yy:function(e,t){return e.setUTCFullYear(s?l(t,s):t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};P.M=P.MM=P.mm=P.m,P.dd=P.d,r=i();var F=o.parts.slice();if(b.length!==F.length&&(F=e(F).filter(function(t,n){return-1!==e.inArray(n,k)}).toArray()),b.length===F.length){var T;for(h=0,T=F.length;T>h;h++){if(w=parseInt(b[h],10),u=F[h],isNaN(w))switch(u){case"MM":C=e(m[a].months).filter(c),w=e.inArray(C[0],m[a].months)+1;break;case"M":C=e(m[a].monthsShort).filter(c),w=e.inArray(C[0],m[a].monthsShort)+1}_[u]=w}var D,S;for(h=0;h<k.length;h++)(S=k[h])in _&&!isNaN(_[S])&&(D=new Date(r),P[S](D,_[S]),isNaN(D)||(r=D))}return r},formatDate:function(t,n,i){if(!t)return"";if("string"==typeof n&&(n=y.parseFormat(n)),n.toDisplay)return n.toDisplay(t,n,i);var r={d:t.getUTCDate(),D:m[i].daysShort[t.getUTCDay()],DD:m[i].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:m[i].monthsShort[t.getUTCMonth()],MM:m[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m,t=[];for(var o=e.extend([],n.separators),a=0,s=n.parts.length;s>=a;a++)o.length&&t.push(o.shift()),t.push(r[n.parts[a]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};y.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+y.headTemplate+"<tbody></tbody>"+y.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+y.headTemplate+y.contTemplate+y.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+y.headTemplate+y.contTemplate+y.footTemplate+'</table></div><div class="datepicker-decades"><table class="table-condensed">'+y.headTemplate+y.contTemplate+y.footTemplate+'</table></div><div class="datepicker-centuries"><table class="table-condensed">'+y.headTemplate+y.contTemplate+y.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=y,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=p,this},e.fn.datepicker.version="1.6.4",e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);n.data("datepicker")||(t.preventDefault(),h.call(n,"show"))}),e(function(){h.call(e('[data-provide="datepicker-inline"]'))})})},function(e,t,n){t=e.exports=n(80)(!1),t.push([e.i,'/*!\r\n * Cropper v2.3.4\r\n * https://github.com/fengyuanchen/cropper\r\n *\r\n * Copyright (c) 2014-2016 Fengyuan Chen and contributors\r\n * Released under the MIT license\r\n *\r\n * Date: 2016-09-03T05:50:45.412Z\r\n */.cropper-container{font-size:0;line-height:0;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;direction:ltr!important}.cropper-container img{display:block;width:100%;min-width:0!important;max-width:none!important;height:100%;min-height:0!important;max-height:none!important;image-orientation:0deg!important}.cropper-canvas,.cropper-crop-box,.cropper-drag-box,.cropper-modal,.cropper-wrap-box{position:absolute;top:0;right:0;bottom:0;left:0}.cropper-wrap-box{overflow:hidden}.cropper-drag-box{opacity:0;background-color:#fff;filter:alpha(opacity=0)}.cropper-dashed,.cropper-modal{opacity:.5;filter:alpha(opacity=50)}.cropper-modal{background-color:#000}.cropper-view-box{display:block;overflow:hidden;width:100%;height:100%;outline:1px solid #39f;outline-color:rgba(51,153,255,.75)}.cropper-dashed{position:absolute;display:block;border:0 dashed #eee}.cropper-dashed.dashed-h{top:33.33333%;left:0;width:100%;height:33.33333%;border-top-width:1px;border-bottom-width:1px}.cropper-dashed.dashed-v{top:0;left:33.33333%;width:33.33333%;height:100%;border-right-width:1px;border-left-width:1px}.cropper-center{position:absolute;top:50%;left:50%;display:block;width:0;height:0;opacity:.75;filter:alpha(opacity=75)}.cropper-center:after,.cropper-center:before{position:absolute;display:block;content:" ";background-color:#eee}.cropper-center:before{top:0;left:-3px;width:7px;height:1px}.cropper-center:after{top:-3px;left:0;width:1px;height:7px}.cropper-face,.cropper-line,.cropper-point{position:absolute;display:block;width:100%;height:100%;opacity:.1;filter:alpha(opacity=10)}.cropper-face{top:0;left:0;background-color:#fff}.cropper-line,.cropper-point{background-color:#39f}.cropper-line.line-e{top:0;right:-3px;width:5px;cursor:e-resize}.cropper-line.line-n{top:-3px;left:0;height:5px;cursor:n-resize}.cropper-line.line-w{top:0;left:-3px;width:5px;cursor:w-resize}.cropper-line.line-s{bottom:-3px;left:0;height:5px;cursor:s-resize}.cropper-point{width:5px;height:5px;opacity:.75;filter:alpha(opacity=75)}.cropper-point.point-e{top:50%;right:-3px;margin-top:-3px;cursor:e-resize}.cropper-point.point-n{top:-3px;left:50%;margin-left:-3px;cursor:n-resize}.cropper-point.point-w{top:50%;left:-3px;margin-top:-3px;cursor:w-resize}.cropper-point.point-s{bottom:-3px;left:50%;margin-left:-3px;cursor:s-resize}.cropper-point.point-ne{top:-3px;right:-3px;cursor:ne-resize}.cropper-point.point-nw{top:-3px;left:-3px;cursor:nw-resize}.cropper-point.point-sw{bottom:-3px;left:-3px;cursor:sw-resize}.cropper-point.point-se{right:-3px;bottom:-3px;width:20px;height:20px;cursor:se-resize;opacity:1;filter:alpha(opacity=100)}.cropper-point.point-se:before{position:absolute;right:-50%;bottom:-50%;display:block;width:200%;height:200%;content:" ";opacity:0;background-color:#39f;filter:alpha(opacity=0)}@media (min-width:768px){.cropper-point.point-se{width:15px;height:15px}}@media (min-width:992px){.cropper-point.point-se{width:10px;height:10px}}@media (min-width:1200px){.cropper-point.point-se{width:5px;height:5px;opacity:.75;filter:alpha(opacity=75)}}.cropper-invisible{opacity:0;filter:alpha(opacity=0)}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{position:absolute;display:block;width:0;height:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}',""])},function(e,t,n){var i=n(94),r=n(81);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!0);i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(80)(!1),t.push([e.i,".img-container,.img-preview{background-color:#fff;border:1px dashed #e5e5e5;width:100%;text-align:center}.img-container{min-height:200px;max-height:300px;margin-bottom:20px}.cropper-bg{background:none}.cropper-modal{background:#fff}@media (min-width:768px){.img-container{min-height:300px}}.img-container>img{max-width:100%}.docs-preview{margin-right:-15px}.img-preview{float:left;margin-right:10px;margin-bottom:10px;overflow:hidden}.img-preview>img{max-width:100%}.preview-lg{width:263px;height:148px}.preview-md{width:139px;height:78px}.preview-sm{width:69px;height:39px}.preview-xs{width:35px;height:20px;margin-right:0}.docs-data>.input-group{margin-bottom:10px}.docs-data>.input-group>label{min-width:80px}.docs-data>.input-group>span{min-width:50px}.docs-buttons>.btn,.docs-buttons>.btn-group,.docs-buttons>.form-control{margin-right:5px;margin-bottom:10px}.docs-toggles>.btn,.docs-toggles>.btn-group,.docs-toggles>.dropdown{margin-bottom:10px}.docs-tooltip{display:block;margin:-6px -12px;padding:6px 12px}.docs-tooltip>.icon{margin:0 -3px;vertical-align:top}.tooltip-inner{white-space:normal}.btn-toggle .tooltip-inner,.btn-upload .tooltip-inner{white-space:nowrap}.btn-toggle{padding:6px}.btn-toggle>.docs-tooltip{margin:-6px;padding:6px}@media (max-width:400px){.btn-group-crop{margin-right:-15px!important}.btn-group-crop .docs-tooltip,.btn-group-crop>.btn{padding-left:5px;padding-right:5px}.btn-group-crop .docs-tooltip{margin-left:-5px;margin-right:-5px}}.docs-options .dropdown-menu{width:100%}.docs-options .dropdown-menu>li{padding:3px 20px}.docs-options .dropdown-menu>li:hover{background-color:#f7f7f7}.docs-options .dropdown-menu>li>label{display:block}.docs-cropped .modal-body{text-align:center}.docs-cropped .modal-body>canvas,.docs-cropped .modal-body>img{max-width:100%}.docs-diagram .modal-dialog{max-width:352px}.cropppercustomcut{height:1003px!important;width:317px!important}",""])},function(e,t,n){t=e.exports=n(80)(!1),t.push([e.i,'.richText i{font-style:italic;position:static;font-size:inherit;color:inherit}.richText u{text-decoration:underline}.richText li{display:list-item}.richText ol{list-style-type:decimal}.richText ul{list-style-type:disc}.content{background-color:#fafafa;border:1px solid #efefef;color:#333;height:150px;width:100%}.richText{margin:10px 0 20px;-webkit-box-shadow:0 0 20px 0 #999;-moz-box-shadow:0 0 20px 0 #999;box-shadow:0 0 20px 0 #999;position:relative;background-color:#fafafa;border:1px solid #efefef;color:#333;width:100%}.richText .richText-form{font-family:Calibri,Verdana,Helvetica,sans-serif}.richText .richText-form label{display:block;padding:10px 15px}.richText .richText-form input[type=file],.richText .richText-form input[type=number],.richText .richText-form input[type=text],.richText .richText-form select{padding:10px 15px;border:1px solid #999;min-width:200px;width:100%}.richText .richText-form select{cursor:pointer}.richText .richText-form button{margin:10px 0;padding:10px 15px;background-color:#3498db;border:none;color:#fafafa;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.richText .richText-toolbar{min-height:20px;border-bottom:1px solid #efefef}.richText .richText-toolbar ul li{float:left;display:block;list-style:none}.richText .richText-toolbar ul li a{display:block;color:#333;padding:10px 12px;cursor:pointer;-webkit-transition:background-color .4s;-moz-transition:background-color .4s;transition:background-color .4s}.richText .richText-toolbar ul li a .fa,.richText .richText-toolbar ul li a .far,.richText .richText-toolbar ul li a .fas,.richText .richText-toolbar ul li a svg{pointer-events:none}.richText .richText-toolbar ul li a .richText-dropdown-outer{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.3);cursor:default}.richText .richText-toolbar ul{margin:0}.richText .richText-toolbar ul li a .richText-dropdown-outer .richText-dropdown{position:relative;display:block;margin:3% auto 0;background-color:#fafafa;border:1px solid #efefef;min-width:100px;width:300px;max-width:90%;-webkit-box-shadow:0 0 5px 0 #333;-moz-box-shadow:0 0 5px 0 #333;box-shadow:0 0 5px 0 #333}.richText .richText-toolbar ul li a .richText-dropdown-outer .richText-dropdown .richText-dropdown-close{position:absolute;top:0;right:-23px;background:#fff;color:#333;cursor:pointer;font-size:20px;text-align:center;width:20px}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown{list-style:none}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li{display:block;float:none;font-family:Calibri,Verdana,Helvetica,sans-serif}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li a{display:block;padding:10px 15px;border-bottom:1px solid #efefef}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li a:hover{background-color:#fff}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li.inline{margin:10px 6px;float:left}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li.inline a{display:block;padding:0;margin:0;border:none;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;-webkit-box-shadow:0 0 10px 0 #999;-moz-box-shadow:0 0 10px 0 #999;box-shadow:0 0 10px 0 #999}.richText .richText-toolbar ul li a .richText-dropdown-outer ul.richText-dropdown li.inline a span{display:block;height:30px;width:30px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%}.richText .richText-toolbar ul li a .richText-dropdown-outer div.richText-dropdown{padding:10px 15px}.richText .richText-toolbar ul li a:hover{background-color:#fff}.richText .richText-toolbar ul li[data-disable=true]{opacity:.1}.richText .richText-toolbar ul li[data-disable=true] a{cursor:default}.richText .richText-toolbar ul li:not([data-disable=true]).is-selected .richText-dropdown-outer{display:block}.richText .richText-toolbar ul:after{display:block;content:"";clear:both}.richText .richText-toolbar:last-child{font-size:12px}.richText .richText-toolbar:after{display:block;clear:both;content:""}.richText .richText-editor{padding:20px;background-color:#fff;border-left:2px solid #fff;font-family:Calibri,Verdana,Helvetica,sans-serif;height:300px;outline:none;overflow-y:scroll;overflow-x:auto}.richText .richText-editor ol,.richText .richText-editor ul{margin:10px 25px}.richText .richText-editor table{margin:10px 0;border-spacing:0;width:100%}.richText .richText-editor table td,.richText .richText-editor table th{padding:10px;border:1px solid #efefef}.richText .richText-editor:focus{border-left:2px solid #3498db}.richText .richText-initial{margin-bottom:-4px;padding:10px;background-color:#282828;border:none;color:#3f3;font-family:Monospace,Calibri,Verdana,Helvetica,sans-serif;max-width:100%;min-width:100%;width:100%;min-height:400px;height:400px}.richText .richText-help{float:right;display:block;color:#333;padding:10px 15px;cursor:pointer}.richText .richText-redo,.richText .richText-undo{float:left;color:#333;display:block;padding:10px 15px;border-right:1px solid #efefef;cursor:pointer}.richText .richText-redo.is-disabled,.richText .richText-undo.is-disabled{opacity:.4}.richText .richText-help-popup a{color:#3498db;text-decoration:underline}.richText .richText-help-popup hr{margin:10px auto 5px;border:none;border-top:1px solid #efefef}.richText .richText-list.list-rightclick{position:absolute;background-color:#fafafa;border-right:1px solid #efefef;border-bottom:1px solid #efefef}.richText .richText-list.list-rightclick li{padding:5px 7px;cursor:pointer;list-style:none}@media only screen and (max-width:960px){.page-wrapper{width:100%;max-width:100%}}',""])},function(e,t,n){t=e.exports=n(80)(!1),t.push([e.i,'/*! * Datepicker for Bootstrap v1.6.4 (https://github.com/eternicode/bootstrap-datepicker) * * Copyright 2012 Stefan Petre * Improvements by Andrew Rowls * Licensed under the Apache License v2.0 (http://www.apache.org/licenses/LICENSE-2.0) */.datepicker{padding:4px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;direction:ltr}.datepicker-inline{width:220px}.datepicker.datepicker-rtl{direction:rtl}.datepicker.datepicker-rtl table tr td span{float:right}.datepicker-dropdown{top:0;left:0}.datepicker-dropdown:before{content:"";display:inline-block;border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:7px solid #999;border-top:0;border-bottom-color:rgba(0,0,0,.2);position:absolute}.datepicker-dropdown:after{content:"";display:inline-block;border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:6px solid #fff;border-top:0;position:absolute}.datepicker-dropdown.datepicker-orient-left:before{left:6px}.datepicker-dropdown.datepicker-orient-left:after{left:7px}.datepicker-dropdown.datepicker-orient-right:before{right:6px}.datepicker-dropdown.datepicker-orient-right:after{right:7px}.datepicker-dropdown.datepicker-orient-bottom:before{top:-7px}.datepicker-dropdown.datepicker-orient-bottom:after{top:-6px}.datepicker-dropdown.datepicker-orient-top:before{bottom:-7px;border-bottom:0;border-top:7px solid #999}.datepicker-dropdown.datepicker-orient-top:after{bottom:-6px;border-bottom:0;border-top:6px solid #fff}.datepicker table{margin:0;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.datepicker td,.datepicker th{text-align:center;width:20px;height:20px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;border:none}.table-striped .datepicker table tr td,.table-striped .datepicker table tr th{background-color:transparent}.datepicker table tr td.day.focused,.datepicker table tr td.day:hover{background:#eee;cursor:pointer}.datepicker table tr td.new,.datepicker table tr td.old{color:#999}.datepicker table tr td.disabled,.datepicker table tr td.disabled:hover{background:0 0;color:#999;cursor:default}.datepicker table tr td.highlighted{background:#d9edf7;border-radius:0}.datepicker table tr td.today,.datepicker table tr td.today.disabled,.datepicker table tr td.today.disabled:hover,.datepicker table tr td.today:hover{background-color:#fde19a;background-image:-moz-linear-gradient(to bottom,#fdd49a,#fdf59a);background-image:-ms-linear-gradient(to bottom,#fdd49a,#fdf59a);background-image:-webkit-gradient(linear,0 0,0 100%,from(#fdd49a),to(#fdf59a));background-image:-webkit-linear-gradient(180deg,#fdd49a,#fdf59a);background-image:-o-linear-gradient(to bottom,#fdd49a,#fdf59a);background-image:linear-gradient(180deg,#fdd49a,#fdf59a);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#fdd49a",endColorstr="#fdf59a",GradientType=0);border-color:#fdf59a #fdf59a #fbed50;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false);color:#000}.datepicker table tr td.today.active,.datepicker table tr td.today.disabled,.datepicker table tr td.today.disabled.active,.datepicker table tr td.today.disabled.disabled,.datepicker table tr td.today.disabled:active,.datepicker table tr td.today.disabled:hover,.datepicker table tr td.today.disabled:hover.active,.datepicker table tr td.today.disabled:hover.disabled,.datepicker table tr td.today.disabled:hover:active,.datepicker table tr td.today.disabled:hover:hover,.datepicker table tr td.today.disabled:hover[disabled],.datepicker table tr td.today.disabled[disabled],.datepicker table tr td.today:active,.datepicker table tr td.today:hover,.datepicker table tr td.today:hover.active,.datepicker table tr td.today:hover.disabled,.datepicker table tr td.today:hover:active,.datepicker table tr td.today:hover:hover,.datepicker table tr td.today:hover[disabled],.datepicker table tr td.today[disabled]{background-color:#fdf59a}.datepicker table tr td.today.active,.datepicker table tr td.today.disabled.active,.datepicker table tr td.today.disabled:active,.datepicker table tr td.today.disabled:hover.active,.datepicker table tr td.today.disabled:hover:active,.datepicker table tr td.today:active,.datepicker table tr td.today:hover.active,.datepicker table tr td.today:hover:active{background-color:#fbf069\\9}.datepicker table tr td.today:hover:hover{color:#000}.datepicker table tr td.today.active:hover{color:#fff}.datepicker table tr td.range,.datepicker table tr td.range.disabled,.datepicker table tr td.range.disabled:hover,.datepicker table tr td.range:hover{background:#eee;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.datepicker table tr td.range.today,.datepicker table tr td.range.today.disabled,.datepicker table tr td.range.today.disabled:hover,.datepicker table tr td.range.today:hover{background-color:#f3d17a;background-image:-moz-linear-gradient(to bottom,#f3c17a,#f3e97a);background-image:-ms-linear-gradient(to bottom,#f3c17a,#f3e97a);background-image:-webkit-gradient(linear,0 0,0 100%,from(#f3c17a),to(#f3e97a));background-image:-webkit-linear-gradient(180deg,#f3c17a,#f3e97a);background-image:-o-linear-gradient(to bottom,#f3c17a,#f3e97a);background-image:linear-gradient(180deg,#f3c17a,#f3e97a);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#f3c17a",endColorstr="#f3e97a",GradientType=0);border-color:#f3e97a #f3e97a #edde34;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false);-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.datepicker table tr td.range.today.active,.datepicker table tr td.range.today.disabled,.datepicker table tr td.range.today.disabled.active,.datepicker table tr td.range.today.disabled.disabled,.datepicker table tr td.range.today.disabled:active,.datepicker table tr td.range.today.disabled:hover,.datepicker table tr td.range.today.disabled:hover.active,.datepicker table tr td.range.today.disabled:hover.disabled,.datepicker table tr td.range.today.disabled:hover:active,.datepicker table tr td.range.today.disabled:hover:hover,.datepicker table tr td.range.today.disabled:hover[disabled],.datepicker table tr td.range.today.disabled[disabled],.datepicker table tr td.range.today:active,.datepicker table tr td.range.today:hover,.datepicker table tr td.range.today:hover.active,.datepicker table tr td.range.today:hover.disabled,.datepicker table tr td.range.today:hover:active,.datepicker table tr td.range.today:hover:hover,.datepicker table tr td.range.today:hover[disabled],.datepicker table tr td.range.today[disabled]{background-color:#f3e97a}.datepicker table tr td.range.today.active,.datepicker table tr td.range.today.disabled.active,.datepicker table tr td.range.today.disabled:active,.datepicker table tr td.range.today.disabled:hover.active,.datepicker table tr td.range.today.disabled:hover:active,.datepicker table tr td.range.today:active,.datepicker table tr td.range.today:hover.active,.datepicker table tr td.range.today:hover:active{background-color:#efe24b\\9}.datepicker table tr td.selected,.datepicker table tr td.selected.disabled,.datepicker table tr td.selected.disabled:hover,.datepicker table tr td.selected:hover{background-color:#9e9e9e;background-image:-moz-linear-gradient(to bottom,#b3b3b3,grey);background-image:-ms-linear-gradient(to bottom,#b3b3b3,grey);background-image:-webkit-gradient(linear,0 0,0 100%,from(#b3b3b3),to(grey));background-image:-webkit-linear-gradient(180deg,#b3b3b3,grey);background-image:-o-linear-gradient(to bottom,#b3b3b3,grey);background-image:linear-gradient(180deg,#b3b3b3,grey);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#b3b3b3",endColorstr="#808080",GradientType=0);border-color:grey grey #595959;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false);color:#fff;text-shadow:0 -1px 0 rgba(0,0,0,.25)}.datepicker table tr td.selected.active,.datepicker table tr td.selected.disabled,.datepicker table tr td.selected.disabled.active,.datepicker table tr td.selected.disabled.disabled,.datepicker table tr td.selected.disabled:active,.datepicker table tr td.selected.disabled:hover,.datepicker table tr td.selected.disabled:hover.active,.datepicker table tr td.selected.disabled:hover.disabled,.datepicker table tr td.selected.disabled:hover:active,.datepicker table tr td.selected.disabled:hover:hover,.datepicker table tr td.selected.disabled:hover[disabled],.datepicker table tr td.selected.disabled[disabled],.datepicker table tr td.selected:active,.datepicker table tr td.selected:hover,.datepicker table tr td.selected:hover.active,.datepicker table tr td.selected:hover.disabled,.datepicker table tr td.selected:hover:active,.datepicker table tr td.selected:hover:hover,.datepicker table tr td.selected:hover[disabled],.datepicker table tr td.selected[disabled]{background-color:grey}.datepicker table tr td.selected.active,.datepicker table tr td.selected.disabled.active,.datepicker table tr td.selected.disabled:active,.datepicker table tr td.selected.disabled:hover.active,.datepicker table tr td.selected.disabled:hover:active,.datepicker table tr td.selected:active,.datepicker table tr td.selected:hover.active,.datepicker table tr td.selected:hover:active{background-color:#666\\9}.datepicker table tr td.active,.datepicker table tr td.active.disabled,.datepicker table tr td.active.disabled:hover,.datepicker table tr td.active:hover{background-color:#ee3224;background-image:-moz-linear-gradient(to bottom,#ee3224,#ee3224);background-image:-ms-linear-gradient(to bottom,#ee3224,#ee3224);background-image:-webkit-gradient(linear,0 0,0 100%,from(#ee3224),to(#ee3224));background-image:-webkit-linear-gradient(180deg,#ee3224,#ee3224);background-image:-o-linear-gradient(to bottom,#ee3224,#ee3224);background-image:linear-gradient(180deg,#ee3224,#ee3224);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#EE3224",endColorstr="#EE3224",GradientType=0);border-color:#ee3224;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false);color:#fff;text-shadow:0 -1px 0 rgba(0,0,0,.25)}.datepicker table tr td.active.active,.datepicker table tr td.active.disabled,.datepicker table tr td.active.disabled.active,.datepicker table tr td.active.disabled.disabled,.datepicker table tr td.active.disabled:active,.datepicker table tr td.active.disabled:hover,.datepicker table tr td.active.disabled:hover.active,.datepicker table tr td.active.disabled:hover.disabled,.datepicker table tr td.active.disabled:hover:active,.datepicker table tr td.active.disabled:hover:hover,.datepicker table tr td.active.disabled:hover[disabled],.datepicker table tr td.active.disabled[disabled],.datepicker table tr td.active:active,.datepicker table tr td.active:hover,.datepicker table tr td.active:hover.active,.datepicker table tr td.active:hover.disabled,.datepicker table tr td.active:hover:active,.datepicker table tr td.active:hover:hover,.datepicker table tr td.active:hover[disabled],.datepicker table tr td.active[disabled]{background-color:#ee3224}.datepicker table tr td.active.active,.datepicker table tr td.active.disabled.active,.datepicker table tr td.active.disabled:active,.datepicker table tr td.active.disabled:hover.active,.datepicker table tr td.active.disabled:hover:active,.datepicker table tr td.active:active,.datepicker table tr td.active:hover.active,.datepicker table tr td.active:hover:active{background-color:#039\\9}.datepicker table tr td span{display:block;width:23%;height:54px;line-height:54px;float:left;margin:1%;cursor:pointer;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.datepicker table tr td span.focused,.datepicker table tr td span:hover{background:#eee}.datepicker table tr td span.disabled,.datepicker table tr td span.disabled:hover{background:0 0;color:#999;cursor:default}.datepicker table tr td span.active,.datepicker table tr td span.active.disabled,.datepicker table tr td span.active.disabled:hover,.datepicker table tr td span.active:hover{background-color:#ee3224;background-image:-moz-linear-gradient(to bottom,#ee3224,#ee3224);background-image:-ms-linear-gradient(to bottom,#ee3224,#ee3224);background-image:-webkit-gradient(linear,0 0,0 100%,from(#ee3224),to(#ee3224));background-image:-webkit-linear-gradient(180deg,#ee3224,#ee3224);background-image:-o-linear-gradient(to bottom,#ee3224,#ee3224);background-image:linear-gradient(180deg,#ee3224,#ee3224);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#08c",endColorstr="#0044cc",GradientType=0);border-color:#ee3224 #04EE3224c;border-color:rgba(0,0,0,.1) rgba(0,0,0,.1) rgba(0,0,0,.25);filter:progid:DXImageTransform.Microsoft.gradient(enabled=false);color:#fff;text-shadow:0 -1px 0 rgba(0,0,0,.25)}.datepicker table tr td span.active.active,.datepicker table tr td span.active.disabled,.datepicker table tr td span.active.disabled.active,.datepicker table tr td span.active.disabled.disabled,.datepicker table tr td span.active.disabled:active,.datepicker table tr td span.active.disabled:hover,.datepicker table tr td span.active.disabled:hover.active,.datepicker table tr td span.active.disabled:hover.disabled,.datepicker table tr td span.active.disabled:hover:active,.datepicker table tr td span.active.disabled:hover:hover,.datepicker table tr td span.active.disabled:hover[disabled],.datepicker table tr td span.active.disabled[disabled],.datepicker table tr td span.active:active,.datepicker table tr td span.active:hover,.datepicker table tr td span.active:hover.active,.datepicker table tr td span.active:hover.disabled,.datepicker table tr td span.active:hover:active,.datepicker table tr td span.active:hover:hover,.datepicker table tr td span.active:hover[disabled],.datepicker table tr td span.active[disabled]{background-color:#ee3224}.datepicker table tr td span.active.active,.datepicker table tr td span.active.disabled.active,.datepicker table tr td span.active.disabled:active,.datepicker table tr td span.active.disabled:hover.active,.datepicker table tr td span.active.disabled:hover:active,.datepicker table tr td span.active:active,.datepicker table tr td span.active:hover.active,.datepicker table tr td span.active:hover:active{background-color:#039\\9}.datepicker table tr td span.new,.datepicker table tr td span.old{color:#999}.datepicker .datepicker-switch{width:145px}.datepicker .datepicker-switch,.datepicker .next,.datepicker .prev,.datepicker tfoot tr th{cursor:pointer}.datepicker .datepicker-switch:hover,.datepicker .next:hover,.datepicker .prev:hover,.datepicker tfoot tr th:hover{background:#eee}.datepicker .cw{font-size:10px;width:12px;padding:0 2px 0 5px;vertical-align:middle}.input-append.date .add-on,.input-prepend.date .add-on{cursor:pointer}.input-append.date .add-on i,.input-prepend.date .add-on i{margin-top:3px}.input-daterange input{text-align:center}.input-daterange input:first-child{-webkit-border-radius:3px 0 0 3px;-moz-border-radius:3px 0 0 3px;border-radius:3px 0 0 3px}.input-daterange input:last-child{-webkit-border-radius:0 3px 3px 0;-moz-border-radius:0 3px 3px 0;border-radius:0 3px 3px 0}.input-daterange .add-on{display:inline-block;width:auto;min-width:16px;height:18px;padding:4px 5px;font-weight:400;line-height:18px;text-align:center;text-shadow:0 1px 0 #fff;vertical-align:middle;background-color:#eee;border:1px solid #ccc;margin-left:-5px;margin-right:-5px}',""])},function(e,t,n){"use strict";function i(e,t,n,i,r,o){var a=s(t);return void 0==r?p.a.sp.web.lists.getByTitle(e).items.select(a).top(n).orderBy(i).get():p.a.sp.web.lists.getByTitle(e).items.select(a).filter(r+" eq '"+o+"'").top(n).orderBy(i).get()}function r(e,t,n){return p.a.sp.web.lists.getByTitle(e).items.add(t).then(function(e){return n(e)})}function o(e,t,n,i,r){return p.a.sp.web.getFolderByServerRelativeUrl(e).files.add(t,n,!0).then(function(t){t.file.listItemAllFields.get().then(function(t){return p.a.sp.web.lists.getByTitle(e).items.getById(t.Id).update(i).then(function(e){return r(e)})})})}function a(e,t,n,i){return p.a.sp.web.lists.getByTitle(e).items.getById(t).update(n).then(function(e){return i(e)})}function s(e){for(var t="",n=0;n<e.length;n++)t+=e[n]+",";return t.slice(0,-1)}function l(e,t,n){var i;p.a.sp.web.siteUsers.getByEmail(t).groups.get().then(function(t){var r=e;i=$.grep(t,function(e,t){if(-1!=e.Title.indexOf(r))return!0}),n(i.length)})}function c(e){for(var t=window.location.search.substring(1),n=t.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(r[0]==e)return r[1]}}function d(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i.buffer}n.d(t,"f",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return o}),n.d(t,"g",function(){return a}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return c});var u=n(19),p=n.n(u)},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(47),r=(n.n(i),n(46)),o=(n.n(r),n(103)),a=(n.n(o),n(19)),s=n.n(a),l=n(86),c=(n.n(l),n(93)),d=(n.n(c),n(87)),u=(n.n(d),n(88)),p=(n.n(u),n(89)),h=(n.n(p),n(90)),f=(n.n(h),n(97)),g=n(105),m=(n.n(g),this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}()),y=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};n(83),n(85),n(91),n(104),n(85),n(91),n(88),n(89);var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.render=function(){var e=this;Object(f.e)("Admin",this.context.pageContext.user.email,function(t){1==t?e.loadComponent():alertify.alert("Access Denied","Sorry You dont have access to this page",function(){history.go(-1)}).set("closable",!1)})},t.prototype.loadComponent=function(){var e=this,t=this.context.pageContext.web.absoluteUrl,n=Object(f.a)("CName");n=n.split("%20").join(" "),this.domElement.innerHTML="<div class='breadcrumb'><ol><li><a href='"+t+"/Pages/Home.aspx' title='Home'>Home</a></li><li><a class='pointer' id='breadTilte' title='"+n+"'>"+n+" List View</a></li><li><span>Add "+n+"</span></li></ol></div><div class='title-section'><div class='button-field save-button'><a  title='Save' class='addbutton pointer' id='AddItem'><i class='commonicon-save addbutton'></i>Save</a><a class='delete-icon close-icon pointer deletebutton' class='closebutton' title='Close' id='DelItem'><i class='commonicon-close deletebutton'></i>Close</a></div><h2 id='ComponentName'>Announcements</h2></div><div  class='form-section required'></div><div class='modal'>\x3c!-- Place at bottom of page --\x3e</div>",document.title="Add"+n,document.getElementById("ComponentName").innerHTML=Object(f.a)("CName").split("%20").join(" "),this.AddListItems(),$("input[name='selectionradio']").click(function(){"Holiday"==$("input[name='selectionradio']:checked").val()?($(".themelogo-upload").hide(),$("#cropped-img").attr("src",t+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"),$("#rrdescription").hide(),$("#txtTitle,#txtEndDate,#txtrequiredDescription,#inputImage").val(""),$("#txtStartDate").datepicker({Format:"yy/dd/mm"}).datepicker("setDate","new Date()")):($(".themelogo-upload").show(),$("#rrdescription").show())}),$("input[name='selectionradioImage']").click(function(){"Upload"==$("input[name='selectionradioImage']:checked").val()?($("#divHyperLink").hide(),$(".banner-upload").show()):($(".banner-upload").hide(),$("#divHyperLink").show())}),"Holiday"==n?($("#radio-2").attr("checked","checked"),$(".themelogo-upload").hide(),$("#cropped-img").attr("src",t+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"),$("#rrdescription").hide(),$("#txtTitle,#txtEndDate,#txtrequiredDescription,#inputImage").val(""),$("#txtStartDate").datepicker({Format:"yy/dd/mm"}).datepicker("setDate","new Date()")):($("#radio-1").attr("checked","checked"),$(".themelogo-upload").show(),$("#rrdescription").show()),$("#radio-3").attr("checked","checked"),document.getElementById("AddItem").addEventListener("click",function(n){return e.AddItem(t,n)}),document.getElementById("breadTilte").addEventListener("click",function(t){return e.pageBack()}),document.getElementById("DelItem").addEventListener("click",function(t){return e.pageBack()}),this.datepickerkeyTypeBlocker();var i=document.getElementById("uploadImageFile");i&&i.addEventListener("change",function(t){return e.validateFileType()});var r=document.getElementById("uploadVideoFile");r&&r.addEventListener("change",function(t){return e.validateVideoFileType()}),$("#txtFolderName").keyup(function(){var e=[];$.ajax({url:t+"/_api/Web/Lists/GetByTitle('"+n+"')/Items?$expand=ContentType&$select=LinkFilename,FileSystemObjectType",type:"GET",headers:{accept:"application/json;odata=verbose"},success:function(t){for(var n=t.d.results.length,i=0;i<n;i++)1==t.d.results[i].FileSystemObjectType&&e.push(t.d.results[i].LinkFilename);$("#txtFolderName").autocomplete({source:e})},error:function(e){console.log(e)}})})},t.prototype.datepickerkeyTypeBlocker=function(){$("#txtExpires,#txtStartDate,#txtEndDate,#txtEvDate,#txtEEDate").keypress(function(e){e.preventDefault()})},t.prototype.pageBack=function(){window.history.back()},t.prototype.AddItem=function(e,t){var n=this,i=$("body");$(".ajs-message").length>0&&$(".ajs-message").remove(),t.preventDefault(),$(this).prop("disabled",!0);var r=$("input[name='selectionradio']:checked").val(),i=($("input[name='selectionradio']:checked").val(),$("body")),o=Object(f.a)("CName");o=o.split("%20").join(" ");var a=!0,l=this.context.pageContext.web.serverRelativeUrl;if("Announcements"==o){var c=document.getElementById("inputImage"),d=c.files[0];if($("#cropped-img")[0].src==e+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"?(alertify.set("notifier","position","top-right"),alertify.error("Please Upload the Image File"),a=!1):$("#txtExpires").val().trim()?$("#txtTitle").val().trim()?$(".richText-editor").text().trim()?"block"==$("#canvasdisplay").css("display")&&(alertify.set("notifier","position","top-right"),alertify.error("Please Save Cropped Image"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Description"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Title"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Date"),a=!1),a)if(i.addClass("loading"),void 0==$("#inputImage").val()||null==$("#inputImage").val()||""==$("#inputImage").val())$.ajax({url:e+"/_api/web/getfilebyserverrelativeurl('"+l+"/_catalogs/masterpage/Bloom/images/logo.png')/openbinarystream",type:"GET",success:function(t){var n=Math.random().toString(36).substr(2,9)+".png";s.a.sp.web.getFolderByServerRelativeUrl("Announcements").files.add(n,t,!0).then(function(t){t.file.listItemAllFields.get().then(function(t){s.a.sp.web.lists.getByTitle("Announcements").items.getById(t.Id).update({Title:$("#txtTitle").val().trim(),Expires:new Date($("#txtExpires").val()),Explanation:$(".richText-editor").html(),ExplanationText:$(".richText-editor").text(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/_catalogs/masterpage/Bloom/images/logo.png"}}).then(function(e){i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back(),console.log(n+" properties updated successfully!")})})})},error:function(e){i.removeClass("loading"),console.log(e)}});else{var u=Math.random().toString(36).substr(2,9)+".png",p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]),g={Title:$("#txtTitle").val().trim(),Expires:new Date($("#txtExpires").val()),Explanation:$(".richText-editor").html(),ExplanationText:$(".richText-editor").text(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+u}};Object(f.c)(o,u,h,g,function(e){i.addClass("loading"),e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):(i.removeClass("loading"),console.log(e))})}}else if("Holiday"==r){if($("#txtTitle").val().trim())if($("#txtStartDate").val().trim()){if(Date.parse($("#txtStartDate").val().trim())>Date.parse($("#txtEndDate").val().trim()))return alertify.set("notifier","position","top-right"),alertify.error("Start date must be less than End date"),!1}else alertify.set("notifier","position","top-right"),alertify.error("Please Enter txtStartDate"),a=!1;else alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1;var m={Title:$("#txtTitle").val().trim(),EventDate:new Date($("#txtStartDate").val()),EndEventDate:new Date($("#txtEndDate").val())};a&&(i.addClass("loading"),Object(f.b)("Holiday",m,function(e){i.addClass("loading"),e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):(i.removeClass("loading"),console.log(e))}))}else if("Quick Links"==o){var y=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;$("#txtTitle").val().trim()?$("#txtHyper").val().trim()?y.test($("#txtHyper").val().trim())||(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Link URL Correctly"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Link URL"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1);var g={Title:$("#txtTitle").val().trim(),LinkURL:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtHyper").val().trim()}};a&&(i.addClass("loading"),Object(f.b)("Quick Links",g,function(e){i.addClass("loading"),e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):(i.removeClass("loading"),console.log(e))}))}else if("News"==o){var c=document.getElementById("inputImage"),d=c.files[0];if($("#inputImage").val().trim()?$("#txtExpires").val().trim()?$("#txtTitle").val().trim()?$("#txtrequiredDescription").val().trim()?"block"==$("#canvasdisplay").css("display")&&(alertify.set("notifier","position","top-right"),alertify.error("Please Save Cropped Image"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Description"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Date"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Image"),a=!1),a){i.addClass("loading");var u=Math.random().toString(36).substr(2,9)+".png",p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]),g={Title:$("#txtTitle").val().trim(),Date:new Date($("#txtExpires").val()),Explanation:$("#txtrequiredDescription").val(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+u}};Object(f.c)(o,u,h,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)})}}else if("Employee Corner"==o){var c=document.getElementById("uploadFile"),d=c.files[0];$("#txtTitle").val().trim()?$("#uploadFile").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Select Document File"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1);var g={Title:$("#txtTitle").val().trim(),DocumentFile:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+d.name}};a&&(i.addClass("loading"),Object(f.c)(o,d.name,d,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)}))}else if("Banners"==o){var y=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,c=document.getElementById("inputImage"),d=c.files[0];window.location.origin;$("#cropped-img")[0].src==e+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"?(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Image"),a=!1):$("#txtTitle").val().trim()?$(".richText-editor").text().trim()?$("#txtHyper").val()&&!y.test($("#txtHyper").val().trim())?(alertify.set("notifier","position","top-right"),alertify.error("Please give a valid Link URL"),a=!1):"block"==$("#canvasdisplay").css("display")&&(alertify.set("notifier","position","top-right"),alertify.error("Please Save Cropped Image"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Description"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Title"),a=!1);var u=Math.random().toString(36).substr(2,9)+".png",p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]),g={Title:$("#txtTitle").val().trim(),BannerContent:$(".richText-editor").html(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+u},LinkURL:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtHyper").val()}};a&&(i.addClass("loading"),Object(f.c)(o,u,h,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)}))}else if("Image Gallery"==o){var y=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,c=document.getElementById("uploadImageFile"),b=c.files[0];$("#txtFolderName").val().trim()?$("#uploadImageFile").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Image"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Folder Name"),a=!1),a&&(i.addClass("loading"),s.a.sp.web.lists.getByTitle("Image Gallery").rootFolder.folders.add($("#txtFolderName").val()).then(function(e){s.a.sp.web.getFolderByServerRelativeUrl("Image Gallery/"+$("#txtFolderName").val()).files.add(b.name,b,!0).then(function(e){i.removeClass("loading"),window.history.back()})}))}else if("Video Gallery"==o){var y=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,c=document.getElementById("uploadVideoFile"),v=c.files[0],x=$("#uploadVideoFile").val().split(String.fromCharCode(92));$("#browsedVideofile").val(x[x.length-1]);var w=$("input[name='selectionradioImage']:checked").val();"Upload"==w&&($("#txtFolderName").val().trim()?$("#txtTitle").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please enter the Title"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please enter the Folder name"),a=!1),$("#uploadVideoFile").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Select the video File"),a=!1)),"Stream"==w&&($("#txtFolderName").val().trim()?$("#txtTitle").val().trim()?$("#txtHyper").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the URL"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please enter the Title"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please enter the Folder name"),a=!1)),a&&(i.addClass("loading"),s.a.sp.web.lists.getByTitle("Video Gallery").rootFolder.folders.add($("#txtFolderName").val()).then(function(e){if("Upload"==w){var t={Title:$("#txtTitle").val().trim()};s.a.sp.web.getFolderByServerRelativeUrl("Video Gallery/"+$("#txtFolderName").val()).files.add(v.name,v,!0).then(function(e){return e.file.getItem()}).then(function(e){return e.update(t)}).then(function(e){i.removeClass("loading"),window.history.back()})}else{var r={Title:$("#txtTitle").val(),LinkURL:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtHyper").val().trim()}};void 0!=$("#uploadImageFile").val()&&null!=$("#uploadImageFile").val()&&""!=$("#uploadImageFile").val()||$.ajax({url:n.context.pageContext.site.absoluteUrl+"/_api/web/getfilebyserverrelativeurl('/sites/spuat/_catalogs/masterpage/Bloom/images/logo.png')/openbinarystream",type:"GET",success:function(e){var t=$("#txtTitle").val().trim()+".jpg";s.a.sp.web.getFolderByServerRelativeUrl("Video Gallery/"+$("#txtFolderName").val()).files.add(t,e,!0).then(function(e){return e.file.getItem()}).then(function(e){return e.update(r)}).then(function(e){i.removeClass("loading"),window.history.back()})},error:function(e){console.log(e)}})}}))}else if("Organizational Policies"==o){var c=document.getElementById("uploadFile"),d=c.files[0];$("#txtTitle").val().trim()?"Select"==$("#ddlDepartment").val()?(alertify.set("notifier","position","top-right"),alertify.error("Please Select the Department"),a=!1):$(".richText-editor").text().trim()?$("#uploadFile").val().trim()||(alertify.set("notifier","position","top-right"),alertify.error("Please Select File"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Department Name"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Title"),a=!1);var g={Title:$("#txtTitle").val(),Departments:$("#txtDepartment").val(),Explanation:$(".richText-editor").html(),DocumentFile:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+d.name}};if(a){i.addClass("loading");var C=this;Object(f.c)(o,d.name,d,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),"Others"==$("#ddlDepartment").val()?C.AddDepartments():window.history.back()):console.log(e)})}}else if("Corporate Discounts"==o){var _=document.getElementById("uploadFile"),k=_.files[0],c=document.getElementById("inputImage"),d=c.files[0],y=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;if($("#txtTitle").val().trim()?$("#txtsitelink").val().trim()?y.test($("#txtsitelink").val().trim())?"block"==$("#canvasdisplay").css("display")&&(alertify.set("notifier","position","top-right"),alertify.error("Please Save Cropped Image"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter SiteLink Correctly"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter SiteLink"),a=!1):(alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1),a){var P=window.location.origin;if(i.addClass("loading"),0==c.files.length&&_.files.length>0){var F=Math.random().toString(36).substr(2,9)+".png";s.a.sp.web.getFolderByServerRelativeUrl("Shared Documents").files.add(k.name,k,!0).then(function(t){var n={Title:$("#txtTitle").val().trim(),SiteLink:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtsitelink").val().trim()},VendorLogo:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/_catalogs/masterpage/Bloom/images/logo.png"},DocumentFile:{__metadata:{type:"SP.FieldUrlValue"},Url:P+t.data.ServerRelativeUrl}};i.addClass("loading"),Object(f.c)(o,F,k,n,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)})})}else if(0==_.files.length&&c.files.length>0){var p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]),u=Math.random().toString(36).substr(2,9)+".png",g={Title:$("#txtTitle").val().trim(),SiteLink:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtsitelink").val().trim()},VendorLogo:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/"+o+"/"+u}};i.addClass("loading"),Object(f.c)(o,u,h,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)})}else if(0==c.files.length&&0==_.files.length){var g={Title:$("#txtTitle").val().trim(),SiteLink:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtsitelink").val().trim()},VendorLogo:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/_catalogs/masterpage/Bloom/images/logo.png"}};i.addClass("loading"),Object(f.c)(o,u,h,g,function(e){e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):console.log(e)})}else{var p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]),u=Math.random().toString(36).substr(2,9)+".png";s.a.sp.web.getFolderByServerRelativeUrl("Corporate Discounts").files.add(u,h,!0).then(function(e){e.file.listItemAllFields.get().then(function(t){s.a.sp.web.getFolderByServerRelativeUrl("Shared Documents").files.add(k.name,k,!0).then(function(n){s.a.sp.web.lists.getByTitle("Corporate Discounts").items.getById(t.Id).update({Title:$("#txtTitle").val().trim(),SiteLink:{__metadata:{type:"SP.FieldUrlValue"},Url:$("#txtsitelink").val().trim()},VendorLogo:{__metadata:{type:"SP.FieldUrlValue"},Url:P+e.data.ServerRelativeUrl},DocumentFile:{__metadata:{type:"SP.FieldUrlValue"},Url:P+n.data.ServerRelativeUrl}}).then(function(e){i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()})})})})}}}else if("Events"==r){var c=document.getElementById("inputImage"),d=c.files[0];if($("#txtTitle").val().trim())if($("#txtStartDate").val().trim()){if(Date.parse($("#txtStartDate").val().trim())>Date.parse($("#txtEndDate").val().trim()))return alertify.set("notifier","position","top-right"),alertify.error("Start date must be less than End date"),!1;"block"==$("#canvasdisplay").css("display")&&(alertify.set("notifier","position","top-right"),alertify.error("Please Save Cropped Image"),a=!1)}else alertify.set("notifier","position","top-right"),alertify.error("Please Select StartDate"),a=!1;else alertify.set("notifier","position","top-right"),alertify.error("Please Enter Title"),a=!1;if(a){var P=window.location.origin;if(i.addClass("loading"),c.files.length>0){var F=Math.random().toString(36).substr(2,9)+".png",p=$("#cropped-img").attr("src").split("base64,"),h=Object(f.d)(p[1]);s.a.sp.web.getFolderByServerRelativeUrl("Events").files.add(F,h,!0).then(function(t){t.file.listItemAllFields.get().then(function(t){s.a.sp.web.lists.getByTitle("Events").items.getById(t.Id).update({Title:$("#txtTitle").val().trim(),StartDate:new Date($("#txtStartDate").val()),EndDate:new Date($("#txtEndDate").val()),Explanation:$(".richText-editor").html(),ExplanationText:$(".richText-editor").text(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/Events/"+F}}).then(function(e){i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()})})})}else void 0!=$("#inputImage").val()&&null!=$("#inputImage").val()&&""!=$("#inputImage").val()||$.ajax({url:e+"/_api/web/getfilebyserverrelativeurl('"+l+"/_catalogs/masterpage/Bloom/images/logo.png')/openbinarystream",type:"GET",success:function(t){var n=Math.random().toString(36).substr(2,9)+".png";s.a.sp.web.getFolderByServerRelativeUrl("Events").files.add(n,t,!0).then(function(t){t.file.listItemAllFields.get().then(function(t){s.a.sp.web.lists.getByTitle("Events").items.getById(t.Id).update({Title:$("#txtTitle").val().trim(),StartDate:new Date($("#txtStartDate").val()),EndDate:new Date($("#txtEndDate").val()),Explanation:$(".richText-editor").html(),ExplanationText:$(".richText-editor").text(),Image:{__metadata:{type:"SP.FieldUrlValue"},Url:e+"/_catalogs/masterpage/Bloom/images/logo.png"}}).then(function(e){i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()})})})},error:function(e){i.removeClass("loading"),console.log(e)}})}}else if("Polls"==o){var T=$("#txtOptions").val(),D=T.split(";"),S=D.filter(function(e){return""!==e&&" "!==e});if($("#txtQuestion").val().trim()){if(!$("#txtOptions").val().trim()||S.length<2)alertify.set("notifier","position","top-right"),alertify.error("Minimum Two options needed"),a=!1;else if(!$("#txtOptions").val().trim()||S.length>4)return alertify.set("notifier","position","top-right"),alertify.error("Maximum Four Answers only Allowed"),!1}else alertify.set("notifier","position","top-right"),alertify.error("Please Enter Question"),a=!1;var O={Question:$("#txtQuestion").val().trim(),Options:$("#txtOptions").val().trim()};a&&(i.addClass("loading"),Object(f.b)("Polls",O,function(e){i.addClass("loading"),e.data?(i.removeClass("loading"),$(".addbutton").prop("disabled",!0),window.history.back()):(i.removeClass("loading"),console.log(e))}))}},t.prototype.AddDepartments=function(){return y(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e={Departments:$("#txtDepartment").val().trim()},[4,Object(f.b)("Departments",e,function(e){e.data?window.history.back():console.log(e)})];case 1:return t.sent(),[2]}})})},t.prototype.bindorgDept=function(){Object(f.f)("Departments",["ID","Departments"],1e3,"Modified","Display",1).then(function(e){var t=[],n="";n+="<option id='0' disabled selected>Select</option>";for(var i=0;i<e.length;i++)t.push({dept:e[i].Departments,id:e[i].ID}),n+="<option id='"+e[i].ID+"'>"+e[i].Departments+"</option>";n+="<option id='"+i+"1'>Others</option>",$("#ddlDepartment").append(n)}),$("#DivDepartment").hide(),$("#ddlDepartment").change(function(){$("#txtDepartment").val($(this).val()),"Others"==$(this).val()?($("#DivDepartment").show(),$("#txtDepartment").val("")):$("#DivDepartment").hide()})},t.prototype.bindgalleryImage=function(){var e=!0,t=this.context.pageContext.web.absoluteUrl,n=this;$("#txtTitle").keyup(function(i){$("#txtTitle").val()||(alertify.set("notifier","position","top-right"),alertify.error("Please Enter the Topic"),e=!1),e&&n.bindSearchTitle(t,e)})},t.prototype.bindSearchTitle=function(e,t){return y(this,void 0,void 0,function(){var e,n;return b(this,function(i){switch(i.label){case 0:return t?(e=["ID","FileLeafRef","FileSystemObjectType","FileDirRef"],[4,Object(f.f)("Image Gallery",e,5e3,"ID")]):[3,2];case 1:n=i.sent(),n.then(function(e){for(var t=n.length,i=0;i<t;i++)n[i].FileSystemObjectType}),i.label=2;case 2:return[2]}})})},t.prototype.validateVideoFileType=function(){var e=$("#uploadVideoFile").val(),t=e.lastIndexOf(".")+1,n=e.substr(t,e.length).toLowerCase();if("mp4"==n||"x-m4v"==n||"m4a"==n||"f4v"==n||"m4b"==n||"mov"==n||"f4b"==n||"flv"==n){var i=$("#uploadVideoFile").val().split(String.fromCharCode(92));$("#browsedfileName").val(i[i.length-1])}else $("#uploadVideoFile").val(null),$("#browsedfileName").val("");var i=$("#uploadVideoFile").val().split(String.fromCharCode(92));$("#browsedVideofile").val(i[i.length-1])},t.prototype.validateFileType=function(){var e=$("#uploadImageFile").val(),t=e.lastIndexOf(".")+1,n=e.substr(t,e.length).toLowerCase();if("jpg"==n||"jpeg"==n||"png"==n||"gif"==n||"bmp"==n||"tiff"==n){var i=$("#uploadImageFile").val().split(String.fromCharCode(92));$("#browsedfileName").val(i[i.length-1])}else $("#uploadImageFile").val(null),$("#browsedfileName").val("")},t.prototype.AddListItems=function(){var e=Object(f.a)("CName");e=e.split("%20").join(" ");var t="",n="",i="",r="",o="",a="",s="",l="",c="",d="",u="",p="",h="",g="",m="",y="",b="",v="",x="",w="",C="",_="",k="",P="",F="",T="",D="",S="",O="",e=Object(f.a)("CName");e=e.split("%20").join(" ");var A=$("input[name='selectionradio']:checked").val();"Holiday"==A?e="Holiday":"Events"==A&&(e="Events");var j=this.context.pageContext.web.absoluteUrl;S+="<div class='radio-btn appendOption'><div class='col-md-12 form-group'><label>Choose Component</label><div class='radio col-md-6'><input id='radio-1' name='selectionradio' type='radio' value='Events'><label for='radio-1' class='radio-label'>Events</label></div><div class='radio col-md-6'><input id='radio-2' name='selectionradio' type='radio' value='Holiday'><label for='radio-2' class='radio-label'>Holidays</label></div></div></div>",D+="<div class='radio-btn appendOptionImage'><div class='col-md-12 form-group'><label>Choose Component</label><div class='radio col-md-6'><input id='radio-3' name='selectionradioImage' type='radio' value='Upload'><label for='radio-3' class='radio-label'>Upload</label></div><div class='radio col-md-6'><input id='radio-4' name='selectionradioImage' type='radio' value='Stream'><label for='radio-4' class='radio-label'>Stream</label></div></div></div>",F+="<div class='form-imgsec'><div class='themelogo-upload'><label>Vendor Logo</label><img id='cropped-img' class='crapImagesevent crop-imagedisplay' src= "+j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg><div class='image-upload'><div class='custom-upload'><input type='file' id='inputImage' name='file' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple='' class='file' /><button class='btn btn-primary' type='button'><i class='icon-camera'></i></button></div><a href='' title='Delete' id='image-delete'><i class='icon-delete'></i></a></div></div></div>",i+="<div class='form-imgsec'><div class='themelogo-upload'><label class='control-label'>Image</label><img src="+j+"'/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg'><div class='image-upload' id='imagerestrict'><div class='custom-upload'><input type='file' id='inputImage' name='file' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple='' class='file' /><button class='btn btn-primary' type='button'><i class='icon-camera'></i></button></div><a href='#' title='Delete'><i class='icon-delete'></i></a></div></div>",w+="<div class='col-lg-6 col-md-6 col-sm-6 col-xs-12' id='canvasdisplay' style='display:none'><h4>Image Preview </h4><div class='btn-group-crop'><button type='button' class='btn btn-primary'id='btnCrop' ><i class='commonicon-save'></i>Save</button><button class='btn btn-primary crop-cancel' id='btnRestore' type='button'><i class='commonicon-close'></i>Cancel</button><canvas id='canvas'></canvas></div></div>",m+="<div class='form-imgsec'><div class='themelogo-upload'><label>Image</label><img id='cropped-img'  src="+j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg><div class='image-upload'><div class='custom-upload'><input type='file' id='inputImage' name='file' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple='' class='file' /><button class='btn btn-primary' type='button'><i class='icon-camera'></i></button></div><a href='#' title='Delete' id='image-delete'><i class='icon-delete'></i></a></div></div></div>",y+="<div class='form-imgsec'><div class='themelogo-upload'><label class='control-label'>Image</label><img id='cropped-img'  src="+j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg><div class='image-upload'><div class='custom-upload'><input type='file' id='inputImage' name='file' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple='' class='file' /><button class='btn btn-primary' type='button'><i class='icon-camera'></i></button></div><a href='#' title='Delete' id='image-delete'><i class='icon-delete'></i></a></div></div></div>",T+="<div class='form-imgsec'><a id='filetype' href='' download><img id='fileimg' src=''></a><div class='themelogo-upload' style='display: block;'><div class='custom-upload banner-upload'><label>Document File</label><input type='file' id='uploadFile' name='file' accept='.doc,.docx,.xls,.ppt,.pdf,.jpg' multiple='' class='file'><div class='input-group'><span class='input-group-btn input-group-sm'><button type='button' class='btn btn-fab btn-fab-mini'>Browse</button></span><input type='text' class='form-control' placeholder='Upload Files'></div></div></div></div>",P+="<div class='form-imgsec'><div class='themelogo-upload'><label class='control-label'>Image</label><img id='cropped-img' src="+j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg /><div class='image-upload'><div class='custom-upload'><input type='file' id='inputImage' name='file' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple='' class='file' /><button class='btn btn-primary' type='button'><i class='icon-camera'></i></button></div><a href='#' title='Delete' id='image-delete'><i class='icon-delete'></i></a></div></div></div>",r+="<div class='input text'><label class='control-label'>Title</label><input class='form-control' type='text' value=''  id='txtTitle' /></div>",o+="<div id='foldername' class='input text'><label class='control-label'>Folder Name</label><input class='form-control' type='text' value='' id='txtFolderName' /></div>",a+="<div class='input date'><i class='icon-calenter'></i><label class='control-label'>Date</label><input class='form-control date-selector' type='text' value='' id='txtExpires' /></div>",s+="<div id='descrption' class='input textarea'><label>Description</label><textarea class='form-control' id='txtDescription'></textarea></div>",k+="<div class='textarea input'><label>Description</label><textarea id='txtDescription' class='form-control content'></textarea></div>",l+="<div class='input date'><i class='icon-calenter'></i><label class='control-label'>Start Date</label><input class='form-control date-selector' type='text' value='' id='txtEvDate' /></div><div class='input date'><i class='icon-calenter'></i><label>End Date</label><input class='form-control date-selector' type='text' value='' id='txtEEDate' /></div>",c+="<div class='input text' id='divHyperLink'><label class='control-label'>Link URL</label><input class='form-control' type='text' value='' id='txtHyper' /><span>Please enter the Link URL in the following format : https://www.bloomholding.com</span></div>",d+="<div class='input text'><label>Link URL</label><input class='form-control' type='text' value='' id='txtHyper' /><label>Please given valid Announcements or Events URL</label></div>",u+="<div class='form-imgsec'><div class='themelogo-upload' style='display: block;'><div class='custom-upload banner-upload'><label class='control-label'>Document File</label><input type='file' id='uploadFile' name='file' accept='.doc,.docx,.xls,.ppt,.pdf' multiple='' class='file'><div class='input-group'><span class='input-group-btn input-group-sm'><button type='button' class='btn btn-fab btn-fab-mini'>Browse</button></span><input type='text' readonly='' class='form-control' placeholder='Upload Files'></div></div></div></div>",t+="<div class='form-imgsec'><div class='themelogo-upload' style='display: block;'><div class='custom-upload banner-upload'><label class='control-label'>Upload Image File</label><input type='file' id='uploadImageFile' name='image' accept='.jpg,.jpeg,.png,.gif,.bmp,.tiff' multiple=''   class='file'><div class='input-group'><span class='input-group-btn input-group-sm'><button type='button' class='btn btn-fab btn-fab-mini'>Browse</button></span><input type='text' id='browsedfileName' readonly='' class='form-control' placeholder='Upload Files'></div></div></div></div>",n+="<div class='form-imgsec'><div class='themelogo-upload' style='display: block;'><div class='custom-upload banner-upload'><label class='control-label'>Upload Video File</label><input type='file' id='uploadVideoFile' name='file' accept='video/mp4,video/x-m4v,video/*' multiple='' class='file'><div class='input-group'><span class='input-group-btn input-group-sm'><button type='button' class='btn btn-fab btn-fab-mini'>Browse</button></span><input type='text' id='browsedVideofile' readonly='' class='form-control' placeholder='Upload Files'></div></div></div></div>",p+="<div class='form-imgsec'><div class='themelogo-upload' style='display: block;'><label class='control-label'>DocumentFile</label><div class='custom-upload banner-upload'><input type='file' id='inputImage' name='file' accept='.pdf,.doc,.docx' multiple='' class='file'><div class='input-group'><span class='input-group-btn input-group-sm'><button type='button' class='btn btn-fab btn-fab-mini'>Browse</button></span><input type='text' readonly='' class='form-control' placeholder='Upload Files'></div></div></div></div>",h+="<div id='siteLink' class='input text'><i class=''></i><label class='control-label'>Site Link</label><input class='form-control' type='text' value='' id='txtsitelink'/><span>Please enter the Site Link in the following format : https://www.bloomholding.com</span></div>",g+="<div class='input date'><i class='icon-calenter'></i><label class='control-label'>Start Date</label><input class='form-control date-selector' type='text' value='' id='txtStartDate' /></div><div class='input date'><i class='icon-calenter'></i><label>End Date</label><input class='form-control date-selector' type='text' value='' id='txtEndDate' /></div>",b+="<div class='input textarea'><label class='control-label'>Question</label><textarea class='form-control' id='txtQuestion'></textarea></div>",v+="<div class='input text'><i class=''></i><label class='control-label'>Options</label><input class='form-control' type='text' value='' id='txtOptions'/><span>Please Enter more than one Options with semicolon ( ; ) Maximun four options</span></div>",x+="<div class='input text' id='DivDepartment'><i class=''></i><label class='control-label'>New Department</label><input class='form-control' type='text' value='' id='txtDepartment' autocomplete='off'/></div>",O+='<div class="input text"><label class="control-label">Department</label><select id="ddlDepartment" class="form-control"></select></div>',_+="<div class='textarea input'><label class='control-label'>Description</label><textarea id='txtrequiredDescription' class='form-control content'></textarea></div>",C+="<div id='rrdescription' class='input textarea'><label class='control-label'>Description</label><textarea class='form-control' id='txtrequiredDescription'></textarea></div>";var I=new Date,U=new Date(I.getFullYear(),I.getMonth(),I.getDate());if("Announcements"==e?($(".form-section").append(y),$(".form-imgsec").after(w),$("#canvasdisplay").after(a),$(".date").after(r),$(".text").after(_),$("#txtExpires").datepicker({format:"mm/dd/yyyy",startDate:U}).datepicker("setDate","new Date()")):"Holiday"==e?($(".form-section").append(S),$(".appendOption").after(m),$(".form-imgsec").after(w),$("#canvasdisplay").after(r),$(".text").after(C),$(".textarea").after(g),$("#txtStartDate").datepicker({Format:"yy/dd/mm",startDate:U}).datepicker("setDate","new Date()"),$("#txtEndDate").datepicker({Format:"yy/dd/mm",startDate:U})):"News"==e?($(".form-section").append(P),$(".form-imgsec").after(w),$("#canvasdisplay").after(a),$(".date").after(r),$(".text").after(C),$("#txtExpires").datepicker({format:"mm/dd/yyyy",startDate:U}).datepicker("setDate","new Date()")):"Quick Links"==e?($(".form-section").append(r),$(".text").after(c)):"Employee Corner"==e?($(".form-section").append(r),$(".text").after(u)):"Image Gallery"==e?($(".form-section").append(o),$(".text").after(t),this.bindgalleryImage()):"Video Gallery"==e?($(".form-section").append(D+o+r+n+c),$(".banner-upload").show(),$("#divHyperLink").hide()):"Organizational Policies"==e?($(".form-section").append(r),$(".text").after(O+x+u+k),this.bindorgDept()):"Banners"==e?($(".form-section").append(P),$(".form-imgsec").after(w),$("#canvasdisplay").after(r),$(".text").after(_),$(".textarea").after(d)):"Corporate Discounts"==e?($(".form-section").append(F),$(".form-imgsec").after(w),$("#canvasdisplay").after(r),$(".text").after(h),$("#siteLink").after(T)):"Events"==e?($(".form-section").append(S),$(".appendOption").after(m),$(".form-imgsec").after(w),$("#canvasdisplay").after(r),$(".text").after(k),$(".textarea").after(g),$("#txtStartDate").datepicker({Format:"yy/dd/mm",startDate:U}).datepicker("setDate","new Date()"),$("#txtEndDate").datepicker({Format:"yy/dd/mm",startDate:U})):"Polls"==e&&($(".form-section").append(b),$(".textarea").after(v)),$(".content").richText(),$(".date-selector").on("changeDate",function(e){$(this).datepicker("hide")}),$("#uploadFile").length>0&&$(document).on("change","#uploadFile",function(){var e=$(this).val().split(".");e=e[e.length-1].toLowerCase(),-1==$.inArray(e,["doc","docx","xls","csv","ppt","pdf"])?(alertify.set("notifier","position","top-right"),alertify.error("Please Select Valid File Format"),$("#uploadFile").val("")):$(this).parent(".custom-upload").find(".form-control").val($(this).val().replace(/C:\\fakepath\\/i,""))}),$("#image-delete").click(function(){window.location.origin;$("#cropped-img")[0].src==j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"?(alertify.set("notifier","position","top-right"),alertify.error("Please Upload the Image File")):$("#inputImage").length>0&&($("#cropped-img").removeClass("crop-imagedisplay"),$(".image-upload").css("width","103px"),$("#cropped-img").attr("src",j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"),$("#inputImage").val(""))}),$("#inputImage").length>0){var E=$("#canvas"),L=E.get(0).getContext("2d"),M=$("#cropped-img");$("#inputImage").change(function(){var e=!0,t=$(this).val().split(".");if(t=t[t.length-1].toLowerCase(),-1==$.inArray(t,["jpg","jpeg","png","gif","bmp","tiff"])&&($("#inputImage").val(""),e=!1),e)if(E.cropper("destroy"),this.files&&this.files[0])if(this.files[0].type.match(/^image\//)){var n=new FileReader;n.onload=function(e){var t=new Image;t.onload=function(){L.canvas.height=t.height,L.canvas.width=t.width,L.drawImage(t,0,0);E.cropper({aspectRatio:16/9,built:function(){var e=$(this).cropper("getImageData");$(this).cropper("setCropBoxData",{width:e.width,height:e.height,left:e.left,top:e.top})}})},t.src=e.target.result,$("#canvasdisplay").css("display","block")},n.readAsDataURL(this.files[0])}else alertify.set("notifier","position","top-right"),alertify.error("Invalid file type! Please select an image file.");else alertify.set("notifier","position","top-right"),alertify.error("No file(s) selected.")}),$("#btnCrop").click(function(){M.empty();var e=E.cropper("getCroppedCanvas").toDataURL("image/png");M.attr("class","crop-imagedisplay"),M.attr("src",e),$("#canvasdisplay").css("display","none"),E.cropper("reset"),M.empty()}),$("#btnRestore").click(function(){E.cropper("reset"),M.empty(),M.attr("src",j+"/_catalogs/masterpage/BloomHomepage/images/prof-img.jpg"),$("#canvasdisplay").css("display","none"),$("#inputImage").val("")})}},t.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:o.PropertyPaneDescription},groups:[{groupName:o.BasicGroupName,groupFields:[Object(i.PropertyPaneTextField)("description",{label:o.DescriptionFieldLabel})]}]}]}},t}(i.BaseClientSideWebPart);t.default=v},function(e,t){e.exports=i},function(e,t,n){var i,r;/*! alertifyjs - v1.11.1 - Mohammad Younes <Mohammad@alertifyjs.com> (http://alertifyjs.com) */
!function(n){"use strict";function o(e,t){e.className+=" "+t}function a(e,t){for(var n=e.className.split(" "),i=t.split(" "),r=0;r<i.length;r+=1){var o=n.indexOf(i[r]);o>-1&&n.splice(o,1)}e.className=n.join(" ")}function s(){return"rtl"===n.getComputedStyle(document.body).direction}function l(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}function c(){return document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft}function d(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function u(e){if(null===e)return e;var t;if(Array.isArray(e)){t=[];for(var n=0;n<e.length;n+=1)t.push(u(e[n]));return t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return t=new RegExp(e.source),t.global=e.global,t.ignoreCase=e.ignoreCase,t.multiline=e.multiline,t.lastIndex=e.lastIndex,t;if("object"==typeof e){t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=u(e[i]));return t}return e}function p(e,t){var n=e.elements.root;n.parentNode.removeChild(n),delete e.elements,e.settings=u(e.__settings),e.__init=t,delete e.__internal}function h(e,t){return function(){if(arguments.length>0){for(var n=[],i=0;i<arguments.length;i+=1)n.push(arguments[i]);return n.push(e),t.apply(e,n)}return t.apply(e,[null,e])}}function f(e,t){return{index:e,button:t,cancel:!1}}function g(e,t){if("function"==typeof t.get(e))return t.get(e).call(t)}function m(){function e(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function t(e){var t=i[e].dialog;return t&&"function"==typeof t.__init&&t.__init(t),t}function n(t,n,r,o){var a={dialog:null,factory:n};return void 0!==o&&(a.factory=function(){return e(new i[o].factory,new n)}),r||(a.dialog=e(new a.factory,_)),i[t]=a}var i={};return{defaults:b,dialog:function(i,r,o,a){if("function"!=typeof r)return t(i);if(this.hasOwnProperty(i))throw new Error("alertify.dialog: name already exists");var s=n(i,r,o,a);this[i]=o?function(){if(0===arguments.length)return s.dialog;var t=e(new s.factory,_);return t&&"function"==typeof t.__init&&t.__init(t),t.main.apply(t,arguments),t.show.apply(t)}:function(){if(s.dialog&&"function"==typeof s.dialog.__init&&s.dialog.__init(s.dialog),0===arguments.length)return s.dialog;var e=s.dialog;return e.main.apply(s.dialog,arguments),e.show.apply(s.dialog)}},closeAll:function(e){for(var t=v.slice(0),n=0;n<t.length;n+=1){var i=t[n];void 0!==e&&e===i||i.close()}},setting:function(e,n,i){if("notifier"===e)return k.setting(n,i);var r=t(e);return r?r.setting(n,i):void 0},set:function(e,t,n){return this.setting(e,t,n)},get:function(e,t){return this.setting(e,t)},notify:function(e,t,n,i){return k.create(t,i).push(e,n)},message:function(e,t,n){return k.create(null,n).push(e,t)},success:function(e,t,n){return k.create("success",n).push(e,t)},error:function(e,t,n){return k.create("error",n).push(e,t)},warning:function(e,t,n){return k.create("warning",n).push(e,t)},dismissAll:function(){k.dismissAll()}}}var y={ENTER:13,ESC:27,F1:112,F12:123,LEFT:37,RIGHT:39},b={autoReset:!0,basic:!1,closable:!0,closableByDimmer:!0,frameless:!1,maintainFocus:!0,maximizable:!0,modal:!0,movable:!0,moveBounded:!1,overflow:!0,padding:!0,pinnable:!0,pinned:!0,preventBodyShift:!1,resizable:!0,startMaximized:!1,transition:"pulse",notifier:{delay:5,position:"bottom-right",closeButton:!1},glossary:{title:"AlertifyJS",ok:"OK",cancel:"Cancel",acccpt:"Accept",deny:"Deny",confirm:"Confirm",decline:"Decline",close:"Close",maximize:"Maximize",restore:"Restore"},theme:{input:"ajs-input",ok:"ajs-ok",cancel:"ajs-cancel"}},v=[],x=function(){return document.addEventListener?function(e,t,n,i){e.addEventListener(t,n,!0===i)}:document.attachEvent?function(e,t,n){e.attachEvent("on"+t,n)}:void 0}(),w=function(){return document.removeEventListener?function(e,t,n,i){e.removeEventListener(t,n,!0===i)}:document.detachEvent?function(e,t,n){e.detachEvent("on"+t,n)}:void 0}(),C=function(){var e,t,n=!1,i={animation:"animationend",OAnimation:"oAnimationEnd oanimationend",msAnimation:"MSAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in i)if(void 0!==document.documentElement.style[e]){t=i[e],n=!0;break}return{type:t,supported:n}}(),_=function(){function e(e){if(!e.__internal){delete e.__init,e.__settings||(e.__settings=u(e.settings));var t;"function"==typeof e.setup?(t=e.setup(),t.options=t.options||{},t.focus=t.focus||{}):t={buttons:[],focus:{element:null,select:!1},options:{}},"object"!=typeof e.hooks&&(e.hooks={});var n=[];if(Array.isArray(t.buttons))for(var i=0;i<t.buttons.length;i+=1){var r=t.buttons[i],a={};for(var s in r)r.hasOwnProperty(s)&&(a[s]=r[s]);n.push(a)}var l=e.__internal={isOpen:!1,activeElement:document.body,timerIn:void 0,timerOut:void 0,buttons:n,focus:t.focus,options:{title:void 0,modal:void 0,basic:void 0,frameless:void 0,pinned:void 0,movable:void 0,moveBounded:void 0,resizable:void 0,autoReset:void 0,closable:void 0,closableByDimmer:void 0,maximizable:void 0,startMaximized:void 0,pinnable:void 0,transition:void 0,padding:void 0,overflow:void 0,onshow:void 0,onclosing:void 0,onclose:void 0,onfocus:void 0,onmove:void 0,onmoved:void 0,onresize:void 0,onresized:void 0,onmaximize:void 0,onmaximized:void 0,onrestore:void 0,onrestored:void 0},resetHandler:void 0,beginMoveHandler:void 0,beginResizeHandler:void 0,bringToFrontHandler:void 0,modalClickHandler:void 0,buttonsClickHandler:void 0,commandsClickHandler:void 0,transitionInHandler:void 0,transitionOutHandler:void 0,destroy:void 0},c={};c.root=document.createElement("div"),c.root.className=Se.base+" "+Se.hidden+" ",c.root.innerHTML=De.dimmer+De.modal,c.dimmer=c.root.firstChild,c.modal=c.root.lastChild,c.modal.innerHTML=De.dialog,c.dialog=c.modal.firstChild,c.dialog.innerHTML=De.reset+De.commands+De.header+De.body+De.footer+De.resizeHandle+De.reset,c.reset=[],c.reset.push(c.dialog.firstChild),c.reset.push(c.dialog.lastChild),c.commands={},c.commands.container=c.reset[0].nextSibling,c.commands.pin=c.commands.container.firstChild,c.commands.maximize=c.commands.pin.nextSibling,c.commands.close=c.commands.maximize.nextSibling,c.header=c.commands.container.nextSibling,c.body=c.header.nextSibling,c.body.innerHTML=De.content,c.content=c.body.firstChild,c.footer=c.body.nextSibling,c.footer.innerHTML=De.buttons.auxiliary+De.buttons.primary,c.resizeHandle=c.footer.nextSibling,c.buttons={},c.buttons.auxiliary=c.footer.firstChild,c.buttons.primary=c.buttons.auxiliary.nextSibling,c.buttons.primary.innerHTML=De.button,c.buttonTemplate=c.buttons.primary.firstChild,c.buttons.primary.removeChild(c.buttonTemplate);for(var d=0;d<e.__internal.buttons.length;d+=1){var p=e.__internal.buttons[d];ke.indexOf(p.key)<0&&ke.push(p.key),p.element=c.buttonTemplate.cloneNode(),p.element.innerHTML=p.text,"string"==typeof p.className&&""!==p.className&&o(p.element,p.className);for(var f in p.attrs)"className"!==f&&p.attrs.hasOwnProperty(f)&&p.element.setAttribute(f,p.attrs[f]);"auxiliary"===p.scope?c.buttons.auxiliary.appendChild(p.element):c.buttons.primary.appendChild(p.element)}e.elements=c,l.resetHandler=h(e,Y),l.beginMoveHandler=h(e,ee),l.beginResizeHandler=h(e,ae),l.bringToFrontHandler=h(e,T),l.modalClickHandler=h(e,z),l.buttonsClickHandler=h(e,V),l.commandsClickHandler=h(e,A),l.transitionInHandler=h(e,X),l.transitionOutHandler=h(e,J);for(var g in l.options)void 0!==t.options[g]?e.set(g,t.options[g]):P.defaults.hasOwnProperty(g)?e.set(g,P.defaults[g]):"title"===g&&e.set(g,P.defaults.glossary[g]);"function"==typeof e.build&&e.build()}document.body.appendChild(e.elements.root)}function t(){Ce=c(),_e=l()}function i(){n.scrollTo(Ce,_e)}function r(){for(var e=0,t=0;t<v.length;t+=1){var n=v[t];(n.isModal()||n.isMaximized())&&(e+=1)}0===e&&document.body.className.indexOf(Se.noOverflow)>=0?(a(document.body,Se.noOverflow),m(!1)):e>0&&document.body.className.indexOf(Se.noOverflow)<0&&(m(!0),o(document.body,Se.noOverflow))}function m(e){P.defaults.preventBodyShift&&document.documentElement.scrollHeight>document.documentElement.clientHeight&&(e?(Ae=_e,Oe=n.getComputedStyle(document.body).top,o(document.body,Se.fixed),document.body.style.top=-_e+"px"):(_e=Ae,document.body.style.top=Oe,a(document.body,Se.fixed),i()))}function b(e,t,n){"string"==typeof n&&a(e.elements.root,Se.prefix+n),o(e.elements.root,Se.prefix+t),Pe=e.elements.root.offsetWidth}function _(e){e.get("modal")?(a(e.elements.root,Se.modeless),e.isOpen()&&(ge(e),R(e),r())):(o(e.elements.root,Se.modeless),e.isOpen()&&(fe(e),R(e),r()))}function k(e){e.get("basic")?o(e.elements.root,Se.basic):a(e.elements.root,Se.basic)}function F(e){e.get("frameless")?o(e.elements.root,Se.frameless):a(e.elements.root,Se.frameless)}function T(e,t){for(var n=v.indexOf(t),i=n+1;i<v.length;i+=1)if(v[i].isModal())return;return document.body.lastChild!==t.elements.root&&(document.body.appendChild(t.elements.root),v.splice(v.indexOf(t),1),v.push(t),G(t)),!1}function D(e,t,n,i){switch(t){case"title":e.setHeader(i);break;case"modal":_(e);break;case"basic":k(e);break;case"frameless":F(e);break;case"pinned":N(e);break;case"closable":H(e);break;case"maximizable":$(e);break;case"pinnable":L(e);break;case"movable":re(e);break;case"resizable":de(e);break;case"padding":i?a(e.elements.root,Se.noPadding):e.elements.root.className.indexOf(Se.noPadding)<0&&o(e.elements.root,Se.noPadding);break;case"overflow":i?a(e.elements.root,Se.noOverflow):e.elements.root.className.indexOf(Se.noOverflow)<0&&o(e.elements.root,Se.noOverflow);break;case"transition":b(e,i,n)}"function"==typeof e.hooks.onupdate&&e.hooks.onupdate.call(e,t,n,i)}function S(e,t,n,i,r){var o={op:void 0,items:[]};if(void 0===r&&"string"==typeof i)o.op="get",t.hasOwnProperty(i)?(o.found=!0,o.value=t[i]):(o.found=!1,o.value=void 0);else{var a;if(o.op="set","object"==typeof i){var s=i;for(var l in s)t.hasOwnProperty(l)?(t[l]!==s[l]&&(a=t[l],t[l]=s[l],n.call(e,l,a,s[l])),o.items.push({key:l,value:s[l],found:!0})):o.items.push({key:l,value:s[l],found:!1})}else{if("string"!=typeof i)throw new Error("args must be a string or object");t.hasOwnProperty(i)?(t[i]!==r&&(a=t[i],t[i]=r,n.call(e,i,a,r)),o.items.push({key:i,value:r,found:!0})):o.items.push({key:i,value:r,found:!1})}}return o}function O(e){var t;Q(e,function(e){return t=!0===e.invokeOnClose}),!t&&e.isOpen()&&e.close()}function A(e,t){switch(e.srcElement||e.target){case t.elements.commands.pin:t.isPinned()?I(t):j(t);break;case t.elements.commands.maximize:t.isMaximized()?E(t):U(t);break;case t.elements.commands.close:O(t)}return!1}function j(e){e.set("pinned",!0)}function I(e){e.set("pinned",!1)}function U(e){g("onmaximize",e),o(e.elements.root,Se.maximized),e.isOpen()&&r(),g("onmaximized",e)}function E(e){g("onrestore",e),a(e.elements.root,Se.maximized),e.isOpen()&&r(),g("onrestored",e)}function L(e){e.get("pinnable")?o(e.elements.root,Se.pinnable):a(e.elements.root,Se.pinnable)}function M(e){var t=c();e.elements.modal.style.marginTop=l()+"px",e.elements.modal.style.marginLeft=t+"px",e.elements.modal.style.marginRight=-t+"px"}function B(e){var t=parseInt(e.elements.modal.style.marginTop,10),n=parseInt(e.elements.modal.style.marginLeft,10);if(e.elements.modal.style.marginTop="",e.elements.modal.style.marginLeft="",e.elements.modal.style.marginRight="",e.isOpen()){var i=0,r=0;""!==e.elements.dialog.style.top&&(i=parseInt(e.elements.dialog.style.top,10)),e.elements.dialog.style.top=i+(t-l())+"px",""!==e.elements.dialog.style.left&&(r=parseInt(e.elements.dialog.style.left,10)),e.elements.dialog.style.left=r+(n-c())+"px"}}function R(e){e.get("modal")||e.get("pinned")?B(e):M(e)}function N(e){e.get("pinned")?(a(e.elements.root,Se.unpinned),e.isOpen()&&B(e)):(o(e.elements.root,Se.unpinned),e.isOpen()&&!e.isModal()&&M(e))}function $(e){e.get("maximizable")?o(e.elements.root,Se.maximizable):a(e.elements.root,Se.maximizable)}function H(e){e.get("closable")?(o(e.elements.root,Se.closable),xe(e)):(a(e.elements.root,Se.closable),we(e))}function z(e,t){var n=e.srcElement||e.target;return je||n!==t.elements.modal||!0!==t.get("closableByDimmer")||O(t),je=!1,!1}function Q(e,t){for(var n=0;n<e.__internal.buttons.length;n+=1){var i=e.__internal.buttons[n];if(!i.element.disabled&&t(i)){var r=f(n,i);"function"==typeof e.callback&&e.callback.apply(e,[r]),!1===r.cancel&&e.close();break}}}function V(e,t){var n=e.srcElement||e.target;Q(t,function(e){return e.element===n&&(Ie=!0)})}function W(e){if(Ie)return void(Ie=!1);var t=v[v.length-1],n=e.keyCode;return 0===t.__internal.buttons.length&&n===y.ESC&&!0===t.get("closable")?(O(t),!1):ke.indexOf(n)>-1?(Q(t,function(e){return e.key===n}),!1):void 0}function q(e){var t=v[v.length-1],n=e.keyCode;if(n===y.LEFT||n===y.RIGHT){for(var i=t.__internal.buttons,r=0;r<i.length;r+=1)if(document.activeElement===i[r].element)switch(n){case y.LEFT:return void i[(r||i.length)-1].element.focus();case y.RIGHT:return void i[(r+1)%i.length].element.focus()}}else if(n<y.F12+1&&n>y.F1-1&&ke.indexOf(n)>-1)return e.preventDefault(),e.stopPropagation(),Q(t,function(e){return e.key===n}),!1}function G(e,t){if(t)t.focus();else{var n=e.__internal.focus,i=n.element;switch(typeof n.element){case"number":e.__internal.buttons.length>n.element&&(i=!0===e.get("basic")?e.elements.reset[0]:e.__internal.buttons[n.element].element);break;case"string":i=e.elements.body.querySelector(n.element);break;case"function":i=n.element.call(e)}void 0!==i&&null!==i||0!==e.__internal.buttons.length||(i=e.elements.reset[0]),i&&i.focus&&(i.focus(),n.select&&i.select&&i.select())}}function Y(e,t){if(!t)for(var n=v.length-1;n>-1;n-=1)if(v[n].isModal()){t=v[n];break}if(t&&t.isModal()){var i,r=e.srcElement||e.target,o=r===t.elements.reset[1]||0===t.__internal.buttons.length&&r===document.body;o&&(t.get("maximizable")?i=t.elements.commands.maximize:t.get("closable")&&(i=t.elements.commands.close)),void 0===i&&("number"==typeof t.__internal.focus.element?r===t.elements.reset[0]?i=t.elements.buttons.auxiliary.firstChild||t.elements.buttons.primary.firstChild:o&&(i=t.elements.reset[0]):r===t.elements.reset[0]&&(i=t.elements.buttons.primary.lastChild||t.elements.buttons.auxiliary.lastChild)),G(t,i)}}function X(e,t){clearTimeout(t.__internal.timerIn),G(t),i(),Ie=!1,g("onfocus",t),w(t.elements.dialog,C.type,t.__internal.transitionInHandler),a(t.elements.root,Se.animationIn)}function J(e,t){clearTimeout(t.__internal.timerOut),w(t.elements.dialog,C.type,t.__internal.transitionOutHandler),ie(t),ce(t),t.isMaximized()&&!t.get("startMaximized")&&E(t),P.defaults.maintainFocus&&t.__internal.activeElement&&(t.__internal.activeElement.focus(),t.__internal.activeElement=null),"function"==typeof t.__internal.destroy&&t.__internal.destroy.apply(t)}function K(e,t){var n=e[Me]-Ee,i=e[Be]-Le;Ne&&(i-=document.body.scrollTop),t.style.left=n+"px",t.style.top=i+"px"}function Z(e,t){var n=e[Me]-Ee,i=e[Be]-Le;Ne&&(i-=document.body.scrollTop),t.style.left=Math.min(Re.maxLeft,Math.max(Re.minLeft,n))+"px",t.style.top=Ne?Math.min(Re.maxTop,Math.max(Re.minTop,i))+"px":Math.max(Re.minTop,i)+"px"}function ee(e,t){if(null===He&&!t.isMaximized()&&t.get("movable")){var n,i=0,r=0;if("touchstart"===e.type?(e.preventDefault(),n=e.targetTouches[0],Me="clientX",Be="clientY"):0===e.button&&(n=e),n){var a=t.elements.dialog;if(o(a,Se.capture),a.style.left&&(i=parseInt(a.style.left,10)),a.style.top&&(r=parseInt(a.style.top,10)),Ee=n[Me]-i,Le=n[Be]-r,t.isModal()?Le+=t.elements.modal.scrollTop:t.isPinned()&&(Le-=document.body.scrollTop),t.get("moveBounded")){var s=a,l=-i,c=-r;do{l+=s.offsetLeft,c+=s.offsetTop}while(s=s.offsetParent);Re={maxLeft:l,minLeft:-l,maxTop:document.documentElement.clientHeight-a.clientHeight-c,minTop:-c},$e=Z}else Re=null,$e=K;return g("onmove",t),Ne=!t.isModal()&&t.isPinned(),Ue=t,$e(n,a),o(document.body,Se.noSelection),!1}}}function te(e){if(Ue){var t;"touchmove"===e.type?(e.preventDefault(),t=e.targetTouches[0]):0===e.button&&(t=e),t&&$e(t,Ue.elements.dialog)}}function ne(){if(Ue){var e=Ue;Ue=Re=null,a(document.body,Se.noSelection),a(e.elements.dialog,Se.capture),g("onmoved",e)}}function ie(e){Ue=null;var t=e.elements.dialog;t.style.left=t.style.top=""}function re(e){e.get("movable")?(o(e.elements.root,Se.movable),e.isOpen()&&me(e)):(ie(e),a(e.elements.root,Se.movable),e.isOpen()&&ye(e))}function oe(e,t,n){var i=t,r=0,o=0;do{r+=i.offsetLeft,o+=i.offsetTop}while(i=i.offsetParent);var a,l;!0===n?(a=e.pageX,l=e.pageY):(a=e.clientX,l=e.clientY);var c=s();if(c&&(a=document.body.offsetWidth-a,isNaN(ze)||(r=document.body.offsetWidth-r-t.offsetWidth)),t.style.height=l-o+We+"px",t.style.width=a-r+We+"px",!isNaN(ze)){var d=.5*Math.abs(t.offsetWidth-Qe);c&&(d*=-1),t.offsetWidth>Qe?t.style.left=ze+d+"px":t.offsetWidth>=Ve&&(t.style.left=ze-d+"px")}}function ae(e,t){if(!t.isMaximized()){var n;if("touchstart"===e.type?(e.preventDefault(),n=e.targetTouches[0]):0===e.button&&(n=e),n){g("onresize",t),He=t,We=t.elements.resizeHandle.offsetHeight/2;var i=t.elements.dialog;return o(i,Se.capture),ze=parseInt(i.style.left,10),i.style.height=i.offsetHeight+"px",i.style.minHeight=t.elements.header.offsetHeight+t.elements.footer.offsetHeight+"px",i.style.width=(Qe=i.offsetWidth)+"px","none"!==i.style.maxWidth&&(i.style.minWidth=(Ve=i.offsetWidth)+"px"),i.style.maxWidth="none",o(document.body,Se.noSelection),!1}}}function se(e){if(He){var t;"touchmove"===e.type?(e.preventDefault(),t=e.targetTouches[0]):0===e.button&&(t=e),t&&oe(t,He.elements.dialog,!He.get("modal")&&!He.get("pinned"))}}function le(){if(He){var e=He;He=null,a(document.body,Se.noSelection),a(e.elements.dialog,Se.capture),je=!0,g("onresized",e)}}function ce(e){He=null;var t=e.elements.dialog;"none"===t.style.maxWidth&&(t.style.maxWidth=t.style.minWidth=t.style.width=t.style.height=t.style.minHeight=t.style.left="",ze=Number.Nan,Qe=Ve=We=0)}function de(e){e.get("resizable")?(o(e.elements.root,Se.resizable),e.isOpen()&&be(e)):(ce(e),a(e.elements.root,Se.resizable),e.isOpen()&&ve(e))}function ue(){for(var e=0;e<v.length;e+=1){var t=v[e];t.get("autoReset")&&(ie(t),ce(t))}}function pe(e){1===v.length&&(x(n,"resize",ue),x(document.body,"keyup",W),x(document.body,"keydown",q),x(document.body,"focus",Y),x(document.documentElement,"mousemove",te),x(document.documentElement,"touchmove",te),x(document.documentElement,"mouseup",ne),x(document.documentElement,"touchend",ne),x(document.documentElement,"mousemove",se),x(document.documentElement,"touchmove",se),x(document.documentElement,"mouseup",le),x(document.documentElement,"touchend",le)),x(e.elements.commands.container,"click",e.__internal.commandsClickHandler),x(e.elements.footer,"click",e.__internal.buttonsClickHandler),x(e.elements.reset[0],"focus",e.__internal.resetHandler),x(e.elements.reset[1],"focus",e.__internal.resetHandler),Ie=!0,x(e.elements.dialog,C.type,e.__internal.transitionInHandler),e.get("modal")||fe(e),e.get("resizable")&&be(e),e.get("movable")&&me(e)}function he(e){1===v.length&&(w(n,"resize",ue),w(document.body,"keyup",W),w(document.body,"keydown",q),w(document.body,"focus",Y),w(document.documentElement,"mousemove",te),w(document.documentElement,"mouseup",ne),w(document.documentElement,"mousemove",se),w(document.documentElement,"mouseup",le)),w(e.elements.commands.container,"click",e.__internal.commandsClickHandler),w(e.elements.footer,"click",e.__internal.buttonsClickHandler),w(e.elements.reset[0],"focus",e.__internal.resetHandler),w(e.elements.reset[1],"focus",e.__internal.resetHandler),x(e.elements.dialog,C.type,e.__internal.transitionOutHandler),e.get("modal")||ge(e),e.get("movable")&&ye(e),e.get("resizable")&&ve(e)}function fe(e){x(e.elements.dialog,"focus",e.__internal.bringToFrontHandler,!0)}function ge(e){w(e.elements.dialog,"focus",e.__internal.bringToFrontHandler,!0)}function me(e){x(e.elements.header,"mousedown",e.__internal.beginMoveHandler),x(e.elements.header,"touchstart",e.__internal.beginMoveHandler)}function ye(e){w(e.elements.header,"mousedown",e.__internal.beginMoveHandler),w(e.elements.header,"touchstart",e.__internal.beginMoveHandler)}function be(e){x(e.elements.resizeHandle,"mousedown",e.__internal.beginResizeHandler),x(e.elements.resizeHandle,"touchstart",e.__internal.beginResizeHandler)}function ve(e){w(e.elements.resizeHandle,"mousedown",e.__internal.beginResizeHandler),w(e.elements.resizeHandle,"touchstart",e.__internal.beginResizeHandler)}function xe(e){x(e.elements.modal,"click",e.__internal.modalClickHandler)}function we(e){w(e.elements.modal,"click",e.__internal.modalClickHandler)}var Ce,_e,ke=[],Pe=null,Fe=!1,Te=n.navigator.userAgent.indexOf("Safari")>-1&&n.navigator.userAgent.indexOf("Chrome")<0,De={dimmer:'<div class="ajs-dimmer"></div>',modal:'<div class="ajs-modal" tabindex="0"></div>',dialog:'<div class="ajs-dialog" tabindex="0"></div>',reset:'<button class="ajs-reset"></button>',commands:'<div class="ajs-commands"><button class="ajs-pin"></button><button class="ajs-maximize"></button><button class="ajs-close"></button></div>',header:'<div class="ajs-header"></div>',body:'<div class="ajs-body"></div>',content:'<div class="ajs-content"></div>',footer:'<div class="ajs-footer"></div>',buttons:{primary:'<div class="ajs-primary ajs-buttons"></div>',auxiliary:'<div class="ajs-auxiliary ajs-buttons"></div>'},button:'<button class="ajs-button"></button>',resizeHandle:'<div class="ajs-handle"></div>'},Se={animationIn:"ajs-in",animationOut:"ajs-out",base:"alertify",basic:"ajs-basic",capture:"ajs-capture",closable:"ajs-closable",fixed:"ajs-fixed",frameless:"ajs-frameless",hidden:"ajs-hidden",maximize:"ajs-maximize",maximized:"ajs-maximized",maximizable:"ajs-maximizable",modeless:"ajs-modeless",movable:"ajs-movable",noSelection:"ajs-no-selection",noOverflow:"ajs-no-overflow",noPadding:"ajs-no-padding",pin:"ajs-pin",pinnable:"ajs-pinnable",prefix:"ajs-",resizable:"ajs-resizable",restore:"ajs-restore",shake:"ajs-shake",unpinned:"ajs-unpinned"},Oe="",Ae=0,je=!1,Ie=!1,Ue=null,Ee=0,Le=0,Me="pageX",Be="pageY",Re=null,Ne=!1,$e=null,He=null,ze=Number.Nan,Qe=0,Ve=0,We=0;return{__init:e,isOpen:function(){return this.__internal.isOpen},isModal:function(){return this.elements.root.className.indexOf(Se.modeless)<0},isMaximized:function(){return this.elements.root.className.indexOf(Se.maximized)>-1},isPinned:function(){return this.elements.root.className.indexOf(Se.unpinned)<0},maximize:function(){return this.isMaximized()||U(this),this},restore:function(){return this.isMaximized()&&E(this),this},pin:function(){return this.isPinned()||j(this),this},unpin:function(){return this.isPinned()&&I(this),this},bringToFront:function(){return T(null,this),this},moveTo:function(e,t){if(!isNaN(e)&&!isNaN(t)){g("onmove",this);var n=this.elements.dialog,i=n,r=0,o=0;n.style.left&&(r-=parseInt(n.style.left,10)),n.style.top&&(o-=parseInt(n.style.top,10));do{r+=i.offsetLeft,o+=i.offsetTop}while(i=i.offsetParent);var a=e-r,l=t-o;s()&&(a*=-1),n.style.left=a+"px",n.style.top=l+"px",g("onmoved",this)}return this},resizeTo:function(e,t){var n=parseFloat(e),i=parseFloat(t),r=/(\d*\.\d+|\d+)%/;if(!isNaN(n)&&!isNaN(i)&&!0===this.get("resizable")){g("onresize",this),(""+e).match(r)&&(n=n/100*document.documentElement.clientWidth),(""+t).match(r)&&(i=i/100*document.documentElement.clientHeight);var o=this.elements.dialog;"none"!==o.style.maxWidth&&(o.style.minWidth=(Ve=o.offsetWidth)+"px"),o.style.maxWidth="none",o.style.minHeight=this.elements.header.offsetHeight+this.elements.footer.offsetHeight+"px",o.style.width=n+"px",o.style.height=i+"px",g("onresized",this)}return this},setting:function(e,t){var n=this,i=S(this,this.__internal.options,function(e,t,i){D(n,e,t,i)},e,t);if("get"===i.op)return i.found?i.value:void 0!==this.settings?S(this,this.settings,this.settingUpdated||function(){},e,t).value:void 0;if("set"===i.op){if(i.items.length>0)for(var r=this.settingUpdated||function(){},o=0;o<i.items.length;o+=1){var a=i.items[o];a.found||void 0===this.settings||S(this,this.settings,r,a.key,a.value)}return this}},set:function(e,t){return this.setting(e,t),this},get:function(e){return this.setting(e)},setHeader:function(e){return"string"==typeof e?(d(this.elements.header),this.elements.header.innerHTML=e):e instanceof n.HTMLElement&&this.elements.header.firstChild!==e&&(d(this.elements.header),this.elements.header.appendChild(e)),this},setContent:function(e){return"string"==typeof e?(d(this.elements.content),this.elements.content.innerHTML=e):e instanceof n.HTMLElement&&this.elements.content.firstChild!==e&&(d(this.elements.content),this.elements.content.appendChild(e)),this},showModal:function(e){return this.show(!0,e)},show:function(n,i){if(e(this),this.__internal.isOpen){ie(this),ce(this),o(this.elements.dialog,Se.shake);var s=this;setTimeout(function(){a(s.elements.dialog,Se.shake)},200)}else{if(this.__internal.isOpen=!0,v.push(this),P.defaults.maintainFocus&&(this.__internal.activeElement=document.activeElement),document.body.hasAttribute("tabindex")||document.body.setAttribute("tabindex",Fe="0"),"function"==typeof this.prepare&&this.prepare(),pe(this),void 0!==n&&this.set("modal",n),t(),r(),"string"==typeof i&&""!==i&&(this.__internal.className=i,o(this.elements.root,i)),this.get("startMaximized")?this.maximize():this.isMaximized()&&E(this),R(this),a(this.elements.root,Se.animationOut),o(this.elements.root,Se.animationIn),clearTimeout(this.__internal.timerIn),this.__internal.timerIn=setTimeout(this.__internal.transitionInHandler,C.supported?1e3:100),Te){var l=this.elements.root;l.style.display="none",setTimeout(function(){l.style.display="block"},0)}Pe=this.elements.root.offsetWidth,a(this.elements.root,Se.hidden),"function"==typeof this.hooks.onshow&&this.hooks.onshow.call(this),g("onshow",this)}return this},close:function(){return this.__internal.isOpen&&!1!==g("onclosing",this)&&(he(this),a(this.elements.root,Se.animationIn),o(this.elements.root,Se.animationOut),clearTimeout(this.__internal.timerOut),this.__internal.timerOut=setTimeout(this.__internal.transitionOutHandler,C.supported?1e3:100),o(this.elements.root,Se.hidden),Pe=this.elements.modal.offsetWidth,void 0!==this.__internal.className&&""!==this.__internal.className&&a(this.elements.root,this.__internal.className),"function"==typeof this.hooks.onclose&&this.hooks.onclose.call(this),g("onclose",this),v.splice(v.indexOf(this),1),this.__internal.isOpen=!1,r()),v.length||"0"!==Fe||document.body.removeAttribute("tabindex"),this},closeOthers:function(){return P.closeAll(this),this},destroy:function(){return this.__internal.isOpen?(this.__internal.destroy=function(){p(this,e)},this.close()):p(this,e),this}}}(),k=function(){function e(e){e.__internal||(e.__internal={position:P.defaults.notifier.position,delay:P.defaults.notifier.delay},c=document.createElement("DIV"),r(e)),c.parentNode!==document.body&&document.body.appendChild(c)}function t(e){e.__internal.pushed=!0,u.push(e)}function i(e){u.splice(u.indexOf(e),1),e.__internal.pushed=!1}function r(e){switch(c.className=p.base,e.__internal.position){case"top-right":o(c,p.top+" "+p.right);break;case"top-left":o(c,p.top+" "+p.left);break;case"top-center":o(c,p.top+" "+p.center);break;case"bottom-left":o(c,p.bottom+" "+p.left);break;case"bottom-center":o(c,p.bottom+" "+p.center);break;default:case"bottom-right":o(c,p.bottom+" "+p.right)}}function s(e,r){function s(e,t){t.__internal.closeButton&&"true"!==e.target.getAttribute("data-close")||t.dismiss(!0)}function u(e,t){w(t.element,C.type,u),c.removeChild(t.element)}function f(e){clearTimeout(e.__internal.timer),clearTimeout(e.__internal.transitionTimeout)}return function(e){return e.__internal||(e.__internal={pushed:!1,delay:void 0,timer:void 0,clickHandler:void 0,transitionEndHandler:void 0,transitionTimeout:void 0},e.__internal.clickHandler=h(e,s),e.__internal.transitionEndHandler=h(e,u)),e}({element:e,push:function(e,n){if(!this.__internal.pushed){t(this),f(this);var i,r;switch(arguments.length){case 0:r=this.__internal.delay;break;case 1:"number"==typeof e?r=e:(i=e,r=this.__internal.delay);break;case 2:i=e,r=n}return this.__internal.closeButton=P.defaults.notifier.closeButton,void 0!==i&&this.setContent(i),k.__internal.position.indexOf("top")<0?c.appendChild(this.element):c.insertBefore(this.element,c.firstChild),l=this.element.offsetWidth,o(this.element,p.visible),x(this.element,"click",this.__internal.clickHandler),this.delay(r)}return this},ondismiss:function(){},callback:r,dismiss:function(e){return this.__internal.pushed&&(f(this),"function"==typeof this.ondismiss&&!1===this.ondismiss.call(this)||(w(this.element,"click",this.__internal.clickHandler),void 0!==this.element&&this.element.parentNode===c&&(this.__internal.transitionTimeout=setTimeout(this.__internal.transitionEndHandler,C.supported?1e3:100),a(this.element,p.visible),"function"==typeof this.callback&&this.callback.call(this,e)),i(this))),this},delay:function(e){if(f(this),this.__internal.delay=void 0===e||isNaN(+e)?k.__internal.delay:+e,this.__internal.delay>0){var t=this;this.__internal.timer=setTimeout(function(){t.dismiss()},1e3*this.__internal.delay)}return this},setContent:function(e){if("string"==typeof e?(d(this.element),this.element.innerHTML=e):e instanceof n.HTMLElement&&this.element.firstChild!==e&&(d(this.element),this.element.appendChild(e)),this.__internal.closeButton){var t=document.createElement("span");o(t,p.close),t.setAttribute("data-close",!0),this.element.appendChild(t)}return this},dismissOthers:function(){return k.dismissAll(this),this}})}var l,c,u=[],p={base:"alertify-notifier",message:"ajs-message",top:"ajs-top",right:"ajs-right",bottom:"ajs-bottom",left:"ajs-left",center:"ajs-center",visible:"ajs-visible",hidden:"ajs-hidden",close:"ajs-close"};return{setting:function(t,n){if(e(this),void 0===n)return this.__internal[t];switch(t){case"position":this.__internal.position=n,r(this);break;case"delay":this.__internal.delay=n}return this},set:function(e,t){return this.setting(e,t),this},get:function(e){return this.setting(e)},create:function(t,n){e(this);var i=document.createElement("div");return i.className=p.message+("string"==typeof t&&""!==t?" ajs-"+t:""),s(i,n)},dismissAll:function(e){for(var t=u.slice(0),n=0;n<t.length;n+=1){var i=t[n];void 0!==e&&e===i||i.dismiss()}}}}(),P=new m;P.dialog("alert",function(){return{main:function(e,t,n){var i,r,o;switch(arguments.length){case 1:r=e;break;case 2:"function"==typeof t?(r=e,o=t):(i=e,r=t);break;case 3:i=e,r=t,o=n}return this.set("title",i),this.set("message",r),this.set("onok",o),this},setup:function(){return{buttons:[{text:P.defaults.glossary.ok,key:y.ESC,invokeOnClose:!0,className:P.defaults.theme.ok}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},build:function(){},prepare:function(){},setMessage:function(e){this.setContent(e)},settings:{message:void 0,onok:void 0,label:void 0},settingUpdated:function(e,t,n){switch(e){case"message":this.setMessage(n);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=n)}},callback:function(e){if("function"==typeof this.get("onok")){var t=this.get("onok").call(this,e);void 0!==t&&(e.cancel=!t)}}}}),P.dialog("confirm",function(){function e(e){null!==n.timer&&(clearInterval(n.timer),n.timer=null,e.__internal.buttons[n.index].element.innerHTML=n.text)}function t(t,i,r){e(t),n.duration=r,n.index=i,n.text=t.__internal.buttons[i].element.innerHTML,n.timer=setInterval(h(t,n.task),1e3),n.task(null,t)}var n={timer:null,index:null,text:null,duration:null,task:function(t,i){if(i.isOpen()){if(i.__internal.buttons[n.index].element.innerHTML=n.text+" (&#8207;"+n.duration+"&#8207;) ",n.duration-=1,-1===n.duration){e(i);var r=i.__internal.buttons[n.index],o=f(n.index,r);"function"==typeof i.callback&&i.callback.apply(i,[o]),!1!==o.close&&i.close()}}else e(i)}};return{main:function(e,t,n,i){var r,o,a,s;switch(arguments.length){case 1:o=e;break;case 2:o=e,a=t;break;case 3:o=e,a=t,s=n;break;case 4:r=e,o=t,a=n,s=i}return this.set("title",r),this.set("message",o),this.set("onok",a),this.set("oncancel",s),this},setup:function(){return{buttons:[{text:P.defaults.glossary.ok,key:y.ENTER,className:P.defaults.theme.ok},{text:P.defaults.glossary.cancel,key:y.ESC,invokeOnClose:!0,className:P.defaults.theme.cancel}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},build:function(){},prepare:function(){},setMessage:function(e){this.setContent(e)},settings:{message:null,labels:null,onok:null,oncancel:null,defaultFocus:null,reverseButtons:null},settingUpdated:function(e,t,n){switch(e){case"message":this.setMessage(n);break;case"labels":"ok"in n&&this.__internal.buttons[0].element&&(this.__internal.buttons[0].text=n.ok,this.__internal.buttons[0].element.innerHTML=n.ok),"cancel"in n&&this.__internal.buttons[1].element&&(this.__internal.buttons[1].text=n.cancel,this.__internal.buttons[1].element.innerHTML=n.cancel);break;case"reverseButtons":!0===n?this.elements.buttons.primary.appendChild(this.__internal.buttons[0].element):this.elements.buttons.primary.appendChild(this.__internal.buttons[1].element);break;case"defaultFocus":this.__internal.focus.element="ok"===n?0:1}},callback:function(t){e(this);var n;switch(t.index){case 0:"function"==typeof this.get("onok")&&void 0!==(n=this.get("onok").call(this,t))&&(t.cancel=!n);break;case 1:"function"==typeof this.get("oncancel")&&void 0!==(n=this.get("oncancel").call(this,t))&&(t.cancel=!n)}},autoOk:function(e){return t(this,0,e),this},autoCancel:function(e){return t(this,1,e),this}}}),P.dialog("prompt",function(){var e=document.createElement("INPUT"),t=document.createElement("P");return{main:function(e,t,n,i,r){var o,a,s,l,c;switch(arguments.length){case 1:a=e;break;case 2:a=e,s=t;break;case 3:a=e,s=t,l=n;break;case 4:a=e,s=t,l=n,c=i;break;case 5:o=e,a=t,s=n,l=i,c=r}return this.set("title",o),this.set("message",a),this.set("value",s),this.set("onok",l),this.set("oncancel",c),this},setup:function(){return{buttons:[{text:P.defaults.glossary.ok,key:y.ENTER,className:P.defaults.theme.ok},{text:P.defaults.glossary.cancel,key:y.ESC,invokeOnClose:!0,className:P.defaults.theme.cancel}],focus:{element:e,select:!0},options:{maximizable:!1,resizable:!1}}},build:function(){e.className=P.defaults.theme.input,e.setAttribute("type","text"),e.value=this.get("value"),this.elements.content.appendChild(t),this.elements.content.appendChild(e)},prepare:function(){},setMessage:function(e){"string"==typeof e?(d(t),t.innerHTML=e):e instanceof n.HTMLElement&&t.firstChild!==e&&(d(t),t.appendChild(e))},settings:{message:void 0,labels:void 0,onok:void 0,oncancel:void 0,value:"",type:"text",reverseButtons:void 0},settingUpdated:function(t,n,i){switch(t){case"message":this.setMessage(i);break;case"value":e.value=i;break;case"type":switch(i){case"text":case"color":case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"time":case"week":e.type=i;break;default:e.type="text"}break;case"labels":i.ok&&this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i.ok),i.cancel&&this.__internal.buttons[1].element&&(this.__internal.buttons[1].element.innerHTML=i.cancel);break;case"reverseButtons":!0===i?this.elements.buttons.primary.appendChild(this.__internal.buttons[0].element):this.elements.buttons.primary.appendChild(this.__internal.buttons[1].element)}},callback:function(t){var n;switch(t.index){case 0:this.settings.value=e.value,"function"==typeof this.get("onok")&&void 0!==(n=this.get("onok").call(this,t,this.settings.value))&&(t.cancel=!n);break;case 1:"function"==typeof this.get("oncancel")&&void 0!==(n=this.get("oncancel").call(this,t))&&(t.cancel=!n),t.cancel||(e.value=this.settings.value)}}}}),"object"==typeof e&&"object"==typeof e.exports?e.exports=P:(i=[],void 0!==(r=function(){return P}.apply(t,i))&&(e.exports=r))}("undefined"!=typeof window?window:this)},function(e,t,n){var i=n(106),r=n(81);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!0);i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(80)(!1),t.push([e.i,'.alertify .ajs-dimmer{margin:0;background-color:#252525;opacity:.5}.alertify .ajs-dimmer,.alertify .ajs-modal{position:fixed;z-index:1981;top:0;right:0;bottom:0;left:0;padding:0}.alertify .ajs-modal{overflow-y:auto}.alertify .ajs-dialog{position:relative;margin:5% auto;min-height:110px;max-width:500px;padding:24px 24px 0;outline:0;background-color:#fff}.alertify .ajs-dialog.ajs-capture:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;display:block;z-index:1}.alertify .ajs-reset{position:absolute!important;display:inline!important;width:0!important;height:0!important;opacity:0!important}.alertify .ajs-commands{position:absolute;right:4px;margin:-14px 24px 0 0;z-index:2}.alertify .ajs-commands button{display:none;width:10px;height:10px;margin-left:10px;padding:10px;border:0;background-color:transparent;background-repeat:no-repeat;background-position:50%;cursor:pointer}.alertify .ajs-commands button.ajs-close{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMy8xNOrZqugAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAh0lEQVQYlY2QsQ0EIQwEB9cBAR1CJUaI/gigDnwR6NBL/7/xWLNrZ2b8EwGotVpr7eOitWa1VjugiNB7R1UPrKrWe0dEAHBbXUqxMQbeewDmnHjvyTm7C3zDwAUd9c63YQdUVdu6EAJzzquz7HXvTiklt+H9DQFYaxFjvDqllFyMkbXWvfpXHjJrWFgdBq/hAAAAAElFTkSuQmCC)}.alertify .ajs-commands button.ajs-maximize{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMy8xNOrZqugAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAOUlEQVQYlWP8//8/AzGAhYGBgaG4uBiv6t7eXkYmooxjYGAgWiELsvHYFMCcRX2rSXcjoSBiJDbAAeD+EGu+8BZcAAAAAElFTkSuQmCC)}.alertify .ajs-header{margin:-24px;margin-bottom:0;padding:16px 24px;background-color:#fff}.alertify .ajs-body{min-height:56px}.alertify .ajs-body .ajs-content{padding:16px 24px 16px 16px}.alertify .ajs-footer{padding:4px;margin-left:-24px;margin-right:-24px;min-height:43px;background-color:#fff}.alertify .ajs-footer .ajs-buttons.ajs-primary{text-align:right}.alertify .ajs-footer .ajs-buttons.ajs-primary .ajs-button{margin:4px}.alertify .ajs-footer .ajs-buttons.ajs-auxiliary{float:left;clear:none;text-align:left}.alertify .ajs-footer .ajs-buttons.ajs-auxiliary .ajs-button{margin:4px}.alertify .ajs-footer .ajs-buttons .ajs-button{min-width:88px;min-height:35px}.alertify .ajs-handle{position:absolute;display:none;width:10px;height:10px;right:0;bottom:0;z-index:1;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMS8xNEDQYmMAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAQ0lEQVQYlaXNMQoAIAxD0dT7H657l0KX3iJuUlBUNOsPPCGJm7VDp6ryeMxMuDsAQH7owW3pyn3RS26iKxERMLN3ugOaAkaL3sWVigAAAABJRU5ErkJggg==);-webkit-transform:scaleX(1);transform:scaleX(1);cursor:se-resize}.alertify.ajs-no-overflow .ajs-body .ajs-content{overflow:hidden!important}.alertify.ajs-no-padding.ajs-maximized .ajs-body .ajs-content{left:0;right:0;padding:0}.alertify.ajs-no-padding:not(.ajs-maximized) .ajs-body{margin-left:-24px;margin-right:-24px}.alertify.ajs-no-padding:not(.ajs-maximized) .ajs-body .ajs-content{padding:0}.alertify.ajs-no-padding.ajs-resizable .ajs-body .ajs-content{left:0;right:0}.alertify.ajs-closable .ajs-commands button.ajs-close,.alertify.ajs-maximizable .ajs-commands button.ajs-maximize,.alertify.ajs-maximizable .ajs-commands button.ajs-restore{display:inline-block}.alertify.ajs-maximized .ajs-dialog{width:100%!important;height:100%!important;max-width:none!important;margin:0 auto!important;top:0!important;left:0!important}.alertify.ajs-maximized.ajs-modeless .ajs-modal{position:fixed!important;min-height:100%!important;max-height:none!important;margin:0!important}.alertify.ajs-maximized .ajs-commands button.ajs-maximize{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMy8xNOrZqugAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAASklEQVQYlZWQ0QkAMQhDtXRincOZX78KVtrDCwgqJNEoIB3MPLj7lRUROlpyVXGzby6zWuY+kz6tj5sBMTMAyVV3/595RbOh3cAXsww1raeiOcoAAAAASUVORK5CYII=)}.alertify.ajs-maximized .ajs-dialog,.alertify.ajs-resizable .ajs-dialog{padding:0}.alertify.ajs-maximized .ajs-commands,.alertify.ajs-resizable .ajs-commands{margin:14px 24px 0 0}.alertify.ajs-maximized .ajs-header,.alertify.ajs-resizable .ajs-header{position:absolute;top:0;left:0;right:0;margin:0;padding:16px 24px}.alertify.ajs-maximized .ajs-body,.alertify.ajs-resizable .ajs-body{min-height:224px;display:inline-block}.alertify.ajs-maximized .ajs-body .ajs-content,.alertify.ajs-resizable .ajs-body .ajs-content{position:absolute;top:50px;right:24px;bottom:50px;left:24px;overflow:auto}.alertify.ajs-maximized .ajs-footer,.alertify.ajs-resizable .ajs-footer{position:absolute;left:0;right:0;bottom:0;margin:0}.alertify.ajs-resizable:not(.ajs-maximized) .ajs-dialog{min-width:548px}.alertify.ajs-resizable:not(.ajs-maximized) .ajs-handle{display:block}.alertify.ajs-movable:not(.ajs-maximized) .ajs-header{cursor:move}.alertify.ajs-modeless .ajs-dimmer,.alertify.ajs-modeless .ajs-reset{display:none}.alertify.ajs-modeless .ajs-modal{overflow:visible;max-width:none;max-height:0}.alertify.ajs-modeless.ajs-pinnable .ajs-commands button.ajs-pin{display:inline-block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMy8xNOrZqugAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAQklEQVQYlcWPMQ4AIAwCqU9u38GbcbHRWN1MvKQDhQFMEpKImGJA0gCgnYw0V0rwxseg5erT4oSkQVI5d9f+e9+xA0NbLpWfitPXAAAAAElFTkSuQmCC)}.alertify.ajs-modeless.ajs-unpinned .ajs-modal{position:absolute}.alertify.ajs-modeless.ajs-unpinned .ajs-commands button.ajs-pin{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNy8xMy8xNOrZqugAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAO0lEQVQYlWP8//8/AzGAiShV6AqLi4txGs+CLoBLMYbC3t5eRmyaWfBZhwwYkX2NTxPRvibKjRhW4wMAhxkYGbLu3pEAAAAASUVORK5CYII=)}.alertify.ajs-modeless:not(.ajs-unpinned) .ajs-body{max-height:500px;overflow:auto}.alertify.ajs-basic .ajs-header{opacity:0}.alertify.ajs-basic .ajs-footer{visibility:hidden}.alertify.ajs-frameless .ajs-header{position:absolute;top:0;left:0;right:0;min-height:60px;margin:0;padding:0;opacity:0;z-index:1}.alertify.ajs-frameless .ajs-footer{display:none}.alertify.ajs-frameless .ajs-body .ajs-content{position:absolute;top:0;right:0;bottom:0;left:0}.alertify.ajs-frameless:not(.ajs-resizable) .ajs-dialog{padding-top:0}.alertify.ajs-frameless:not(.ajs-resizable) .ajs-dialog .ajs-commands{margin-top:0}.ajs-no-overflow{overflow:hidden!important;outline:0}.ajs-no-overflow.ajs-fixed{position:fixed;top:0;right:0;bottom:0;left:0;overflow-y:scroll!important}.ajs-no-selection,.ajs-no-selection *{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media screen and (max-width:568px){.alertify .ajs-dialog{min-width:150px}.alertify:not(.ajs-maximized) .ajs-modal{padding:0 5%}.alertify:not(.ajs-maximized).ajs-resizable .ajs-dialog{min-width:0;min-width:auto}}@-moz-document url-prefix(){.alertify button:focus{outline:1px dotted #3593d2}}.alertify .ajs-dimmer,.alertify .ajs-modal{-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transition-property:opacity,visibility;transition-property:opacity,visibility;-webkit-transition-timing-function:linear;transition-timing-function:linear;-webkit-transition-duration:.25s;transition-duration:.25s}.alertify.ajs-hidden .ajs-dimmer,.alertify.ajs-hidden .ajs-modal{visibility:hidden;opacity:0}.alertify.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-duration:.5s;animation-duration:.5s}.alertify.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-duration:.25s;animation-duration:.25s}.alertify .ajs-dialog.ajs-shake{-webkit-animation-name:ajs-shake;animation-name:ajs-shake;-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-fill-mode:both;animation-fill-mode:both}@-webkit-keyframes ajs-shake{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-10px,0,0);transform:translate3d(-10px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}}@keyframes ajs-shake{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-10px,0,0);transform:translate3d(-10px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(10px,0,0);transform:translate3d(10px,0,0)}}.alertify.ajs-slide.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-slideIn;animation-name:ajs-slideIn;-webkit-animation-timing-function:cubic-bezier(.175,.885,.32,1.275);animation-timing-function:cubic-bezier(.175,.885,.32,1.275)}.alertify.ajs-slide.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-slideOut;animation-name:ajs-slideOut;-webkit-animation-timing-function:cubic-bezier(.6,-.28,.735,.045);animation-timing-function:cubic-bezier(.6,-.28,.735,.045)}.alertify.ajs-zoom.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-zoomIn;animation-name:ajs-zoomIn}.alertify.ajs-zoom.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-zoomOut;animation-name:ajs-zoomOut}.alertify.ajs-fade.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-fadeIn;animation-name:ajs-fadeIn}.alertify.ajs-fade.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-fadeOut;animation-name:ajs-fadeOut}.alertify.ajs-pulse.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-pulseIn;animation-name:ajs-pulseIn}.alertify.ajs-pulse.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-pulseOut;animation-name:ajs-pulseOut}.alertify.ajs-flipx.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-flipInX;animation-name:ajs-flipInX}.alertify.ajs-flipx.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-flipOutX;animation-name:ajs-flipOutX}.alertify.ajs-flipy.ajs-in:not(.ajs-hidden) .ajs-dialog{-webkit-animation-name:ajs-flipInY;animation-name:ajs-flipInY}.alertify.ajs-flipy.ajs-out.ajs-hidden .ajs-dialog{-webkit-animation-name:ajs-flipOutY;animation-name:ajs-flipOutY}@-webkit-keyframes ajs-pulseIn{0%,20%,40%,60%,80%,to{-webkit-transition-timing-function:cubic-bezier(.215,.61,.355,1);transition-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}20%{-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}40%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}60%{opacity:1;-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}80%{-webkit-transform:scale3d(.97,.97,.97);transform:scale3d(.97,.97,.97)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes ajs-pulseIn{0%,20%,40%,60%,80%,to{-webkit-transition-timing-function:cubic-bezier(.215,.61,.355,1);transition-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}20%{-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}40%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}60%{opacity:1;-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}80%{-webkit-transform:scale3d(.97,.97,.97);transform:scale3d(.97,.97,.97)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes ajs-pulseOut{20%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}50%,55%{opacity:1;-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}to{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}}@keyframes ajs-pulseOut{20%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}50%,55%{opacity:1;-webkit-transform:scale3d(1.1,1.1,1.1);transform:scale3d(1.1,1.1,1.1)}to{opacity:0;-webkit-transform:scale3d(.3,.3,.3);transform:scale3d(.3,.3,.3)}}@-webkit-keyframes ajs-zoomIn{0%{opacity:0;-webkit-transform:scale3d(.25,.25,.25);transform:scale3d(.25,.25,.25)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes ajs-zoomIn{0%{opacity:0;-webkit-transform:scale3d(.25,.25,.25);transform:scale3d(.25,.25,.25)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes ajs-zoomOut{0%{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}to{opacity:0;-webkit-transform:scale3d(.25,.25,.25);transform:scale3d(.25,.25,.25)}}@keyframes ajs-zoomOut{0%{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}to{opacity:0;-webkit-transform:scale3d(.25,.25,.25);transform:scale3d(.25,.25,.25)}}@-webkit-keyframes ajs-fadeIn{0%{opacity:0}to{opacity:1}}@keyframes ajs-fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes ajs-fadeOut{0%{opacity:1}to{opacity:0}}@keyframes ajs-fadeOut{0%{opacity:1}to{opacity:0}}@-webkit-keyframes ajs-flipInX{0%{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateX(10deg);transform:perspective(400px) rotateX(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateX(-5deg);transform:perspective(400px) rotateX(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@keyframes ajs-flipInX{0%{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateX(10deg);transform:perspective(400px) rotateX(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateX(-5deg);transform:perspective(400px) rotateX(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@-webkit-keyframes ajs-flipOutX{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);opacity:1}to{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);opacity:0}}@keyframes ajs-flipOutX{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateX(-20deg);transform:perspective(400px) rotateX(-20deg);opacity:1}to{-webkit-transform:perspective(400px) rotateX(90deg);transform:perspective(400px) rotateX(90deg);opacity:0}}@-webkit-keyframes ajs-flipInY{0%{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateY(-20deg);transform:perspective(400px) rotateY(-20deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateY(10deg);transform:perspective(400px) rotateY(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateY(-5deg);transform:perspective(400px) rotateY(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@keyframes ajs-flipInY{0%{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;opacity:0}40%{-webkit-transform:perspective(400px) rotateY(-20deg);transform:perspective(400px) rotateY(-20deg);-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in}60%{-webkit-transform:perspective(400px) rotateY(10deg);transform:perspective(400px) rotateY(10deg);opacity:1}80%{-webkit-transform:perspective(400px) rotateY(-5deg);transform:perspective(400px) rotateY(-5deg)}to{-webkit-transform:perspective(400px);transform:perspective(400px)}}@-webkit-keyframes ajs-flipOutY{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateY(-15deg);transform:perspective(400px) rotateY(-15deg);opacity:1}to{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);opacity:0}}@keyframes ajs-flipOutY{0%{-webkit-transform:perspective(400px);transform:perspective(400px)}30%{-webkit-transform:perspective(400px) rotateY(-15deg);transform:perspective(400px) rotateY(-15deg);opacity:1}to{-webkit-transform:perspective(400px) rotateY(90deg);transform:perspective(400px) rotateY(90deg);opacity:0}}@-webkit-keyframes ajs-slideIn{0%{margin-top:-100%}to{margin-top:5%}}@keyframes ajs-slideIn{0%{margin-top:-100%}to{margin-top:5%}}@-webkit-keyframes ajs-slideOut{0%{margin-top:5%}to{margin-top:-100%}}@keyframes ajs-slideOut{0%{margin-top:5%}to{margin-top:-100%}}.alertify-notifier{position:fixed;width:0;overflow:visible;z-index:1982}.alertify-notifier,.alertify-notifier .ajs-message{-webkit-transform:translateZ(0);transform:translateZ(0)}.alertify-notifier .ajs-message{position:relative;width:260px;max-height:0;padding:0;opacity:0;margin:0;-webkit-transition-duration:.25s;transition-duration:.25s;-webkit-transition-timing-function:linear;transition-timing-function:linear}.alertify-notifier .ajs-message.ajs-visible{-webkit-transition-duration:.5s;transition-duration:.5s;-webkit-transition-timing-function:cubic-bezier(.175,.885,.32,1.275);transition-timing-function:cubic-bezier(.175,.885,.32,1.275);opacity:1;max-height:100%;padding:15px;margin-top:10px}.alertify-notifier .ajs-message.ajs-success{background:rgba(91,189,114,.95)}.alertify-notifier .ajs-message.ajs-error{background:rgba(217,92,92,.95)}.alertify-notifier .ajs-message.ajs-warning{background:hsla(54,86%,92%,.95)}.alertify-notifier .ajs-message .ajs-close{position:absolute;top:0;right:0;width:16px;height:16px;cursor:pointer;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAABGdBTUEAALGPC/xhBQAAAFBJREFUGBl1j0EKADEIA+ve/P9f9bh1hEihNBfjVCO1v7RKVqJK4h8gM5cAPR42AkQEpSXPwMTyoi13n5N9YqJehm3Fnr7nL1D0ZEbD5OubGyC7a9gx+9eNAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-position:50%;background-color:rgba(0,0,0,.5);border-top-right-radius:2px}.alertify-notifier.ajs-top{top:10px}.alertify-notifier.ajs-bottom{bottom:10px}.alertify-notifier.ajs-right{right:10px}.alertify-notifier.ajs-right .ajs-message{right:-320px}.alertify-notifier.ajs-right .ajs-message.ajs-visible{right:290px}.alertify-notifier.ajs-left{left:10px}.alertify-notifier.ajs-left .ajs-message{left:-300px}.alertify-notifier.ajs-left .ajs-message.ajs-visible{left:0}.alertify-notifier.ajs-center{left:50%}.alertify-notifier.ajs-center .ajs-message{-webkit-transform:translateX(-50%);transform:translateX(-50%)}.alertify-notifier.ajs-center .ajs-message.ajs-visible{left:50%;-webkit-transition-timing-function:cubic-bezier(.57,.43,.1,.65);transition-timing-function:cubic-bezier(.57,.43,.1,.65)}.alertify-notifier.ajs-center.ajs-top .ajs-message{top:-300px}.alertify-notifier.ajs-center.ajs-top .ajs-message.ajs-visible{top:0}.alertify-notifier.ajs-center.ajs-bottom .ajs-message{bottom:-300px}.alertify-notifier.ajs-center.ajs-bottom .ajs-message.ajs-visible{bottom:0}',""])}])});