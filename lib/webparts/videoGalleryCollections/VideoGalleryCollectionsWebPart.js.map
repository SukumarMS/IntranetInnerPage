{"version":3,"sources":["webparts/videoGalleryCollections/VideoGalleryCollectionsWebPart.ts"],"names":[],"mappings":"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","file":"VideoGalleryCollectionsWebPart.js","sourcesContent":["import { Version } from '@microsoft/sp-core-library';\r\nimport { BaseClientSideWebPart,IPropertyPaneConfiguration,PropertyPaneTextField} from '@microsoft/sp-webpart-base';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport {DeleteFolder,readItems,checkUserinGroup} from '../../commonJS';\r\nimport * as strings from 'VideoGalleryCollectionsWebPartStrings';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\nimport 'jquery';\r\nrequire('bootstrap');\r\ndeclare var $;\r\ndeclare var alertify: any;\r\n\r\nexport interface IVideoGalleryCollectionsWebPartProps {\r\n  description: string;\r\n}\r\n\r\nexport default class VideoGalleryCollectionsWebPart extends BaseClientSideWebPart<IVideoGalleryCollectionsWebPartProps> {\r\n  \r\n  public render(): void {\r\n    SPComponentLoader.loadCss(\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css\");\r\n    let siteURL = this.context.pageContext.site.absoluteUrl;\r\n    this.domElement.innerHTML = \r\n      \"<div class='breadcrumb'>\" +\r\n        \"<ol>\" +\r\n          \"<li><a href='\" + siteURL + \"/Pages/Home.aspx' title='Home'>Home</a></li>\" +\r\n          \"<li><a href='\" + siteURL + \"/Pages/VideoCollections.aspx'>Video Collections</a></li>\" +\r\n        \"</ol>\" +\r\n      \"</div>\" +\r\n      \"<div class='title-section'>\" +\r\n        \"<div class='button-field'>\" +\r\n          \"<a href='\" + siteURL + \"/Pages/AddListItem.aspx?CName=Video Gallery' title='Add New' class='pointer' id='AddingButtons'><i class='icon-add'></i>Add New</a>\" +\r\n          \"<a href='\" + siteURL + \"/Pages/Home.aspx' class='delete-icon pointer' title='Close'><img src='\" + siteURL + \"/_catalogs/masterpage/BloomHomepage/images/close-icon.png'>Close</a>\" +\r\n        \"</div>\" +\r\n        \"<h2>Video Gallery</h2>\" +\r\n      \"</div>\" +\r\n      `\r\n      <div class=\"gallery-listsec\">\r\n      </div>  \r\n      `;\r\n    this.getItems();\r\n    this.checkUserPermissionForDeletion();\r\n\r\n  }\r\n\r\n  checkUserPermissionForDeletion() {\r\n    let email = this.context.pageContext.user.loginName;\r\n    let compName = \"Video Gallery\";\r\n    checkUserinGroup(compName, email, function (result) {\r\n      if (result == 1) {\r\n        $('.deleteFolder').show();\r\n        $('#AddingButtons').show();\r\n      } else {\r\n        $('.deleteFolder').hide();\r\n        $('#AddingButtons').hide();\r\n      }\r\n    });\r\n  }\r\n\r\n  // DISPLAY ITEMS \r\n\r\n  /****** START ******/\r\n\r\n  async getItems() {\r\n    var ImgHtml = \"\";\r\n    var ImgSrc = \"\";\r\n    var EventTitle = \"\";\r\n    let columnArray: any = [\"ID\", \"FileLeafRef\", \"FileSystemObjectType\", \"FileDirRef\"];\r\n    let picItems = await readItems(\"Video Gallery\", columnArray, 5000, \"ID\");\r\n    \r\n    var itemLength = picItems.length;\r\n    var arr = [];\r\n    var Flag2 = 0;\r\n    for (var i = 0; i < itemLength; i++) {\r\n      var eventname = picItems[i].FileLeafRef;\r\n      if (eventname != undefined) {\r\n        if ($.inArray(eventname, arr) < 0) {\r\n          arr.push(eventname);\r\n        }\r\n      }\r\n    }\r\n    var arrFlag = 0;\r\n    for (var j = 0; j < arr.length; j++) {\r\n      for (var k = 0; k < itemLength; k++) {\r\n        if (arr[j] == picItems[k].FileLeafRef) {\r\n          if (arrFlag == 0) {\r\n            ImgSrc = picItems[k].FileDirRef + \"/\" + picItems[k].FileLeafRef;\r\n            EventTitle = picItems[j].FileLeafRef;\r\n            if(picItems[k].FileSystemObjectType == 1){\r\n              ImgHtml += \"<div class='col-lg-2 col-md-2 col-sm-4 col-xs-12'>\" +\r\n                \"<div class='gallery-list'>\" +\r\n                \"<a href='\" + this.context.pageContext.web.absoluteUrl + \"/Pages/VideoGallery.aspx?imgeventid=\" + arr[j] + \"'title=''><img style='height:100px;width:100px;' src='\" + this.context.pageContext.site.absoluteUrl + \"/_catalogs/masterpage/BloomHomepage/images/folder-images-icon.png'>\" +\r\n                \"</a>\" +\r\n                \"<button style='margin-top: 17px;margin-right: -6px;color: white;background-color: grey;' class='deleteFolder'><i class='fa fa-trash'></i></button>\" +\r\n                \"<h4>\" + EventTitle + \"</h4>\" +\r\n                \"</div>\" +\r\n                \"</div>\";\r\n                arrFlag++;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        \r\n      arrFlag = 0;\r\n    }\r\n    $(\".gallery-listsec\").append(ImgHtml);\r\n    $('#deleteButtonField').hide();\r\n    checkUserinGroup(\"Video Gallery\",this.context.pageContext.user.loginName,function(result){\r\n      if(result == 1){$(\"#deleteButtonField\").show();}else if(result == 0){$(\"#deleteButtonField\").hide();}\r\n    });\r\n\r\n\r\n    // DELETE FOLDER - START\r\n\r\n    $('.deleteFolder').click(function (event){\r\n      event.preventDefault();\r\n      let folderName = $(this).next().text();\r\n      alertify.confirm(\"Are you sure you want to delete selected Folder ?\", function (e) {\r\n        if (e) {\r\n           alertify.success(\"\");\r\n           DeleteFolder(\"Video Gallery\",folderName);\r\n           location.reload();\r\n        } else {}\r\n      },function (e){if(e){alertify.error(\"\");}else{}}).set('closable', false).setHeader('Confirmation') ;      \r\n    });\r\n  }\r\n\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('description', {\r\n                  label: strings.DescriptionFieldLabel\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n\r\n"],"sourceRoot":"../../../../../src"}