{"version":3,"sources":["webparts/organizationPolicy/OrganizationPolicyWebPart.ts"],"names":[],"mappings":"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","file":"OrganizationPolicyWebPart.js","sourcesContent":["import { Version } from '@microsoft/sp-core-library';\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField\r\n} from '@microsoft/sp-webpart-base';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport 'jquery';\r\nimport pnp from 'sp-pnp-js';\r\n//import styles from './OrganizationPolicyWebPart.module.scss';\r\nimport * as strings from 'OrganizationPolicyWebPartStrings';\r\nrequire('jplist-core');\r\nrequire('jplist-pagination');\r\nrequire('../../ExternalRef/js/jplist-core.js');\r\nrequire('../../ExternalRef/js/jplist-pagination.js');\r\nrequire('../../ExternalRef/js/bootstrap-select.min.js');\r\nimport {\r\n  readItems, updateItem, formatDate, checkUserinGroup, GetQueryStringParams, batchDelete\r\n} from '../../commonJS';\r\ndeclare var $;\r\ndeclare var alertify: any;\r\nexport interface IOrganizationPolicyWebPartProps {\r\n  description: string;\r\n}\r\n\r\nexport default class OrganizationPolicyWebPart extends BaseClientSideWebPart<IOrganizationPolicyWebPartProps> {\r\n  userflag: boolean = false;\r\n  public render(): void {\r\n    var _thatt = this;\r\n    checkUserinGroup(\"Organizational Policies\", this.context.pageContext.user.email, function (result) {\r\n      if (result == 1) {\r\n        _thatt.userflag = true;\r\n        _thatt.loadcomponent();\r\n      }else{\r\n        _thatt.userflag = false;\r\n        _thatt.loadcomponent();\r\n      }\r\n    });\r\ndocument.title = \"Organizational Policies\";\r\n  }\r\n\r\n  public loadcomponent(){\r\n    var siteURL = this.context.pageContext.web.absoluteUrl;\r\n    var strLocalStorage = GetQueryStringParams(\"CName\").replace(\"%20\", \" \");\r\n    this.domElement.innerHTML =\r\n    \"<div class='breadcrumb'>\" +\r\n    \"<ol>\" +\r\n    \"<li><a href='\" + siteURL + \"/Pages/Home.aspx' title='Home' class='pointer'>Home</a></li>\" +\r\n    \"<li><span>Organizational Policies</span></li>\" +\r\n    \"</ol>\" +\r\n    \"</div>\" +\r\n    \"<div class='title-section'>\" +\r\n    \"<div class='button-field'>\" +\r\n    \"<a href='\" + siteURL + \"/Pages/AddListItem.aspx?CName=Organizational%20Policies' title='Add New' class='pointer' id='AddingButtons'><i class='icon-add'></i>Add New</a>\" +\r\n    \"<a class='delete-icon DeletingButtons pointer' title='Delete' id='DeletingButtons'><img src='\" + siteURL + \"/_catalogs/masterpage/BloomHomepage/images/close-icon.png'>Delete</a>\" +\r\n    \"</div>\" +\r\n    \"<h2>Organizational Policies</h2>\" +\r\n    \"</div>\" +\r\n  \r\n    \"</div></div>\" +\r\n    \"<div class='content-area'>\" +\r\n\r\n\r\n    \"</div>\" +\r\n    \"<div class='modal'><!-- Place at bottom of page --></div>\";\r\n    \r\n    this.OrgPage();\r\n\r\n  }\r\n  async OrgPage() {\r\n    var Organ = \"<div id='pagination-list' class='list-section jplist'><ul class='list'>\";\r\n    var count = 50;\r\n    var checkboxstatus = \"\";\r\n    var strcheckboxstatus = \"Not Displayed\";\r\n    if (this.userflag == false) {      \r\n      $('.button-field').hide();      \r\n    }\r\n    var dept = \"Admin\";\r\n    dept = GetQueryStringParams(\"CName\").replace(\"%20\", \" \");\r\n    //if ($(\"#OptionsforSel\").val() != null) {\r\n    // dept = \"\" + $(\"#OptionsforSel\").val() + \"\";\r\n    // }\r\n    var strLocalStorage = \"\";\r\n    if (strLocalStorage == \"\") {\r\n      strLocalStorage = \"Organizational%20Policies\";\r\n    }\r\n    var items;\r\n    //objResults= readItems(strLocalStorage, [\"ID\", \"Title\", \"Modified\", \"DocumentFile\", \"Explanation\", \"Display\", \"Departments\"], count, \"Modified\", \"Departments\", dept)\r\n    //pnp.sp.web.lists.getByTitle(\"OrganizationPolicy\").items.filter(\"Departments eq \"+dept+\" and Display eq 1\").get().then((items: any[]) => {\r\n    if (this.userflag == false) {\r\n      items = await pnp.sp.web.lists.getByTitle(strLocalStorage).items.filter(\"Departments eq '\" + dept + \"' and Display eq 1\").top(count).orderBy(\"Modified\").get();\r\n    }\r\n    else {\r\n      items = await pnp.sp.web.lists.getByTitle(strLocalStorage).items.filter(\"Departments eq '\" + dept + \"'\").top(count).orderBy(\"Modified\").get();\r\n    }\r\n    if (items.length > 0) {\r\n      //objResults.then((items: any[]) => {\r\n      for (let i = 0; i < items.length; i++) {\r\n        if (items[i].Display == \"1\") {\r\n          checkboxstatus = \"checked\";\r\n          strcheckboxstatus = \"Displayed\";\r\n        }\r\n        else {\r\n          checkboxstatus = \"\";\r\n          strcheckboxstatus = \"Not Displayed\";\r\n        }\r\n        if (items[i].Explanation != null && items[i].Explanation > 160) {\r\n          items[i].Explanation = items[i].Explanation.substring(0, 160) + \"...\";\r\n        }\r\n        else if (items[i].Explanation == null) {\r\n          items[i].Explanation = \"\";\r\n        }\r\n        Organ += \"<li class='list-item'>\" +\r\n          \"<div class='list-imgcont' >\" +\r\n          \"<p class='Modified'><strong>\" + formatDate(items[i].Modified) + \"</strong></p>\" +\r\n          \"<a href='\" + items[i].DocumentFile.Url + \"' target='_blank'><h3 class='OrgTitle'>\" + items[i].Title + \"</h3></a>\" +\r\n         // \"<p class='OrgDescrip'>\" + items[i].Explanation + \"</p>\" +\r\n          \"<p class='OrgDepart'>\" + items[i].Departments + \"</p>\" +\r\n          \"<div class='switch'>\" +\r\n          \"<input type='checkbox' id='switch\" + items[i].ID + \"' class='switch-input sndswitch' \" + checkboxstatus + \"/>\" +\r\n          \"<label for='switch\" + items[i].ID + \"' class='switch-label sndswitch'>\" + strcheckboxstatus + \"</label>\" +\r\n          \"<div class='list-icons'>\" +\r\n          \"<div class='icon-list2 viewitem'>\" +\r\n          \"<a  title='View' class='viewitem pointer' id='viewitem\" + items[i].ID + \"'><i class='icon-eye viewitem'></i></a>\" +\r\n          \"</div>\" +\r\n          \"<div class='icon-list2 edititemuser edititem'>\" +\r\n          \"<a  title='Edit' class='edititem pointer' id='edititem\" + items[i].ID + \"'><i class='icon-edit edititem'></i></a>\" +\r\n          \"</div>\" +\r\n          \"<div class='icon-list2 deleteitemuser'>\" +\r\n          \"<div class='check-box'>\" +\r\n          \"<input type='checkbox'  name='' value='' class='delete-item' id='deleteitem\" + items[i].ID + \"'/>\" +\r\n          \"<label>Checkbox</label>\" +\r\n          \"</div>\" +\r\n          \"</div>\" +\r\n          \"</div>\" +\r\n          \"</div>\" +\r\n          \"</li>\";\r\n      }\r\n    }\r\n    else {\r\n      Organ += \"<li class='list-item'>No items to display\" +\r\n        \"</li>\";\r\n    }\r\n    Organ += \"</ul>\";\r\n    Organ += \"<div class='jplist-panel box panel-top'>\" +\r\n      \"<div class='jplist-pagination' data-control-type='pagination' data-control-name='paging' data-control-action='paging'></div>\" +\r\n      \"<select class='jplist-select' data-control-type='items-per-page-select' data-control-name='paging' data-control-action='paging'>\" +\r\n      \"<option data-number='5' data-default='true'> 5 </option>\" +\r\n      \"<option data-number='10'> 10 </option>\" +\r\n      \"<option data-number='15'> 15 </option>\" +\r\n      \"</select>\" +\r\n      \"</div>\";\r\n\r\n\r\n    $('.content-area').append(Organ);\r\n    let Viewevent = document.getElementsByClassName('viewitem');\r\n    for (let i = 0; i < Viewevent.length; i++) {\r\n      Viewevent[i].addEventListener(\"click\", (e: Event) => this.viewitem());\r\n    }\r\n    let Editevent = document.getElementsByClassName('edititem');\r\n    for (let i = 0; i < Editevent.length; i++) {\r\n      Editevent[i].addEventListener(\"click\", (e: Event) => this.edititem());\r\n    }\r\n    //Adding event for delete button click \r\n    let deleteevent = document.getElementById(\"DeletingButtons\");\r\n\r\n    deleteevent.addEventListener(\"click\", (e: Event) => this.deleteitems());\r\n    if (this.userflag == false) {\r\n      $('.edititemuser').hide();\r\n      $('.deleteitemuser').hide();\r\n      $('.sndswitch').hide();\r\n      $('.button-field').hide();\r\n      $('.viewitem').show();\r\n    }\r\n    else {\r\n      $('.edititemuser').show();\r\n      $('.deleteitemuser').show();\r\n    }\r\n    $('#pagination-list').jplist({\r\n      itemsBox: '.list',\r\n      itemPath: '.list-item',\r\n      panelPath: '.jplist-panel'\r\n    });\r\n\r\n    $(document).on('change', '.switch-input', function () {\r\n      var id = $(this).attr('id').replace('switch', '');\r\n      var _thisid = $(this);\r\n      if (_thisid.prop(\"checked\")) {\r\n        let myobj = {\r\n          Display: true\r\n        };\r\n        _thisid.next().text(\"Displayed\");\r\n        _thisid.attr(\"checked\", \"checked\");\r\n        let item = updateItem(\"Organizational%20Policies\", id, myobj);\r\n        item.then((items: any[]) => {\r\n          //console.log(\"Success update true\");\r\n        });\r\n      }\r\n      else {\r\n        let myobj = {\r\n          Display: false\r\n        };\r\n        _thisid.next().text(\"Not Displayed\");\r\n        _thisid.removeAttr('checked');\r\n        let item = updateItem(\"Organizational%20Policies\", id, myobj);\r\n        item.then((items: any[]) => {\r\n          //console.log(\"Success update false\");\r\n        });\r\n      }\r\n    });\r\n\r\n\r\n  }\r\n  public Depart() {\r\n    var strLocalStorage = GetQueryStringParams(\"CName\");\r\n    if (strLocalStorage === undefined) {\r\n      strLocalStorage = \"Organizational%20Policies\";\r\n    }\r\n    let DepName = \"\";\r\n    pnp.sp.web.lists.getByTitle(strLocalStorage).items.get()\r\n      .then((items: any) => {\r\n        if (items.length > 0) {\r\n          var flags = [], output = [], l = items.length, i;\r\n          for (i = 0; i < l; i++) {\r\n            if (flags[items[i].Departments]) continue;\r\n            flags[items[i].Departments] = true;\r\n            output.push(items[i].Departments);\r\n          }\r\n\r\n          for (var k = 0; k < output.length; k++) {\r\n            DepName += \"<option value='\" + output[k] + \"'>\" + output[k] + \"</option>\";\r\n          }\r\n\r\n          $('.selectpicker').append(DepName);\r\n          $('.selectpicker').selectpicker();\r\n        }\r\n      }).then(r => {\r\n        this.OrgPage();\r\n      });\r\n  }\r\n  public viewitem() {\r\n    var siteURL = this.context.pageContext.web.absoluteUrl;\r\n    $('a.viewitem').click(function () {\r\n      var id = $(this).attr('id');\r\n      window.location.href = \"\" + siteURL + \"/Pages/Viewlistitem.aspx?CName=Organizational%20Policies&CID=\" + $(this).attr('id').replace('viewitem', '') + \"&CMode=ViewMode\";\r\n    });\r\n  }\r\n  public edititem() {\r\n    var siteURL = this.context.pageContext.web.absoluteUrl;\r\n    $('a.edititem').click(function () {\r\n      var id = $(this).attr('id');\r\n\r\n      window.location.href = \"\" + siteURL + \"/Pages/EditListItem.aspx?CName=Organizational%20Policies&CID=\" + $(this).attr('id').replace('edititem', '') + \"&CMode=EditMode\";\r\n    });\r\n  }\r\n  public deleteitems() {\r\n    var strLocalStorage = \"Organizational%20Policies\";\r\n    var deleteitemID = [];\r\n    var $body = $('body');\r\n    $('.delete-item:checked').each(function () {\r\n      deleteitemID.push($(this).attr('id').replace('deleteitem', ''));\r\n    });\r\n    if (deleteitemID.length > 0) {\r\n      var strconfirm = \"Are you sure you want to delete selected item(s)?\";\r\n      var _that = this;\r\n      alertify.confirm('Confirmation', strconfirm, function () {\r\n        var selectedArray: number[] = deleteitemID;\r\n        $body.addClass(\"loading\");\r\n        //for (var i = 0; i < selectedArray.length; i++) {\r\n        batchDelete(strLocalStorage, selectedArray, _that.context.pageContext.web.absoluteUrl);\r\n        //}\r\n        //location.reload();\r\n      }\r\n        , function () { }).set('closable', false);\r\n    }\r\n    else {\r\n      alertify.set('notifier', 'position', 'top-right');\r\n      alertify.error('Please select at least one item');\r\n    }\r\n  }\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('description', {\r\n                  label: strings.DescriptionFieldLabel\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"../../../../../src"}