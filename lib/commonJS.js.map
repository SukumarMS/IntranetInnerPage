{"version":3,"sources":["commonJS.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,GAAG,MAAM,WAAW,CAAC;AAC5B,OAAO,EAAC,GAAG,EAAC,MAAM,WAAW,CAAC;AAE9B,eAAe;AAEf,kBAAwB,QAAgB,EAAE,WAAgB;;;;wBACxD,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,EAAA;;oBAAlE,SAAkE,CAAC;;;;;CACpE;AAED,6BAA6B;AAE7B,4BAAkC,QAAgB,EAAE,IAAS,EAAE,WAAiB;;;;;wBAErE,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,4BAA4B,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,EAAA;;oBAAjG,MAAM,GAAG,SAAwF,CAAC;oBAClG,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,UAAC,iBAAiB;wBACzD,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;oBAChG,CAAC,CAAC,CAAC;;;;;CAEJ;AAED,aAAa;AAEb,mBAAyB,QAAgB,EAAE,WAAqB,EAAE,QAAgB,EAAE,OAAe,EAAE,SAAkB,EAAE,WAAiB;;;;;;oBACpI,YAAY,GAAG,UAAU,CAAC,WAAW,CAAC,CAAC;yBAEvC,CAAA,SAAS,IAAI,SAAS,CAAA,EAAtB,wBAAsB;oBACV,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAA;;oBAAxH,UAAU,GAAG,SAA2G,CAAA;;wBAG3G,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,EAAE,GAAG,SAAS,GAAG,OAAO,GAAG,WAAW,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAA;;oBAA7K,UAAU,GAAG,SAAgK,CAAA;;wBAEhL,sBAAO,CAAC,UAAU,CAAC,EAAC;;;;CACrB;AAED,gCAAgC;AAEhC,kBAAwB,QAAgB,EAAE,WAAqB,EAAE,QAAgB,EAAE,OAAe,EAAE,SAAkB,EAAE,WAAiB,EAAE,WAAoB;;;;;;oBACzJ,YAAY,GAAG,UAAU,CAAC,WAAW,CAAC,CAAC;yBAExC,CAAA,WAAW,IAAI,EAAE,CAAA,EAAjB,wBAAiB;oBAEhB,sBAAO,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,EAAE,GAAG,SAAS,GAAG,OAAO,GAAG,WAAW,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAA;;yBAEhL,CAAA,SAAS,IAAI,SAAS,CAAA,EAAtB,wBAAsB;oBACf,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAA;;oBAAxH,UAAU,GAAG,SAA2G,CAAA;;wBAG3G,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,EAAE,GAAG,SAAS,GAAG,OAAO,GAAG,WAAW,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAA;;oBAA7K,UAAU,GAAG,SAAgK,CAAA;;wBAEhL,sBAAO,CAAC,UAAU,CAAC,EAAC;;;;CACrB;AACD,cAAc;AAEd,oBAA0B,QAAgB,EAAE,EAAU,EAAE,WAAgB;;;;;wBAE7D,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,EAAA;;oBAA1F,MAAM,GAAG,SAAiF,CAAC;oBAC3F,sBAAM,CAAC,MAAM,CAAC,EAAC;;;;CAChB;AAED,cAAc;AAEd,oBAA0B,QAAgB,EAAE,MAAc;;;;wBACjD,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAA;wBAAjF,sBAAO,SAA0E,EAAC;;;;CACnF;AAED,gCAAgC;AAGhC,4EAA4E;AAE5E,sCAAsC;AACtC,2CAA2C;AAC3C,oCAAoC;AACpC,oHAAoH;AACpH,mGAAmG;AACnG,gCAAgC;AAChC,UAAU;AACV,MAAM;AACN,gCAAgC;AAChC,wBAAwB;AACxB,MAAM;AAEN,kBAAkB;AAElB,mBAAyB,QAAgB;;;;;wBACtB,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC,GAAG,EAAE,EAAA;;oBAAnG,UAAU,GAAG,SAAsF;oBACvG,sBAAO,UAAU,EAAC;;;;CACnB;AAGD,6BAA6B;AAE7B,sBAA4B,QAAgB,EAAE,UAAkB;;;;;;oBAC9D,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;oBACT,qBAAM,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,MAAM,EAAE,EAAA;;oBAA5F,OAAO,GAAE,SAAmF;oBAChG,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;oBACrB,sBAAO,OAAO,EAAC;;;;CAChB;AACC,qBAA2B,QAAgB,EAAE,aAAuB,EAAC,OAAO;;;;YACtE,GAAG,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,CAAC;YACvB,KAAK,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC;YAC1B,QAAQ,GAAG,aAAa,CAAC,MAAM,CAAC;YACpC,GAAG,CAAC,CAAK,CAAC,GAAE,CAAC,EAAE,CAAC,GAAC,QAAQ,EAAC,CAAC,EAAE,EAAC,CAAC;gBAC/B,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;YACvF,CAAC;YACD,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,UAAC,KAAY;gBAChC,EAAE,CAAC,CAAC,QAAQ,IAAI,SAAS,CAAC,CAAA,CAAC;oBACzB,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,EAAE,GAAG,OAAO,GAAG,6BAA6B,GAAE,QAAQ,CAAC;gBAClF,CAAC;gBACD,IAAI,CAAA,CAAC;oBACH,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACpB,CAAC;YAED,CAAC,CAAC,CAAC;;;;CACF;AAGL,sBAAsB;AAEtB,0BAAgC,aAAqB,EAAE,KAAa,EAAE,QAAQ;;;;YAE5E,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,SAAS;iBACf,UAAU,CAAC,KAAK,CAAC;iBACjB,MAAM,CAAC,GAAG,EAAE;iBACZ,IAAI,CAAC,UAAC,KAAY;gBACf,IAAI,gBAAgB,GAAG,aAAa,CAAC;gBACrC,OAAO,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,GAAG,EAAE,KAAK;oBACxC,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC5C,MAAM,CAAC,IAAI,CAAC;oBAChB,CAAC;gBACL,CAAC,CAAC,CAAC;gBACH,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;;;;CACR;AAGD,oBAAoB,WAAqB;IACvC,IAAI,eAAe,GAAW,EAAE,CAAC;IACjC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAC5C,eAAe,IAAI,WAAW,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;IAC1C,CAAC;IACD,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACtC,CAAC;AAED,oBAAoB,OAAO;IACzB,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;IAC7B,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;IAC9B,IAAI,MAAM,GAAG,OAAO,CAAC;IACrB,IAAI,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC;IAC3D,IAAI,EAAE,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,IAAI,UAAkB,CAAC;IACvB,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;QACV,UAAU,GAAG,GAAG,GAAG,EAAE,CAAC;IAC1B,CAAC;IACD,IAAI;QACA,UAAU,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC;IAC/B,MAAM,CAAC,UAAU,GAAG,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,GAAG,IAAI,CAAA;AAC3D,CAAC;AAED,8BAA8B,MAAM;IAClC,IAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;IACnD,IAAI,aAAa,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACxC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAC5C,IAAI,cAAc,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACjD,EAAE,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC;YAC9B,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC;IACL,CAAC;AACH,CAAC;AAED,6BAA6B,MAAM;IACjC,IAAI,aAAa,GAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACzC,IAAI,GAAG,GAAG,aAAa,CAAC,MAAM,CAAC;IAC/B,IAAI,KAAK,GAAG,IAAI,UAAU,CAAE,GAAG,CAAE,CAAC;IAClC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAS,CAAC;QAClC,KAAK,CAAC,CAAC,CAAC,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;IAC3C,CAAC;IACD,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;AACtB,CAAC;AAGD,OAAO,EAAE,QAAQ,EAAC,SAAS,EAAC,QAAQ,EAAC,UAAU,EAAC,UAAU,EAAC,YAAY,EAAC,SAAS,EAAC,UAAU,EAAC,kBAAkB,EAAC,gBAAgB,EAAC,WAAW,EAAC,UAAU,EAAC,oBAAoB,EAAC,mBAAmB,EAAC,CAAA","file":"commonJS.js","sourcesContent":["import pnp from 'sp-pnp-js';\r\nimport {Web} from 'sp-pnp-js';\r\ndeclare var $;\r\n// ADD NEW ITEM\r\n\r\nasync function addItems(listName: string, listColumns: any) {\r\n  await pnp.sp.web.lists.getByTitle(listName).items.add(listColumns);\r\n}\r\n\r\n// ADD NEW ITEM WITH DOCUMENT\r\n\r\nasync function additemsattachment(listName: string, file: any, listColumns?: any) {\r\n  var result:any;\r\n  result = await pnp.sp.web.getFolderByServerRelativeUrl(listName).files.add(file.name, file, true);\r\n  result.file.listItemAllFields.get().then((listItemAllFields) => {\r\n    pnp.sp.web.lists.getByTitle(listName).items.getById(listItemAllFields.Id).update(listColumns);\r\n  });\r\n \r\n}\r\n\r\n// READ ITEMS\r\n\r\nasync function readItems(listName: string, listColumns: string[], topCount: number, orderBy: string, filterKey?: string, filterValue?: any) {\r\n  var matchColumns = formString(listColumns);\r\n  var resultData: any;\r\n  if (filterKey == undefined) {\r\n     resultData = await pnp.sp.web.lists.getByTitle(listName).items.select(matchColumns).top(topCount).orderBy(orderBy).get()\r\n  }\r\n  else {\r\n     resultData = await pnp.sp.web.lists.getByTitle(listName).items.select(matchColumns).filter(\"\" + filterKey + \" eq '\" + filterValue + \"'\").top(topCount).orderBy(orderBy).get()\r\n  }\r\n  return (resultData);\r\n}\r\n\r\n// READ Single ITEMS with Lookup\r\n\r\nasync function readItem(listName: string, listColumns: string[], topCount: number, orderBy: string, filterKey?: string, filterValue?: any, Lookupvalue?: string) {\r\n  var matchColumns = formString(listColumns);\r\n  var resultData: any;\r\n  if(Lookupvalue != \"\")\r\n  {\r\n      return pnp.sp.web.lists.getByTitle(listName).items.select(matchColumns).expand(Lookupvalue).filter(\"\" + filterKey + \" eq '\" + filterValue + \"'\").top(topCount).orderBy(orderBy).get()\r\n  }\r\n  else if (filterKey == undefined) {\r\n     resultData = await pnp.sp.web.lists.getByTitle(listName).items.select(matchColumns).top(topCount).orderBy(orderBy).get()\r\n  }\r\n  else {\r\n     resultData = await pnp.sp.web.lists.getByTitle(listName).items.select(matchColumns).filter(\"\" + filterKey + \" eq '\" + filterValue + \"'\").top(topCount).orderBy(orderBy).get()\r\n  }\r\n  return (resultData);\r\n}\r\n// UPDATE ITEM\r\n\r\nasync function updateItem(listName: string, id: number, listColumns: any) {\r\n  var result: any;\r\n  result = await pnp.sp.web.lists.getByTitle(listName).items.getById(id).update(listColumns);\r\n  return(result);\r\n}\r\n\r\n// DELETE ITEM\r\n\r\nasync function deleteItem(listName: string, itemID: number) {\r\n  return await pnp.sp.web.lists.getByTitle(listName).items.getById(itemID).delete();\r\n}\r\n\r\n// BATCH DELETE - NOT YET TESTED\r\n\r\n\r\n// async function batchDelete(listName: string, selectedArray: number[]) {  \r\n  \r\n//   let batch = sp.web.createBatch();\r\n//   var arrayLen = selectedArray.length;  \r\n//   for (var i =0; i<arrayLen;i++){\r\n//     //await sp.web.lists.getByTitle(listName).items.getById(selectedArray[i]).inBatch(batch).delete().then(r => {\r\n//     await sp.web.lists.getByTitle(listName).items.getById(selectedArray[i]).delete().then(r => {\r\n//       console.log(\"deleted\");\r\n//     });\r\n//   }\r\n//   batch.execute().then(() => \r\n//   location.reload());\r\n//   }\r\n\r\n// GET FOLDER ONLY\r\n\r\nasync function GetFolder(listName: string){\r\n  let folderList = await pnp.sp.web.folders.getByName(listName).folders.expand('ListItemAllFields').get();\r\n  return folderList;\r\n}\r\n\r\n\r\n// REMOVE FOLDER FROM DOC LIB\r\n\r\nasync function DeleteFolder(listName: string, folderName: string){\r\n  console.log('common');\r\n  let confirm= await pnp.sp.web.folders.getByName(listName).folders.getByName(folderName).delete();\r\n  console.log(confirm);\r\n  return confirm;\r\n}\r\n  async function batchDelete(listName: string, selectedArray: number[],siteURL) {    \r\n    let web = new Web(siteURL);\r\n    let batch = web.createBatch();\r\n    var arrayLen = selectedArray.length;\r\n    for (var i =0; i<arrayLen;i++){\r\n    web.lists.getByTitle(listName).items.getById(selectedArray[i]).inBatch(batch).delete();\r\n    }\r\n    batch.execute().then((items: any[]) => {\r\n      if (listName == 'Holiday'){\r\n        window.location.href = \"\" + siteURL + \"/Pages/ListView.aspx?CName=\" +listName;\r\n    }\r\n    else{\r\n      location.reload();\r\n    }\r\n      \r\n    });\r\n    }\r\n\r\n\r\n// CHECK USER IN GROUP\r\n\r\nasync function checkUserinGroup(Componentname: string, email: string, callback) {\r\n  var myitems: any[];\r\n  pnp.sp.web.siteUsers\r\n      .getByEmail(email)\r\n      .groups.get()\r\n      .then((items: any[]) => {\r\n          var currentComponent = Componentname;\r\n          myitems = $.grep(items, function (obj, index) {\r\n              if (obj.Title.indexOf(currentComponent) != -1) {\r\n                  return true;\r\n              }\r\n          });\r\n          callback(myitems.length);\r\n      });\r\n}\r\n\r\n\r\nfunction formString(listColumns: string[]) {\r\n  var formattedString: string = \"\";\r\n  for (let i = 0; i < listColumns.length; i++) {\r\n    formattedString += listColumns[i] + ',';\r\n  }\r\n  return formattedString.slice(0, -1);\r\n}\r\n\r\nfunction formatDate(dateVal) {\r\n  var date = new Date(dateVal);\r\n  var year = date.getFullYear();\r\n  var locale = \"en-us\";\r\n  var month = date.toLocaleString(locale, { month: \"long\" });\r\n  var dt = date.getDate();\r\n  var dateString: string;\r\n  if (dt < 10) {\r\n      dateString = \"0\" + dt;\r\n  }\r\n  else\r\n      dateString = dt.toString();\r\n  return dateString + ' ' + month.substr(0, 3) + ',' + year\r\n}\r\n\r\nfunction GetQueryStringParams(sParam) {\r\n  var sPageURL = window.location.search.substring(1);\r\n  var sURLVariables = sPageURL.split('&');\r\n  for (var i = 0; i < sURLVariables.length; i++) {\r\n      var sParameterName = sURLVariables[i].split('=');\r\n      if (sParameterName[0] == sParam) {\r\n          return sParameterName[1];\r\n      }\r\n  }\r\n}\r\n\r\nfunction base64ToArrayBuffer(base64) {\r\n  var binary_string =  window.atob(base64);\r\n  var len = binary_string.length;\r\n  var bytes = new Uint8Array( len );\r\n  for (var i = 0; i < len; i++)        {\r\n      bytes[i] = binary_string.charCodeAt(i);\r\n  }\r\n  return bytes.buffer;\r\n}\r\n\r\n\r\nexport { addItems,readItems,readItem,deleteItem,updateItem,DeleteFolder,GetFolder,formString,additemsattachment,checkUserinGroup,batchDelete,formatDate,GetQueryStringParams,base64ToArrayBuffer}"],"sourceRoot":"../src"}